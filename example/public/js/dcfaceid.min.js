!function(t,s){"object"==typeof exports&&"object"==typeof module?module.exports=s():"function"==typeof define&&define.amd?define([],s):"object"==typeof exports?exports.DCFaceID=s():t.DCFaceID=s()}(this,function(){return(()=>{"use strict";var t={614:(t,s,i)=>{i.d(s,{default:()=>H});const e=["Received:","clear","videoinput","pitch","ID_BACK","defineCommands","bottom","outOfBounds","useServerSide","command","faceMask","act2Command","onerror","bbox","onError","setCommand","detectionLocked","rear camera used","quadraticCurveTo","session timeout","shuffle","cutLastSlash","getPose","fireCommand","scan_worker_path","clearSnapshots","action","callCommandResult","mrz","hideTextArea","visual","headpos","image/jpeg","down","docFace","getImageB64","9HOrppO","forward","analyzeAfterOpen","slice","sourceDim","innerHTML","recognize","image","finishTime","stop","add","pass_front","TOO_SMALL","opacity","croppedSize","defineScanType","cropCanvas","toOriginalSize","offsetHeight","dim","actionWaitBeforeCheck","kind","30px","score","545879gWteJd","421999CsvEwh","single","START","length","startingWaitTime","checkCurrentCommandAction","onScanResult","onStartDownCount","errorTime","frontCamera","src","onMRZDetected","sizeKoef","callStepChange","getSnapshots","time","index","undefined","callError","postMessage","toLowerCase","createDeepStory","classList","atan2","DOWN","debug","timeID","join","apply","data","catch","noface","originalSize","onTinyFaceResult","isErrorExist","lock","camera","isMobile","text","number","anonymous","scale","type","look left","keys","tagName","delay","look forward","__canvas","web camera exception!","next","onStop","serverDelay","canvasToImageData","textAlign","serverSide","areaColor","onFinished","NONE","valid","cutEdge","devicePixelRatio","forEach","substr","appendChild","moveTo","checkURI","getArea","manyFace","lastCommand","videoWidth","callCardDetectedEvent","landmark","INIT","mediaDevices","drawStreamToCanvas","getLastDetected","json","defineScanFace","SUCCESS","videoSize","reset","devices","applyConstraints","actionArea","top","commands","id_front","stroke","isRearCameraUsed","imageToCanvas","pos","face_worker_path","request","curScan","innerHtml","canvas2grayscale","pass_full","maskSize","look right","onload","media devices","getLaplacianVariance","defineCurrentAction","indexOf","actionText","includes","state","clearRect","17VgKWtV","url","backgroundColor","autoplay","stringify","box","js/deepscanworker.min.js","getTime","detector","absolute","testDetect","1658397EDAWCY","closePath","substring","getInstance","getCurrentStep","mrzOptions","currentStepActive","canvasToBase64","then","list","green","userAgent","observe","showProcessing","max","detect","setAttribute","actionWaitTime","stream","match","actualCanvas","position","normalizing","finished","getContext","DIV","drawFaces","lastDetected","inputSize","load","parentElement","onpause","getElementById","callback","worker","faceWebWorker","errorWaitTime","worker_path","object","CANVAS","errors","checkPosAndActions","loadCard","getCoordX","onStart","dpr","parseObject","getTinyFace","streamSize","environment","defineContainer","lastScanned","showArea","error","id_back","getPassTime","687334jwSdcm","setDim","startSession","3263rCtMUV","unlock","function","rgba(","onCameraLoaded","isOffscreenCanvasSupport","currentCommand","detectedFaceCountDownBeforeStart","paused","insertBefore","finish","setOptions","current","maskInited","scanner","isPlaying","noFace","video","append","isWebGLExist","round","rgba(0, 0, 0, 1)","isAllScanned","resHeight","notifyAll","onFaceDetected","getTracks","1rVNZxo","RIGHT","videoHeight","fillStyle","getCoordY","safari","analyser","cropAndResizeCanvas","roll","/verify","cardImage","hasCommand","init","lineWidth","scan","headers","isReady","initWorker","pass_main","mirrored","REJECT","textContent","options","beginPath","onStepChanged","globalCompositeOperation","canvas2IMG","detectTimer","push","getBox","floor","isSafari","commander","21212ZtEOau","crossOrigin","checkScanResult","blinking","status","log","lineTo","callCommandChange","landMarks","toDataURL","scans","random","class","restore","card/detect","onStreamLoaded","onloadeddata","getStep","other","PASS_FRONT","defineStream","fixedTime","GET","SCANNING","getVideoTracks","loaded","cardMinSize","filter","look up","onDetected","raf","streams","remove","?rand=","lowlight","detector result","tid","drawImage","srcDim","Error:","toosmall","onInit","draw","close","finishWaitTime","scan-worker","#FFFFFF","manycards","commandText","getSize","toRealCoordX","play","tID","observers","getImageData","getFace","height","calculate","getImageFromURL","look down","fit2Size","globalAlpha","POST","application/json","notify","14px Arial","docType","outofbounds","onWorkerMessage","playsinline","display","facingMode","end","area","changeStep","onFrameUpdated","onFaceResult","face","font","initContainer","setFace","onCardDetected","PASSPORT","save","drawCard","bind","callDetectedEvent","SMILE","tinyFaceDetected","width","Card model loaded","ACTIONS","getCard","results","622141RyiDiH","name","recognizeLocal","curFrame","imageDataToCanvas","interval","left","faceDetected","currentPosition","yaw","step","fill","SHOW","loadedTID","card","loading","onCommand","scanned","createElement","toFixed","FORWARD","snapshotlist","startTime","count","success","highlight","gray","showDetectors","sessionTime","blur","fillText","fillRect","checkSize","LEFT","onDetect","ID_FRONT","Valid","host","result","none","srcObject","video-layer","Your browser doesn't support web workers.","muted","style","Initializing","Success:","data processing, please wait...","Worker","delete","verify","getLandmark","setup","resWidth","canvas","strokeStyle","drawPath","rect","scanWebWorker","block","path","onScanLoaded","sessionTimeCount","currentActionList","assign","createDeepScan","currentAction","server","createDeepFace","2jjDxfC","showTextArea","getUserMedia","lastResult","card/ready","webWorker","dom","show","lastDetectedTime","start","defineProcess","lastScannedTime","image/png","showCollection","onStep","net","drawArea","Card is too small","onCameraStart","reject","manyfaces","__canvas_original","recognizeGlobal","drawMask","FINISH","onCameraStop","analizer","onLoaded","ellipse","open","toVerify","hide","rgb(66,109,139)","ctx","fillOnMobile","msg"],h=function(t,s){return e[t-=166]},n=h;!function(t,s){const i=h;for(;;)try{if(905518===-parseInt(i(271))*parseInt(i(506))+parseInt(i(208))+parseInt(i(365))+-parseInt(i(640))*-parseInt(i(211))+-parseInt(i(531))*-parseInt(i(434))+-parseInt(i(651))+-parseInt(i(238))*-parseInt(i(530)))break;t.push(t.shift())}catch(s){t.push(t.shift())}}(e);const o=(t,s)=>{const i=h;for(let e of Object[i(575)](s))s[e]instanceof Object&&Object[i(429)](s[e],o(t[e]||{},s[e]));return Object.assign(t||{},s),t};class a{static cutLastSlash(t){const s=h;return"/"===t[s(594)](t[s(534)]-1)?t[s(509)](0,-1):t}}class r{constructor(t="",s={}){const i=h;this.url=t,this[i(260)]={headers:{}},this[i(260)]=o(this[i(260)],s)}toVerify(t,s){const i=h;if(null!=t&&null!=t[i(225)]&&null==t[i(348)]){let e={docType:t[i(225)][i(337)]||null,scans:[],tid:t[i(225)][i(323)]};for(let s in t.scanner[i(281)])e[i(281)][i(266)]({docFace:t[i(225)][i(281)][s][i(504)]||null,image:t[i(225)][i(281)][s].image});let h=o({"Content-Type":i(334)},this[i(260)][i(253)]||{});fetch(a[i(491)](this.url)+i(247),{method:i(333),headers:h,body:JSON[i(644)](e)})[i(659)](t=>t[i(608)]())[i(659)](t=>{const e=i;if("function"==typeof s){let i={success:t[e(389)],data:t.data||null,msg:t[e(469)]||null};s(i)}})[i(561)](t=>{console.error("Error:",t),"function"==typeof s&&s({success:!1,error:t})})}}}class c{constructor(t){this.canvas=t}collect(){}[n(447)](){}[n(229)](){}[n(624)](){}}class l{static[n(568)](){return[/Android/i,/webOS/i,/iPhone/i,/iPad/i,/iPod/i,/BlackBerry/i,/Windows Phone/i].some(t=>{const s=h;return navigator[s(662)][s(171)](t)})}static[n(230)](){const t=n;try{document[t(383)](t(419))[t(176)]("webgl")}catch(t){return!1}return!0}static[n(216)](){return"function"==typeof OffscreenCanvas}static[n(269)](){const t=n;let s=navigator[t(662)][t(551)]();return-1!==s[t(635)](t(243))&&-1===s.indexOf("chrome")}}let d=null;class u{constructor(t={}){if(d)return d;d=this,this.options={debug:!1},this.setOptions(t)}static[n(654)](t=null){if(d)return null!=t&&d[n(222)](t),d;d=new u(t||{})}[n(222)](t={}){const s=n;this[s(260)]=o(this[s(260)],t)}[n(276)](){const t=n;this.options[t(556)]&&console[t(276)][t(559)](null,arguments)}}const m=u;const p=class{constructor(t,s={}){const i=n;this[i(440)]=null,this[i(419)]=null,this[i(579)]=null,this.__canvas_original=null,this[i(228)]=null,this[i(170)]=null,this.visual=null,this.raf=null,this[i(200)]={width:0,height:0},this[i(510)]={k:1,dx:0,dy:0,dw:0,dh:0},this[i(386)]=[],this[i(613)]=[],this[i(540)]=!0,this[i(197)]=1,this[i(260)]={src:null,sourceType:null,width:640,height:480,resWidth:1280,resHeight:720,fill:!1,fillOnMobile:!0,cutEdge:!1,onLoaded:null,onError:null,onStop:null,onStart:null,onFrameUpdated:null},this[i(260)]=o(this[i(260)],s),this[i(202)](t),this[i(417)]()}defineContainer(t){const s=n;if(this.dpr=window[s(592)]||1,"string"==typeof t){let i=document[s(184)](t);i&&i[s(576)]&&("DIV"===i[s(576)]?(this.dom=i,this.dom[s(511)]="",this[s(419)]=document[s(383)](s(191)),this[s(419)][s(360)]=this[s(260)].width,this[s(419)][s(327)]=this[s(260)][s(327)],this[s(440)].appendChild(this[s(419)])):"CANVAS"===i.tagName&&(this[s(419)]=i,this[s(440)]=document[s(383)](s(177)),this[s(419)][s(182)][s(220)](this[s(440)],this[s(419)]),this.dom[s(595)](this[s(419)])),this[s(440)]&&(this[s(440)][s(553)][s(516)]("df-container"),this[s(440)][s(409)][s(360)]=this.options.width+"px",this[s(440)][s(409)][s(327)]=this.options.height+"px")),this[s(419)]&&(this[s(419)][s(553)].add(s(406)),this[s(419)].style[s(642)]=s(391))}this[s(579)]=document[s(383)](s(191)),this.__canvas[s(360)]=this[s(260)][s(360)],this[s(579)][s(327)]=this[s(260)][s(327)],this.__canvas_original=document[s(383)](s(191)),this[s(455)][s(360)]=this[s(260)][s(360)],this[s(455)][s(327)]=this.options[s(327)]}[n(417)](){const t=n;this[t(500)]=new c(this[t(419)])}[n(443)](){const t=n;(null==this.video||!this.isPlaying())&&this[t(291)]()}[n(515)](){const t=n;this[t(170)]&&this[t(170)][t(237)]()[t(534)]>0&&(this.stream[t(237)]()[0][t(515)](),this[t(170)]=null)}[n(291)](){const t=n;l[t(568)]()&&!0===this[t(260)][t(468)]&&(this.options[t(376)]=!0),null==this[t(260)][t(541)]?null==this[t(170)]?navigator[t(605)]&&navigator.mediaDevices[t(436)]&&(null===this[t(228)]&&(this[t(228)]=document[t(383)]("video"),this[t(228)][t(168)](t(643),""),this.video[t(168)](t(408),""),this[t(228)].setAttribute(t(340),""),this.video[t(409)][t(360)]=t(528),this.video[t(409)].height=t(528),this.video.style[t(173)]=t(649),this[t(440)][t(595)](this.video),this[t(228)][t(409)][t(519)]="0.5"),this[t(301)]=null,navigator.mediaDevices.enumerateDevices()[t(659)](s=>{const i=t;m.getInstance().log(i(632),s),this.devices=s}),navigator.mediaDevices.getUserMedia({audio:!1,video:{facingMode:"environment",width:{ideal:this.options[t(418)]},height:{ideal:this[t(260)][t(234)]}}})[t(659)](i=>{const e=t;this[e(170)]=i,this[e(228)][e(405)]=i,i[e(295)]()[0][e(614)]({focusMode:"auto",focusDistance:.33}),this[e(620)]()&&(m[e(654)]().log(e(487)),this[e(540)]=!1),s(),this.video[e(322)]()})[t(561)](s=>{const i=t;m.getInstance()[i(276)](i(580),s),this[i(484)](s)})):this[t(228)][t(322)]():(this.video.src=this.options[t(541)],this[t(228)][t(322)]());let s=()=>{const s=t;this[s(228)][s(287)]=(()=>{this[s(286)]()}),this[s(228)].onplaying=(()=>{const t=s;this[t(579)][t(360)]=this[t(228)][t(601)],this[t(579)][t(327)]=this[t(228)].videoHeight,this.__canvas_original.width=this.video[t(601)],this.__canvas_original.height=this[t(228)][t(240)];let i=this[t(228)][t(601)],e=this.video[t(240)],h=1;this[t(510)].dw=this.canvas.width,this[t(510)].dh=this.canvas[t(327)],this[t(260)][t(376)]?this.canvas[t(327)]/e<this[t(419)][t(360)]/i?(h=this.canvas[t(360)]/i,this[t(510)].dh=Math[t(231)](h*e),this.sourceDim.dy=0,this[t(260)].cutEdge&&(this.__canvas_original[t(327)]=this[t(419)].height/h,this[t(579)][t(327)]=this[t(419)][t(327)]/h)):(h=this[t(419)][t(327)]/e,this[t(510)].dw=Math.round(h*i),this[t(510)].dx=0,this[t(260)][t(591)]&&(this[t(455)].width=this[t(419)][t(360)]/h,this[t(579)].width=this[t(419)].width/h)):this[t(419)].height/e<this.canvas[t(360)]/i?(h=this[t(419)][t(327)]/e,this[t(510)].dw=Math[t(231)](h*i),this[t(510)].dx=(this[t(419)][t(360)]-this[t(510)].dw)/2):(h=this[t(419)][t(360)]/i,this.sourceDim.dh=Math[t(231)](h*e),this[t(510)].dy=(this[t(419)].height-this[t(510)].dh)/2),this.sourceDim.k=h,null!=this[t(301)]&&cancelAnimationFrame(this.raf),this[t(301)]=requestAnimationFrame(this.drawStreamToCanvas[t(356)](this)),this[t(200)]={width:this[t(228)][t(601)],height:this.video[t(240)]},this[t(196)]()}),this[s(228)][s(183)]=(()=>{cancelAnimationFrame(this[s(301)]),this.onStop()})}}async drawStreamToCanvas(){const t=n;let s=this[t(540)]?-1:1,i=this.sourceDim,e=this[t(228)][t(601)],h=this[t(228)][t(240)],o=this[t(455)][t(176)]("2d");o[t(354)](),o[t(572)](1,1),this.options[t(376)]&&this[t(260)].cutEdge?o[t(308)](this[t(228)],(this[t(455)].width-e)/2,(this[t(455)][t(327)]-h)/2,e,h):o[t(308)](this.video,0,0,this[t(455)][t(360)],this[t(455)][t(327)]),o[t(284)]();let a=this[t(579)][t(176)]("2d");a.save(),a.scale(s,1),this[t(260)][t(376)]&&this[t(260)][t(591)]?a.drawImage(this[t(228)],s*(this[t(579)].width-e)/2+(-1===s?s*e:0),(this[t(579)].height-h)/2,e,h):a.drawImage(this[t(228)],-1===s?s*e:0,0,this[t(579)][t(360)],this[t(579)][t(327)]),a.restore();let r=this.canvas[t(176)]("2d"),c=(this[t(419)][t(360)]-this[t(510)].dw)/2,l=(this.canvas.height-this[t(510)].dh)/2;r.clearRect(0,0,this.canvas[t(360)],this[t(419)][t(327)]),r[t(354)](),r.scale(1*s,1),r[t(308)](this.video,s*c+(-1===s?s*i.dw:0),l,i.dw,i.dh),r[t(284)](),null!=this.stream&&(this[t(346)](),this[t(301)]=requestAnimationFrame(this[t(606)][t(356)](this)))}[n(620)](){const t=n;let s=[];for(let i in this[t(613)])this[t(613)][i][t(527)]===t(472)&&s.push(this[t(613)][i]);let i=this.stream&&this[t(170)][t(295)]()[0].getSettings()[t(342)]||null;return m[t(654)]()[t(276)](t(613),this.devices),m[t(654)]()[t(276)](t(342),i),i===t(201)}[n(226)](){const t=n;return this[t(170)]&&this[t(228)]&&!this.video[t(219)]}[n(325)](){const t=n;return this[t(579)][t(176)]("2d")[t(325)](0,0,this[t(579)][t(360)],this[t(579)][t(327)])}[n(505)](){const t=n;return this[t(579)][t(280)]()}[n(545)](){return this[n(386)]}snapshot(){const t=n;this[t(386)][t(266)](this[t(505)]())}[n(495)](){this[n(386)]=[]}onError(t){const s=n;"function"==typeof this[s(260)][s(484)]&&this[s(260)][s(484)](t)}[n(286)](){const t=n;"function"==typeof this[t(260)][t(461)]&&this[t(260)][t(461)](this[t(228)],this.sourceDim)}onStop(){const t=n;typeof this[t(260)][t(582)]===t(213)&&this[t(260)][t(582)]()}[n(196)](){const t=n;"function"==typeof this[t(260)][t(196)]&&this[t(260)][t(196)]()}onFrameUpdated(){const t=n;"function"==typeof this[t(260)][t(346)]&&this.options[t(346)]()}};class f{constructor(t={k:1,dx:0,dy:0,dw:0,dh:0}){this[n(525)]=t}[n(209)](t){this[n(525)]=t}getCoord(t,s){const i=n;return{x:t*this[i(525)].k+this[i(525)].dx,y:s*this.dim.k+this[i(525)].dy}}[n(195)](t){const s=n;return t*this.dim.k+this[s(525)].dx}[n(242)](t){const s=n;return t*this[s(525)].k+this[s(525)].dy}[n(320)](t){return t*this[n(525)].k}[n(321)](t){return t/this[n(525)].k-this.dim.dx}toRealCoordY(t){return t/this[n(525)].k-this.dim.dy}}class g{constructor(t,s={width:0,height:0},i={width:0,height:0}){const e=n;this[e(440)]=t,this[e(419)]=null,this[e(467)]=null,this[e(319)]=null,this.actionText=null,this[e(611)]=s,this[e(629)]=i,this.maskInited=!1,this[e(543)]={h:.4,v:.6},(0===this[e(629)][e(360)]||0===this[e(629)][e(327)])&&(this[e(629)]={width:this[e(611)].width*this[e(543)].h,height:this[e(611)][e(360)]*this[e(543)].v}),this[e(417)]()}[n(417)](){const t=n;null!=this[t(440)]&&(this.canvas=document[t(383)](t(191)),this.canvas.id="maskLayer",this.canvas[t(360)]=this[t(611)][t(360)],this[t(419)].height=this[t(611)][t(327)],this[t(440)][t(595)](this[t(419)]),this[t(467)]=this[t(419)].getContext("2d"))}createTextArea(){const t=n;if(this.commandText)this[t(319)][t(409)][t(341)]="block";else{this[t(319)]=document[t(383)]("div"),this[t(319)].id="commandArea";let s=document[t(383)]("P");s.textContent="",this[t(319)][t(595)](s),this[t(440)][t(595)](this[t(319)]);let i=((this.canvas[t(327)]-this[t(629)].height)/2-this[t(319)][t(524)])/2;this[t(319)][t(409)][t(616)]=i+"px"}if(this[t(636)])this.actionText[t(409)][t(341)]=t(424);else{this.actionText=document[t(383)]("div"),this[t(636)].id=t(615);let s=document[t(383)]("P");s[t(259)]="",this[t(636)][t(595)](s),this[t(440)][t(595)](this[t(636)]);let i=((this.canvas[t(327)]-this[t(629)].height)/2-this[t(319)][t(524)])/2;this[t(636)][t(409)][t(476)]=i+"px"}}[n(435)](){const t=n;this[t(319)]&&(this[t(319)][t(409)][t(341)]=""),this[t(636)]&&(this[t(636)][t(409)][t(341)]="")}hideTextArea(){const t=n;this[t(319)]&&(this[t(319)].style.display=t(404)),this[t(636)]&&(this.actionText[t(409)].display=t(404))}setText(t){const s=n;this[s(636)]&&(this[s(636)][s(626)]=t)}[n(485)](t){const s=n;this[s(319)]&&(this.commandText[s(626)]=t)}getArea(){const t=n;return{x:this[t(419)][t(360)]/2-this[t(629)][t(360)]/2-20,y:this[t(419)][t(327)]/2-this[t(629)][t(360)]/2-20,width:this[t(629)][t(360)],height:this.maskSize[t(327)]}}draw(){const t=n;if(!this[t(224)]){console[t(276)]("draw mask layer"),this[t(467)][t(354)](),this[t(467)].beginPath(),this.ctx[t(462)](this[t(419)][t(360)]/2,this[t(419)][t(327)]/2,this[t(629)][t(360)]/2,this[t(629)][t(327)]/2,Math.PI,0,2*Math.PI),this.ctx[t(241)]=t(466),this[t(467)][t(376)](),this[t(467)][t(263)]="xor",this[t(467)].beginPath(),this[t(467)].rect(0,0,this[t(419)].width,this[t(419)][t(327)]),this[t(467)][t(241)]=t(232),this[t(467)][t(652)](),this[t(467)][t(376)](),this[t(467)][t(332)]=.5;let s=this[t(419)][t(280)]();this[t(467)][t(263)]="source-over";let i=new Image;i[t(631)]=(()=>{const s=t;this.ctx.clearRect(0,0,this[s(419)][s(360)],this[s(419)].height),this[s(467)].drawImage(i,0,0)}),i[t(541)]=s,this[t(224)]=!0,this.createTextArea()}}[n(441)](){const t=n;this.maskInited?(this[t(435)](),this.canvas[t(409)][t(341)]=t(424)):(this[t(313)](),this[t(419)][t(409)].display=t(424))}hide(){const t=n;this[t(499)](),this[t(419)][t(409)][t(341)]=t(404)}[n(414)](){const t=n;this.ctx[t(639)](0,0,this.canvas[t(360)],this[t(419)][t(327)]),this[t(467)][t(284)]()}}class w{constructor(t,s={}){const i=n;this[i(419)]=t,this[i(260)]={srcDim:{k:1,dx:0,dy:0,dw:0,dh:0}},this[i(260)]=o(this[i(260)],s),this.cc=new f(this[i(260)][i(309)])}[n(421)](t,s,i){const e=n,h=new Path2D;h[e(596)](s[0][0],s[0][1]);for(let t=1;t<s[e(534)];t++){const i=s[t];h.lineTo(i[0],i[1])}i&&h[e(652)](),t.stroke(h)}[n(178)](t){const s=n;this[s(260)].srcDim.k;let i=null,e=this[s(419)][s(176)]("2d");e[s(354)]();for(let h=0;h<t[s(534)];h++){i=t[h][s(279)];for(let t=0;t<i[s(534)];t++){const h=i[t][0],n=i[t][1];e.beginPath(),e.arc(this.cc[s(195)](h),this.cc.getCoordY(n),1,0,2*Math.PI),e[s(376)](),e[s(652)]()}}e[s(284)]()}}class y{constructor(t){const s=n;this[s(366)]=t,this[s(324)]={}}on(t,s){const i=n;void 0===this[i(324)][t]&&(this[i(324)][t]=[]),typeof s==i(213)&&this[i(324)][t][i(266)](s)}remove(t,s){const i=n;for(const t in this[i(324)])this[i(324)][t]=this[i(324)][t][i(298)](t=>t!==s)}[n(335)](t,s){const i=n;this.observers[t]&&this[i(324)][t].forEach(t=>{"function"==typeof t&&t(s)})}[n(235)](t){const s=n;this[s(324)][s(593)](i=>{const e=s;i[e(593)](s=>{typeof s==e(213)&&s(t)})})}}const v=new class{constructor(){this[n(302)]={}}[n(463)](t){const s=n;return!this.streams[t]&&(this[s(302)][t]=new y(t)),this[s(302)][t]}};class S{constructor(){}static[n(522)](t,s,i,e,h){const o=n;let a=document.createElement(o(191));return a[o(360)]=e,a[o(327)]=h,a[o(176)]("2d")[o(308)](t,s,i,e,h,0,0,e,h),a}static resizeCanvas(t,s={w:null,h:null}){const i=n;let e=document[i(383)](i(191));return null==s.w&&null==s.h?(e[i(360)]=t[i(360)],e[i(327)]=t[i(327)]):null==s.w?(e[i(327)]=s.h,e[i(360)]=s.h/t[i(327)]*t[i(360)]):null==s.h?(e[i(360)]=s.w,e.height=s.w/t[i(360)]*t[i(327)]):(e[i(360)]=s.w,e[i(327)]=s.h),e[i(176)]("2d")[i(308)](t,0,0,e[i(360)],e[i(327)]),e}static[n(245)](t,s,i,e,h,o,a){const r=n;let c=document.createElement(r(191));return c[r(360)]=o,c[r(327)]=a,c[r(176)]("2d")[r(308)](t,s,i,e,h,0,0,o,a),c}static imageDataToCanvas(t){const s=n;let i=document[s(383)](s(191));return i[s(360)]=t[s(360)],i[s(327)]=t[s(327)],i[s(176)]("2d").putImageData(t,0,0),i}static[n(621)](t){const s=n;let i=document[s(383)](s(191));return i[s(360)]=t[s(360)],i[s(327)]=t[s(327)],i[s(176)]("2d")[s(308)](t,0,0),i}static[n(584)](t){const s=n;return t[s(176)]("2d")[s(325)](0,0,t[s(360)],t[s(327)])}static canvasToBase64(t,s=n(446),i=.92){return t.toDataURL(s,i)}static[n(264)](t,s=n(446),i=.92){return new Promise(function(e,n){const o=h;let a=new Image;a[o(168)](o(272),o(571)),a.onload=(()=>{e(a)}),a.onerror=(t=>{n("Error loading "+t)}),a.src=S[o(658)](t,s,i)})}static[n(627)](t){const s=n;let i=t.getContext("2d")[s(325)](0,0,t[s(360)],t[s(327)]),e=i[s(560)];for(let i=t[s(360)]*t.height*4-1;i>0;i-=4){let t=.3*e[i-3]+.59*e[i-2]+.11*e[i-1];e[i-3]=t,e[i-2]=t,e[i-1]=t}let h=document[s(383)]("CANVAS");return h.getContext("2d").putImageData(i,0,0),h}static blankCanvas(t,s,i="black"){const e=n;let h=document[e(383)](e(191));h[e(360)]=t,h[e(327)]=s;let o=h[e(176)]("2d");return o[e(241)]=i,o[e(396)](0,0,t,s),h}static[n(633)](t,s=30){const i=n;let e=t[i(176)]("2d")[i(325)](0,0,t[i(360)],t[i(327)])[i(560)],h=[[0,1,0],[1,-4,1],[0,1,0]],o=4*t[i(360)],a=0,r=Math[i(268)](1.5),c=0,l=0;for(let n=1;n<t[i(327)]-1;n++)for(let t=4;t<o-4;t+=4){c=0;for(let s=0;s<3;s++)for(let i=0;i<3;i++){c+=(.3*e[a=o*(n+s-r)+t+4*(i-r)]+.59*e[a+1]+.11*e[a+2])*h[s][i]}c>s&&(l+=1)}return l}static getImageFromURL(t){return new Promise(function(s,i){const e=h;let n=new Image;n[e(168)]("crossOrigin",e(571)),n[e(631)]=(()=>{s(n)}),n[e(482)]=(()=>{i("Error loading "+t)}),n[e(541)]=t})}}class C{constructor(t={}){const s=n;this.worker=null,this[s(170)]=null,this[s(260)]={path:null},this.options=o(this[s(260)],t),this[s(417)]()}setup(){const t=n;this[t(170)]=v[t(463)](t(186)),this[t(170)].on("getFace",this[t(326)][t(356)](this)),this[t(170)].on(t(199),this[t(199)][t(356)](this)),this[t(170)].on("loadCard",this.loadCard[t(356)](this)),this[t(170)].on(t(363),this[t(363)][t(356)](this)),window[t(413)]&&null!=this.options[t(425)]?(this[t(186)]=new Worker(this.options[t(425)]),this[t(186)].onmessage=this[t(339)][t(356)](this)):console.log(t(407))}[n(326)](t){const s=n;let i=null;if(t instanceof HTMLCanvasElement){i=t[s(176)]("2d")[s(325)](0,0,t.width,t[s(327)])}else if(t instanceof HTMLImageElement){let e=document[s(383)](s(419)),h=e.getContext("2d");e[s(360)]=t.width,e[s(327)]=t[s(327)],h[s(308)](t,0,0),i=h[s(325)](0,0,t[s(360)],t[s(327)])}this[s(186)][s(550)]({type:s(348),action:s(326),data:i})}[n(199)](t){const s=n;let i=null;if(t instanceof HTMLCanvasElement){i=t.getContext("2d")[s(325)](0,0,t[s(360)],t[s(327)])}else if(t instanceof HTMLImageElement){let e=document[s(383)]("canvas"),h=e.getContext("2d");e[s(360)]=t[s(360)],e.height=t.height,h[s(308)](t,0,0),i=h.getImageData(0,0,t[s(360)],t.height)}this.worker.postMessage({type:s(348),action:s(199),data:i})}[n(363)](t){const s=n;let i=null;t instanceof HTMLCanvasElement?i=S[s(584)](t):t instanceof HTMLImageElement&&(i=S[s(621)](t)),this[s(186)][s(550)]({type:s(252),action:s(363),data:i})}[n(194)](){const t=n;this[t(186)][t(550)]({type:t(252),action:t(194)})}onWorkerMessage(t){const s=n;let i=t.data.type,e=t.data.action,h=t[s(560)].data;switch(i){case s(348):e===s(372)?this[s(170)][s(335)]("onFaceResult",h):e===s(359)&&this[s(170)][s(335)](s(564),h);break;case s(252):this[s(170)][s(335)](s(537),h);break;case"scanLoaded":this.stream.notify(s(426),h);break;case s(289):}}}const T=class{constructor(){const t=n;this[t(449)]=null,this[t(645)]={x:0,y:0,width:0,height:0},this[t(603)]=[],this[t(348)]=null,this[t(374)]=0,this[t(473)]=0,this.roll=0}[n(351)](t){const s=n;this[s(348)]=t,this[s(645)]={x:t.x,y:t.y,height:t.height,width:t.width},this.landmark=t[s(279)],this[s(328)]()}clear(){const t=n;this[t(449)]=null,this[t(645)]={x:0,y:0,width:0,height:0},this[t(603)]=[],this[t(348)]=null,this[t(374)]=0,this[t(473)]=0,this[t(246)]=0}[n(328)](){const t=n;let s=this[t(348)][t(279)][234],i=this[t(348)].landMarks[454],e=this[t(348)][t(279)][10],h=this[t(348)][t(279)][152];this[t(374)]=180*Math[t(554)](i[2]-s[2],i[0]-s[0])/Math.PI,this[t(473)]=180*Math[t(554)](h[0]-e[0],h[2]-e[2])/Math.PI,this[t(246)]=180*Math[t(554)](i[1]-s[1],i[0]-s[0])/Math.PI}[n(492)](){}[n(267)](){return this[n(645)]}[n(416)](){return this[n(603)]}},D={FORWARD:n(507),LEFT:"left",RIGHT:"right",UP:"up",DOWN:n(503),SMILE:"smile",BLINKING:n(274),NONE:"none"};class b{constructor(){const t=n;this.commands=[],this.count=2,this.chooselist=[D[t(398)],D.RIGHT,D.UP,D[t(555)],D[t(358)]],this[t(547)]=0}[n(490)](){const t=n;this[t(471)]();for(let s=0;s<this[t(388)];s++)this[t(617)][t(266)]({name:D.FORWARD});return this[t(617)]}[n(581)](){const t=n;return this[t(547)]<this[t(617)][t(534)]-1?(this[t(547)]++,this[t(617)][this[t(547)]]):null}[n(223)](){const t=n;return this[t(617)][this[t(547)]]}[n(249)](){const t=n;return this.index<this[t(617)][t(534)]-1}[n(471)](){const t=n;this.index=0,this[t(617)]=[]}}n(562),n(454),n(305),n(390),n(338);const I={NONE:"none",UP:"up",DOWN:n(503),FORWARD:n(507),LEFT:"left",RIGHT:"right"},x={NONE:n(404),INIT:n(250),START:n(443),ACTIONS:"actions",FINISH:n(221)},k={SUCCESS:"success",NONE:"none",REJECT:n(453)};class F{constructor(t,s={}){const i=n;this[i(419)]=t,this[i(260)]={video:null,area:{x:0,y:0,width:0,height:0},detectTime:100,startingWaitTime:2e3,onFaceDetected:null,onError:null,onFinished:null,onCommand:null,onCommandResult:null,onStep:null,onStartDownCount:null},this.options=o(this[i(260)],s),this[i(265)]=null,this.errors={lowLight:!1,highLight:!1,noFace:!1,manyFace:!1,outOfBounds:!1},this[i(373)]=I[i(589)],this[i(170)]=null,this[i(501)]=new T,this[i(270)]=new b,this.lock=!1,this.lastDetected=[],this[i(375)]=x[i(589)],this[i(218)]=3,this[i(292)]=0,this[i(539)]=0,this[i(188)]=2e3,this[i(169)]=6e3,this[i(526)]=1e3,this.finishWaitTime=2e3,this.currentStepActive=!1,this[i(307)]=null,this.results=[],this[i(217)]=D[i(589)],this[i(431)]=I[i(589)],this[i(428)]=[],this.cc=null,this[i(255)]()}[n(255)](){const t=n;this[t(170)]=v[t(463)](t(186)),this[t(170)].on(t(347),s=>{const i=t;null!=this[i(265)]&&(this[i(236)](s),this[i(566)]=!1)})}[n(443)](){const t=n;this[t(566)]=!1,this[t(179)]=[],this[t(657)]=!1,this.step=x[t(604)],this[t(364)]=[],this[t(218)]=3,this.tid=(new Date).getTime(),this.defineCommands(),this[t(544)](this[t(375)]),clearTimeout(this[t(265)]),this[t(265)]=setTimeout(this[t(663)][t(356)](this),this.options.detectTime)}[n(515)](){const t=n;this[t(307)]=null,clearTimeout(this[t(265)]),this.detectTimer=null,this[t(566)]=!1,this[t(471)]()}clear(){const t=n;this[t(179)]=[],this.step=x[t(589)],this.detectedFaceCountDownBeforeStart=3,this[t(431)]=I[t(589)],this.currentActionList=[],this.currentStepActive=!1}[n(475)](){const t=n;let s=this.commander[t(490)]();for(let i in s)this[t(364)][t(266)]({pos:I[t(589)],image:null,command:D[t(589)],status:!1});m[t(654)]()[t(276)](t(475),s)}[n(663)](){const t=n;!this.lock&&(this[t(170)][t(335)](t(326),this[t(419)]),this.lock=!0),this[t(265)]=setTimeout(this.observe[t(356)](this),this[t(260)].detectTime)}[n(236)](t){const s=n;if(this[s(192)][s(227)]=!1,this[s(192)].manyFace=!1,this[s(373)]=I[s(589)],t[s(534)]>1)this[s(192)][s(599)]=!0;else if(0===t[s(534)])return this[s(192)][s(227)]=!0,typeof this[s(260)][s(236)]===s(213)&&this[s(260)][s(236)]([]),void(this[s(566)]=!1);this[s(179)]=t,"function"==typeof this[s(260)][s(236)]&&this[s(260)][s(236)](t),this[s(218)]>0?(this.detectedFaceCountDownBeforeStart--,this[s(292)]=(new Date).getTime(),this[s(539)]=(new Date)[s(647)]()):(this[s(501)].setFace(t[0]),this.defineCurrentAction(),this[s(536)]()),this[s(566)]=!1}[n(221)](t,s){const i=n;if(null==this[i(307)])return!1;let e={tid:this[i(307)],status:s,results:this.results,image:null};for(let t in this[i(364)])if(this[i(364)][t][i(479)]===D[i(385)]&&!0===this.results[t][i(275)]){e[t][i(513)]=this[i(364)][t][i(513)];break}typeof this[i(260)][i(588)]===i(213)&&this[i(260)][i(588)](e),this[i(515)]()}[n(634)](){const t=n;let s=this[t(501)].getBox(),i={x:this.cc[t(195)](s.x),y:this.cc[t(242)](s.y),width:this.cc[t(320)](s[t(360)]),height:this.cc[t(320)](s.height)},e=.3*this[t(260)].area[t(360)],h=.3*this.options[t(344)][t(327)],o=i.x+i[t(360)],a=i.y+i.height;if(!(i.x>this[t(260)][t(344)].x-e&&i.y>this[t(260)][t(344)].y-h&&o<this[t(260)][t(344)].x+this[t(260)][t(344)].width+e&&a<this[t(260)][t(344)].y+this[t(260)][t(344)][t(327)]+h))return this[t(192)].outOfBounds=!0,!1;this[t(192)][t(477)]=!1,this[t(501)][t(246)]<12&&this[t(501)][t(246)]>-12&&this[t(501)].pitch<=-20&&this[t(501)][t(473)]>=-130&&this[t(501)][t(374)]>=-10&&this.headpos[t(374)]<=10&&(this[t(431)]=I.FORWARD),this[t(501)][t(246)]<12&&this.headpos[t(246)]>-12&&this.headpos[t(374)]<-10&&(this[t(431)]=I.LEFT),this[t(501)][t(246)]<12&&this[t(501)][t(246)]>-12&&this[t(501)].yaw>10&&(this[t(431)]=I[t(239)]),this[t(501)].roll<12&&this[t(501)][t(246)]>-12&&this[t(501)].pitch<-130&&(this[t(431)]=I.UP),this[t(501)].roll<12&&this.headpos[t(246)]>-12&&this[t(501)][t(473)]>-20&&(this.currentAction=I[t(555)])}[n(536)](){const t=n;let s=this.isErrorExist(),i=this.getTimeDiff(this.fixedTime);if(s?(this[t(373)]=I[t(589)],this[t(549)](this.errors)):this.errorTime=(new Date)[t(647)](),this.step===x[t(604)]&&(this[t(657)]=!1,this.step=x[t(533)],this[t(544)](this.step)),this[t(375)]===x[t(533)]){let s=Math[t(231)]((this[t(260)][t(535)]-i)/1e3);s>0?typeof this.options.onStartDownCount===t(213)&&this[t(260)][t(538)](s):(this[t(375)]=x[t(362)],this[t(657)]=!1,this[t(292)]=(new Date).getTime(),this[t(393)]=(new Date)[t(647)](),this[t(544)](this.step))}if(this[t(375)]===x[t(362)]&&(!1===s||0===this[t(188)])){let s=this[t(270)].index,e=this.commander[t(223)]();this[t(217)]!==e[t(366)]&&(this[t(217)]=e.name,this[t(428)]=[],this.callCommandChange(e[t(366)])),i>0&&this[t(428)][t(266)]({pos:this[t(431)],posPitch:this[t(501)][t(473)],posYaw:this[t(501)].yaw,time:(new Date).getTime(),valid:!0,command:e});let h=this[t(169)]+this[t(526)]-i,n=i>this[t(526)]?this[t(193)](e.name,this.currentAction):k[t(589)];if(h>0&&n===k.NONE);else if(i>this[t(526)]){let i=S.cropCanvas(this[t(419)],this.headpos.box.x,this[t(501)][t(645)].y,this.headpos[t(645)][t(360)],this[t(501)][t(645)][t(327)]);n===k.SUCCESS?this[t(364)][s]={pos:this[t(431)],command:e,status:!0,image:i}:this[t(364)][s]={pos:this[t(431)],command:e,status:!1,image:i},this[t(497)](this[t(364)][s]),this[t(270)][t(249)]()?this[t(270)][t(581)]():(this[t(375)]=x.FINISH,this[t(501)][t(471)](),this[t(544)](this[t(375)])),this[t(292)]=(new Date)[t(647)]()}}if(this[t(375)]===x[t(458)]){this[t(315)]-i>0||(this.step=x[t(458)],this.fixedTime=(new Date).getTime(),this[t(221)](!0,!0))}}checkPosAndActions(t,s){const i=n;let e={},h=D.NONE,o=D.NONE,a={};for(let t in this[i(428)]){let s=this[i(428)][t];null!=s&&s[i(590)]&&(null!=s[i(622)]&&(h=this[i(481)](s[i(622)])),null==e[h]&&(e[h]={list:[],max:0}),e[h]=this.addActionTime(e[h],s,o!==h),a[h]=(a[h]||0)+1,o=h)}let r=a[i(534)];if(t===D[i(398)]||t===D.UP||t===D[i(239)]||t===D[i(555)]){if(r>3)return k[i(258)];if(null!=e[t]&&e[t][i(166)]>1e3)return k[i(610)]}if(t===D[i(385)]){if(r>=3)return k[i(258)];if(null!=e[t]&&e[t][i(166)]>1e3)return k[i(610)]}return k.NONE}callStepChange(t){const s=n;typeof this[s(260)].onStep===s(213)&&this[s(260)][s(448)](t)}[n(549)](t){const s=n;typeof this.options.onError===s(213)&&this[s(260)].onError(t)}[n(278)](t){const s=n;"function"==typeof this[s(260)][s(381)]&&this[s(260)].onCommand(t)}[n(497)](t){const s=n;typeof this.options.onCommandResult===s(213)&&this.options.onCommandResult(t)}[n(607)](){return this[n(179)]}[n(565)](){const t=n;for(const s in this[t(192)])if(!0===this[t(192)][s])return!0;return!1}getTimeDiff(t){return(new Date).getTime()-t}[n(481)](t){const s=n;switch(t){case I[s(398)]:return D.LEFT;case I.UP:return D.UP;case I[s(239)]:return D[s(239)];case I[s(555)]:return D[s(555)];case I[s(385)]:return D[s(385)];default:return D[s(589)]}}addActionTime(t,s,i){const e=n;let h=t,o=0;return h[e(660)][e(534)]>0&&null!=h.list[o][e(443)]&&i?(o=h[e(660)].length-1,null!=s[e(546)]&&(h[e(660)][o][e(343)]=s[e(546)],h[e(660)][o][e(370)]=s[e(546)]-h[e(660)][o].start,h.max=(h[e(660)][o].interval||0)>h[e(166)]?h.list[o][e(370)]||0:h[e(166)])):h[e(660)].push({start:s.time,end:null,interval:null}),h}}class O{constructor(t,s={}){const i=n;this.dom=null,this[i(419)]=null,this[i(567)]=null,this.state={start:!1,detectInit:!1,analyzeAfterOpen:!1},this[i(260)]={src:null,sourceType:null,width:640,height:480,liveness:!0,onFrameCaptured:null,detectTime:100,onFinished:null,worker_path:"js/deepfaceworker.js"},this.options=o(this[i(260)],s),this.initContainer(t),this[i(417)]()}[n(350)](t){const s=n;this[s(567)]=new p(t,{src:this.options[s(541)],width:this[s(260)][s(360)],height:this[s(260)][s(327)],onFrameUpdated:this[s(346)].bind(this),onLoaded:this[s(215)][s(356)](this),onStart:this[s(452)][s(356)](this),onStop:this[s(459)][s(356)](this)}),this.dom=this.camera[s(440)],this[s(419)]=this[s(567)].canvas}[n(417)](){const t=n;this.cc=new f(this[t(567)][t(510)]),this[t(480)]=new g(this[t(440)],{width:this[t(260)].width,height:this.options.height}),this[t(500)]=new w(this[t(419)]),this[t(439)]=new C({path:this[t(260)][t(189)]}),this[t(244)]=new F(this.camera.__canvas,{area:this[t(480)][t(598)](),detectTime:this[t(260)].detectTime,onFaceDetected:this[t(236)][t(356)](this),onError:this[t(484)][t(356)](this),onFinished:this[t(588)].bind(this),onCommand:this[t(381)][t(356)](this),onCommandResult:this.onCommandResult.bind(this),onStep:this[t(448)].bind(this),onStartDownCount:this[t(538)][t(356)](this)}),this[t(244)].cc=this.cc}[n(463)](){const t=n;!this.camera[t(226)]()&&(this[t(567)].start(),this[t(480)][t(441)]())}[n(314)](){const t=n;this[t(515)](),this.camera[t(515)](),this.faceMask[t(465)]()}start(){const t=n;this.camera[t(226)]()?(this[t(638)][t(443)]=!0,this[t(244)][t(443)]()):(this[t(463)](),this[t(638)][t(508)]=!0)}[n(515)](){const t=n;this[t(638)][t(443)]=!1,this[t(244)][t(515)](),this[t(638)][t(508)]=!1}onFinished(t,s){const i=n;m.getInstance()[i(276)](i(175)),this[i(480)][i(485)]("Finished"),"function"==typeof this[i(260)].onFinished&&this.options[i(588)](t,s)}[n(236)](t){}[n(381)](t){const s=n;m.getInstance()[s(276)](s(381),t);let i="";switch(t){case D[s(385)]:i=s(578);break;case D[s(398)]:i=s(574);break;case D[s(239)]:i=s(630);break;case D.UP:i=s(299);break;case D.DOWN:i=s(330);break;default:i=""}this[s(480)][s(485)](i)}onCommandResult(){}[n(448)](t){const s=n;m.getInstance().log("onStepChanged",t);let i="";switch(t){case x[s(604)]:i=s(410);break;case x[s(533)]:i="Starting";break;case x[s(362)]:i="Please follow the commands";break;case x[s(458)]:i="Computing for finishing";break;default:i=""}this[s(480)][s(485)](i)}[n(538)](t){const s=n;m[s(654)]()[s(276)](s(538),t)}[n(484)](t){const s=n;m[s(654)]()[s(276)](s(484),t)}[n(346)](){const t=n;let s=this.analyser[t(607)]();this[t(500)][t(178)](s)}[n(215)](t,s){const i=n;this.cc[i(209)](s),this[i(500)].cc[i(209)](s),this[i(244)].options[i(228)]=t}onCameraStart(){const t=n;this[t(638)].analyzeAfterOpen&&(this.state.analyzeAfterOpen=!1,this[t(443)]())}[n(459)](){}[n(664)](t){const s=n;this[s(440)]&&(this[s(440)][s(553)][s(303)](s(380)),this[s(440)][s(553)][s(303)](s(394)),t&&(this.dom.classList[s(516)](s(380)),this.dom[s(553)][s(516)](s(394))))}}class A{constructor(t={}){const s=n;this[s(260)]={host:null,headers:null,serverSide:null,modelUrl:null,mirrored:!0,single:!0},this.callback=null,this[s(296)]=!1,this.loadedTID=null,this[s(260)]=o(this.options,t),this[s(563)]={width:0,height:0},this[s(520)]={x:0,y:0,width:0,height:0},this[s(180)]={width:300,height:300},this.options.serverSide||this[s(255)]()}[n(444)](){const t=n;this[t(260)].serverSide=l[t(568)]()||l[t(269)]()}[n(255)](){const t=n;this[t(170)]=v.open(t(316)),this[t(170)].on(t(537),s=>{const i=t;if(typeof this.callback===i(213)){let t=this[i(174)](s,!0);this[i(185)](t)}}),this.stream.on(t(426),s=>{const i=t;m[i(654)]()[i(276)](i(361)),this[i(296)]=s})}[n(181)](){const t=n;if(this.options.serverSide){let s=(null!=this[t(260)][t(402)]?a[t(491)](this.options.host):"")+"/"+t(438),i=o({"Content-Type":t(334)},this[t(260)][t(253)]||{});fetch(s,{method:t(293),headers:i}).then(s=>s[t(608)]())[t(659)](s=>{const i=t;this[i(296)]=s[i(389)],m[i(654)]().log(i(411),s)}).catch(s=>{const i=t;this[i(296)]=!1,m.getInstance().log(i(310),s)})}else this[t(170)][t(335)]("loadCard")}startSession(t=null){const s=n;let i=(null!=this[s(260)][s(402)]?a.cutLastSlash(this.options.host):"")+"/"+s(443),e=o({"Content-Type":s(334)},this[s(260)][s(253)]||{});fetch(i,{method:s(293),headers:e})[s(659)](t=>t[s(608)]())[s(659)](i=>{const e=s;this[e(378)]=i[e(307)]||null,m[e(654)]()[e(276)](e(411),i),"function"==typeof t&&t(this[e(296)],this.loadedTID)})[s(561)](t=>{const i=s;this[i(378)]=null,m[i(654)]()[i(276)](i(310),t)})}detect(t,s,i){const e=n;if(this.options.serverSide){let h=S.canvasToBase64(t,"image/jpeg",.95),n=new FormData;n[e(229)]("image",h),n[e(229)]("type","0"),n[e(229)](e(307),s);let r=(null!=this[e(260)][e(402)]?a[e(491)](this[e(260)][e(402)]):"")+"/"+e(285),c=o({},this[e(260)][e(253)]||{});fetch(r,{method:"POST",body:n,headers:c})[e(659)](function(t){const s=e;if(t.ok)return t.json();console[s(205)](s(310),t),typeof i===s(213)&&i(null)})[e(659)](t=>{const s=e;m[s(654)]()[s(276)](s(470),t);let h=[];if(!0===t[s(389)]&&void 0!==t.data&&(h=t[s(560)]),h.length,typeof i===s(213)){let t=this[s(174)](h);i(t)}}).catch(t=>{console[e(205)]("Error:",t),"function"==typeof i&&i(null)})}else{this[e(185)]=i;let s=this[e(331)](t);this[e(170)][e(335)](e(363),s)}}isReady(){return this[n(296)]}[n(331)](t){const s=n;let i={x:0,y:0,w:t.width,h:t[s(327)]};return t[s(360)]>t[s(327)]?(i.w=t.height,i.x=(t.width-i.w)/2):(i.h=t[s(360)],i.y=(t[s(327)]-i.h)/2),this[s(563)]={x:t[s(360)],y:t[s(327)]},this[s(520)]=i,S[s(245)](t,i.x,i.y,i.w,i.h,this[s(180)][s(360)],this.inputSize[s(327)])}[n(523)](t,s){const i=n;let e=1;switch(s){case"x":return t*(e=this[i(520)].w/this[i(180)].width)+this[i(520)].x;case"y":return t*(e=this.croppedSize.h/this[i(180)].height)+this.croppedSize.y;case i(360):return t*(e=this[i(520)].w/this[i(180)][i(360)]);case"height":return t*(e=this[i(520)].h/this[i(180)][i(327)])}}[n(174)](t,s=!1){const i=n;let e=[],h=null,o=!1;for(let n in t){h=t[n],s&&(h[i(483)][0]=this[i(523)](h[i(483)][0],"x"),h[i(483)][1]=this[i(523)](h[i(483)][1],"y"),h[i(483)][2]=this.toOriginalSize(h[i(483)][2],i(360)),h[i(483)][3]=this[i(523)](h.bbox[3],"height")),o=!1;for(let t in e)if(e[t][i(283)]===h.class){let s=e[t],n=h,a=0,r=0;n[i(483)][0]>s[i(483)][0]&&n.bbox[0]<s[i(483)][0]+s[i(483)][2]?r=(a=s.bbox[0]+s[i(483)][2]-n[i(483)][0])/n.bbox[2]:s[i(483)][0]>n[i(483)][0]&&s[i(483)][0]<n[i(483)][0]+n[i(483)][2]&&(r=(a=n[i(483)][0]+n[i(483)][2]-s.bbox[0])/s.bbox[2]);let c=0,l=0;n.bbox[1]>s.bbox[1]&&n[i(483)][1]<s[i(483)][1]+s[i(483)][3]?(c=s[i(483)][1]+s[i(483)][3]-n[i(483)][1],l=a/n[i(483)][3]):s.bbox[1]>n[i(483)][1]&&s[i(483)][1]<n[i(483)][1]+n.bbox[3]&&(c=n[i(483)][1]+n.bbox[3]-s.bbox[1],l=a/s[i(483)][3]),r>.6&&l>.6&&(o=!0,n.score>s[i(529)]&&(e[t]=h))}!o&&e[i(266)](t[n])}if(this[i(260)][i(532)]&&e[i(534)]>0){let t=0,s=0;for(let h in e)e[h][i(529)]>t&&(t=e[h][i(529)],s=h);return[e[s]]}return e}[n(612)](){this.loadedTID=null}}class E{constructor(t={}){const s=n;this.options={server:!0,url:null,host:null,checkURI:null},this[s(260)]=o(this[s(260)],t),null==this[s(260)][s(597)]&&(this[s(260)].checkURI="mrzcheck"),this[s(296)]=!1,this[s(417)]()}[n(417)](){const t=n;this[t(260)][t(432)]}[n(181)](){const t=n;this.options[t(432)]&&(this[t(296)]=!0)}[n(512)](t,s,i){const e=n;this[e(260)].server&&this[e(456)](t,s,i)}recognizeGlobal(t,s,i){const e=n;let h=S.canvasToBase64(t,"image/jpeg",.9),o=new FormData;o.append("image",h),o[e(229)](e(307),s);let r=null!=this[e(260)][e(402)]?a[e(491)](this.options[e(402)]):"",c=null!=this[e(260)][e(641)]?this[e(260)][e(641)]:r+"/"+this[e(260)][e(597)];fetch(c,{method:"POST",body:o})[e(659)](t=>t.json())[e(659)](t=>{const s=e;m[s(654)]()[s(276)](s(470),t);let h=E.parseObject(t[s(560)]);!1===t[s(389)]&&(h.type=null),typeof i===s(213)&&i(h)})[e(561)](t=>{const s=e;console[s(205)](s(310),t),typeof i===s(213)&&i(null)})}[n(367)](t,s){}parse(t){const s=n;let i={type:null,text:t,object:null};if(i.count>75){const e=t[s(653)](0,3);e.includes("I<")||e.includes("1<")?i[s(573)]="I":(e[s(637)]("P<")||e[s(637)]("PC"))&&(i[s(573)]="P")}return i}static[n(198)](t){const s=n;let i={type:null,text:t.Lines[s(558)](""),object:t};if(i[s(569)][s(534)]>75){const e=t.Type;e.includes("I<")||e[s(637)]("1<")?i[s(573)]="I":(e[s(637)]("P<")||e[s(637)]("PC"))&&(i[s(573)]="P")}return i}}const R={NO_CARD:"nocard",MANY_CARDS:n(318),LOW_LIGHT:n(305),HIGH_LIGHT:n(390),TOO_SMALL:n(311)},N={NONE:n(404),ID:"id",PASSPORT:"passport"},P={NONE:n(404),ID_FRONT:n(618),ID_BACK:"id_back",PASS_FRONT:n(517)},L={NONE:n(404),SHOW:"show",ID_BACK:n(206),FINISH:n(221)},M={NONE:n(404),SCANNING:"scanning",FINISH:n(221)};class _{constructor(t,s={}){const i=n;this[i(419)]=t,this[i(260)]={host:null,headers:null,mrzOptions:null,detector:null,video:null,area:{x:0,y:0,width:0,height:0},detectTime:100,useServerSide:null,onCardDetected:null,onFaceDetected:null,onMRZDetected:null,onDetected:null,onError:null,onFinished:null,onCommand:null,onCommandResult:null,onStepChanged:null,mirrored:!0,delay:500,serverDelay:500,cardMinSize:{width:70,height:55}},this[i(260)]=o(this[i(260)],s),this[i(170)]=null,this[i(486)]=!1,this[i(557)]=null,this[i(375)]=M[i(589)],this[i(625)]=null,this[i(382)]={},this[i(403)]={},this.curFrame=null,this[i(172)]=null,this[i(248)]=null,this[i(387)]=null,this[i(514)]=null,this[i(577)]=this[i(260)][i(577)],this[i(323)]=null,this.options[i(478)]&&(this.delay=this[i(260)][i(583)]),this[i(648)]=new A({mirrored:this.options[i(257)],single:!0,serverSide:this[i(260)].useServerSide,host:this[i(260)].host,headers:this[i(260)].headers}),this[i(498)]=new E({host:this[i(260)].host,url:this[i(260)][i(656)]&&this[i(260)].mrzOptions.url||null}),this.cc=null,this[i(612)](),!this[i(260)][i(478)]&&this[i(255)]()}init(){const t=n;this[t(648)].load(),this.mrz[t(181)](),null!=this[t(170)]&&S.getImageFromURL("/img/face.jpg")[t(659)](s=>{const i=t;this.stream[i(335)](i(199),s)})}[n(255)](){const t=n;this[t(170)]=v[t(463)](t(186)),this[t(170)].on(t(564),s=>{const i=t;m.getInstance()[i(276)](i(347),s),this[i(375)]===M[i(294)]&&null!=this.curScan&&this[i(236)](s)})}[n(650)](t,s){const i=n;this[i(648)][i(254)]()&&this[i(648)][i(167)](t,t=>{typeof s===i(213)&&s(t)})}[n(663)](){const t=n;if(this[t(648)][t(254)]()&&null!=this[t(323)]){{let s=(new Date).getTime();if(this[t(375)]===M[t(589)]&&s-this[t(387)]>1e3)this[t(375)]=M[t(294)],this[t(493)](L[t(377)]);else{if(this[t(375)]===M.NONE)return;if(this[t(375)]===L.FINISH)return void(null!=this[t(514)]&&s-this[t(514)]>2e3&&(this[t(221)](),this[t(514)]=null))}}!this.detectionLocked&&(this.curScan=null,this.scanned={card:!1,face:!1,mrz:!1},this[t(486)]=!0,this.actualCanvas=this[t(419)],this[t(368)]=S.canvasToImageData(this[t(172)]),this[t(648)][t(167)](this.actualCanvas,this[t(323)],s=>{this[t(352)](s)}))}}[n(352)](t){const s=n;let i=null!=t&&t[s(534)]>0?t[0]:null,e=null;this.scanned[s(379)]=!0;let h=null!=i&&this.checkSize(i[s(483)]);if(null!=i&&!h&&this[s(549)](R[s(518)]),null!=i&&!0===h){m[s(654)]()[s(276)](s(306),t);let h={docType:this[s(521)](i[s(283)]),docFace:this[s(609)](i[s(283)]),card:i,face:null,mrz:null,image:null};this[s(625)]=h;let n=S[s(369)](this[s(368)]);if(e=S[s(522)](n,i[s(483)][0],i[s(483)][1],i[s(483)][2],i[s(483)][3]),h[s(513)]=e[s(280)](s(502),.9),this[s(248)]=e,0!==this[s(403)][s(281)].length||h.docFace!==P[s(400)]&&h[s(504)]!==P.PASS_FRONT)if(this.result[s(281)].length>0&&this[s(403)][s(337)]===N.ID&&h[s(504)]===P[s(474)]){let t=.6*e.height,h=S[s(522)](e,0,t,e.width,e[s(327)]-t);if(void 0===i[s(498)]||null==i[s(498)]){S.getLaplacianVariance(h,10)>10?this[s(498)][s(512)](h,this[s(323)],t=>{this[s(542)](t)}):this[s(212)](this[s(577)])}else this.onMRZDetected(i[s(498)]);this[s(382)][s(348)]=!0}else this[s(212)](this.delay);else if(void 0===i[s(348)]||null==i.face?this[s(170)][s(335)](s(199),e):this[s(236)]([i.face]),h[s(504)]===P[s(290)]){let t=.7*e[s(327)],h=S[s(522)](e,0,t,e[s(360)],e[s(327)]-t);if(void 0===i.mrz||null==i[s(498)]){S[s(633)](h)>5?this[s(498)].recognize(h,this[s(323)],t=>{this.onMRZDetected(t)}):this.unlock(this[s(577)])}else this[s(542)](i[s(498)])}else this[s(382)][s(498)]=!0;this[s(602)](t),this[s(273)]()}else this[s(602)]([]),this[s(357)]([]),this[s(212)](this[s(577)])}[n(397)](t){const s=n;let i=this[s(172)][s(360)],e=this[s(172)][s(327)],h=this[s(260)][s(297)];return null!=t&&t.length>=4&&(t[2]/i*100>h.width||t[3]/e*100>h[s(327)])}[n(236)](t){const s=n;if(m.getInstance()[s(276)](s(236),t),this[s(382)][s(348)]=!0,null!=this[s(625)]){if(this.curScan[s(348)]=null,t[s(534)]>0){let i=S[s(522)](this[s(248)],t[0].x,t[0].y,t[0].width,t[0][s(327)]),e=S[s(633)](i,10);m.getInstance().log("face laplacian",e),e>10&&(this.curScan[s(348)]=t)}"function"==typeof this[s(260)][s(236)]&&this[s(260)][s(236)](t),this.checkScanResult()}}[n(542)](t){const s=n;m[s(654)]()[s(276)](s(542),t),this[s(382)][s(498)]=!0,null!=this[s(625)]&&(null!=t&&null!=t[s(190)]&&!0===t[s(190)][s(401)]?this[s(625)][s(498)]=t:null!=t&&!0===t[s(401)]?this.curScan[s(498)]=E.parseObject(t):this[s(625)][s(498)]=null,"function"==typeof this[s(260)][s(542)]&&this.options.onMRZDetected(t),this.checkScanResult())}checkScanResult(){const t=n;if(!this.isAllScanned())return;let s=this.curScan,i=!1;0!==this[t(403)][t(281)].length||s.docFace!==P[t(400)]&&s.docFace!==P[t(290)]?1===this[t(403)].scans[t(534)]&&this.result[t(337)]===N.ID&&s.docFace===P[t(474)]&&null!=s[t(379)]&&null!=s[t(498)]&&null!=s.mrz[t(573)]&&(this[t(403)][t(281)][t(266)](s),this[t(403)].status=!0,this[t(357)](this[t(625)]),this[t(345)](M[t(458)]),this[t(514)]=(new Date).getTime(),i=!0):s[t(504)]===P[t(400)]?null!=s.card&&null!=s[t(348)]&&1===s.face[t(534)]&&(this[t(403)][t(281)].push(s),this[t(403)][t(337)]=N.ID,this[t(403)][t(275)]=!1,this.callDetectedEvent(this[t(625)]),this[t(493)](L[t(474)]),i=!0,this.unlock(this[t(577)])):null!=s.card&&null!=s[t(348)]&&null!=s.mrz&&null!=s[t(498)][t(573)]&&(this.result[t(281)][t(266)](s),this[t(403)][t(337)]=N[t(353)],this[t(403)][t(275)]=!0,this[t(357)](this[t(625)]),this[t(345)](M[t(458)]),this[t(514)]=(new Date)[t(647)](),i=!0),!i&&this[t(382)][t(379)]&&this[t(382)][t(348)]&&this[t(382)][t(498)]&&this[t(212)](this[t(577)])}[n(233)](){const t=n;for(let s in this[t(382)])if(!0!==this[t(382)][s])return!1;return!0}[n(345)](t){const s=n;this[s(375)]!==t&&(this.step=t,typeof this[s(260)][s(262)]==s(213)&&this.options.onStepChanged(t))}[n(602)](t){const s=n;null!==t&&typeof this[s(260)][s(352)]===s(213)&&this.options.onCardDetected(t)}[n(357)](t){const s=n;typeof this[s(260)].onDetected===s(213)&&this.options[s(300)](t)}[n(549)](t){const s=n;"function"==typeof this.options[s(484)]&&this[s(260)][s(484)](t)}[n(655)](){return this.step}[n(212)](t=null){const s=n;t=null==t?this[s(577)]:t,clearTimeout(this[s(557)]),this.timeID=setTimeout(()=>{this[s(486)]=!1},t)}[n(612)](){const t=n;this[t(375)]=L[t(589)],this[t(403)]={status:!1,docType:N[t(589)],scans:[],tID:null},this.curScan=null,this[t(382)]={},this[t(486)]=!1,this[t(248)]=null,this[t(323)]=null,this[t(648)].reset()}start(){const t=n;this[t(375)]=M[t(589)],this[t(493)](L[t(589)]),this[t(387)]=(new Date).getTime(),this[t(648)][t(260)][t(586)]?this.detector[t(210)]((s,i)=>{const e=t;this[e(323)]=i,this[e(403)].tID=this.tID}):(this[t(323)]=String(this[t(387)]+Math[t(231)](1e5*Math[t(282)]())),this.result[t(323)]=this.tID)}finish(){const t=n;this[t(493)](L[t(458)]),typeof this[t(260)][t(588)]===t(213)&&this[t(260)].onFinished(this.result)}[n(493)](t){const s=n;typeof this[s(260)][s(381)]===s(213)&&this[s(260)].onCommand(t)}defineScanType(t){const s=n;switch(t){case"id_front":case s(206):return N.ID;case"pass_main":case s(628):return N.PASSPORT;default:return N[s(589)]}}[n(609)](t){const s=n;switch(t){case"id_front":return P[s(400)];case s(206):return P[s(474)];case s(256):case s(628):return P[s(290)];default:return P[s(589)]}}[n(288)](){return this.step}}class z{constructor(t,s={}){const i=n;this[i(419)]=t,this[i(260)]={srcDim:{k:1,dx:0,dy:0,dw:0,dh:0},mirrored:!0,areaColor:i(317),areaOpacity:.5,showArea:!0,showDetectors:!0},this[i(260)]=o(this[i(260)],s),this.cc=new f(this[i(260)][i(309)])}[n(421)](t,s,i){}[n(457)](){}[n(450)](t){const s=n;if(!this[s(260)][s(204)])return;let i=t.width+20,e=t[s(327)]+20,h=(this.canvas[s(360)]-i*this[s(419)][s(360)]/100)/2,o=(this[s(419)].height-e*this[s(419)][s(327)]/100)/2,a=this[s(419)].getContext("2d");a[s(354)](),a.beginPath(),a[s(251)]=3;let r=parseInt(this[s(260)][s(587)][s(594)](1,2),16),c=parseInt(this.options[s(587)][s(594)](3,2),16),l=parseInt(this[s(260)][s(587)][s(594)](5,2),16);a[s(420)]=s(214)+r+", "+c+", "+l+", "+this[s(260)].areaOpacity+")",a[s(422)](h,o,this[s(419)][s(360)]-2*h,this.canvas[s(327)]-2*o),a[s(619)](),a[s(652)](),a[s(284)]()}[n(355)](t,s=n(661),i=""){const e=n;if(!this[e(260)][e(392)])return;let h=this.canvas[e(176)]("2d"),o=null,a=null,r=null;for(let n in t)r=t[n],o=this.options[e(257)]?this[e(419)][e(360)]-this.cc[e(195)](r.bbox[0])-this.cc[e(320)](r[e(483)][2]):this.cc.getCoordX(r.bbox[0]),a=this.cc[e(242)](r[e(483)][1]),h[e(261)](),h.lineWidth="2",h[e(420)]=s,h.rect(o,a,this.cc[e(320)](r[e(483)][2]),this.cc[e(320)](r[e(483)][3])),h[e(619)](),h[e(251)]="0",h[e(241)]=s,h[e(396)](o-1,a-20,150,20),h[e(349)]=e(336),h[e(241)]="white",h[e(585)]=e(371),h.fillText(r[e(283)]+" "+Number(r[e(529)])[e(384)](2),o+5,a-5),h[e(619)](),h[e(349)]="20px Arial",h[e(241)]=s,h[e(585)]="center",h[e(395)](i,o+this.cc.getSize(r[e(483)][2])/2,a+this.cc[e(320)](r[e(483)][3])/2),h.closePath();h[e(284)]()}}class W{constructor(t={}){const s=n;this.worker=null,this[s(170)]=null,this[s(260)]={path:null},this[s(260)]=o(this[s(260)],t),this[s(417)]()}[n(417)](){const t=n;this[t(170)]=v[t(463)](t(316)),this[t(170)].on(t(194),this[t(194)].bind(this)),this[t(170)].on("getCard",this[t(363)][t(356)](this)),window.Worker&&null!=this[t(260)].path?(this[t(186)]=new Worker(this[t(260)][t(425)]),this[t(186)].onmessage=this[t(339)][t(356)](this)):m[t(654)]()[t(276)]("Your browser doesn't support web workers.")}[n(363)](t){const s=n;let i=null;t instanceof HTMLCanvasElement?i=S[s(584)](t):t instanceof HTMLImageElement&&(i=S[s(621)](t)),this[s(186)][s(550)]({type:s(252),action:s(363),data:i})}[n(194)](){const t=n;this[t(186)][t(550)]({type:t(252),action:t(194)})}[n(339)](t){const s=n;let i=t.data[s(573)],e=(t.data[s(496)],t.data[s(560)]);switch(i){case s(252):this[s(170)].notify(s(537),e);break;case"scanLoaded":this.stream[s(335)](s(426),e)}}}class j{constructor(t,s={}){const i=n;this[i(440)]=null,this.canvas=null,this.camera=null,this.state={start:!1,detectInit:!1,analyzeAfterOpen:!1},this[i(186)]=null,this[i(260)]={url:null,headers:null,src:null,sourceType:null,width:1920,height:1080,onInit:null,onFrameCaptured:null,onCardDetected:null,onDetected:null,onCommand:null,sessionTime:6e4,detectTime:100,onFinished:null,mirrored:!0,scan_worker_path:i(646),face_worker_path:"js/deeptinyfaceworker.min.js",testURL:null,mrzOptions:null,useServerSide:null,serverRequestDelay:500,detector:{},camera:{fillOnMobile:!0,fill:!0,cutEdge:!0},visual:{areaColor:i(317),showArea:!0,showDetectors:!0}},this.analizer=null,this[i(500)]=null,this[i(187)]=null,this[i(423)]=null,this[i(179)]=null,this[i(442)]=null,this[i(203)]=null,this[i(445)]=null,this[i(600)]=L[i(589)],this.lastResult=null,this[i(427)]=0,this[i(260)]=o(this[i(260)],s),(null==this.options[i(478)]&&l[i(568)]()||l[i(269)]())&&(this.options[i(478)]=!0),this[i(350)](t),this.setup()}[n(350)](t){const s=n;this.camera=new p(t,{src:this[s(260)][s(541)],width:this[s(260)][s(360)],height:this.options[s(327)],fill:this[s(260)][s(567)][s(376)],fillOnMobile:this.options[s(567)][s(468)],cutEdge:this[s(260)][s(567)][s(591)],onFrameUpdated:this[s(346)][s(356)](this),onLoaded:this[s(215)][s(356)](this),onStart:this[s(452)][s(356)](this),onStop:this[s(459)][s(356)](this)}),this[s(440)]=this.camera[s(440)],this.canvas=this[s(567)][s(419)]}[n(417)](){const t=n;if(this.cc=new f(this[t(567)][t(510)]),this.visual=new z(this[t(419)],{srcDim:this[t(567)][t(510)],mirrored:this[t(260)][t(257)],areaColor:this[t(260)].visual[t(587)],showArea:this[t(260)].visual[t(204)],showDetectors:this.options[t(500)][t(392)]}),this[t(460)]=new _(this[t(567)][t(455)],{host:this.options.url,headers:this.options.headers,mrzOptions:this.options.mrzOptions,detector:this[t(260)][t(648)],useServerSide:this[t(260)][t(478)],onCommand:this[t(381)][t(356)](this),onCardDetected:this[t(352)].bind(this),onDetected:this.onDetected[t(356)](this),onFinished:this[t(588)][t(356)](this),onError:this[t(484)][t(356)](this),mirrored:this[t(260)].mirrored,serverDelay:this[t(260)].serverRequestDelay}),!this[t(260)].useServerSide){let s=t(304)+(new Date)[t(647)]();this.faceWebWorker=new C({path:this[t(260)][t(623)]+s}),this[t(423)]=new W({path:this[t(260)][t(494)]+s})}this[t(460)].cc=this.cc,typeof this[t(260)][t(312)]==t(213)&&this.options[t(312)]()}open(){const t=n;!this.camera[t(226)]()&&(this.camera.start(),this[t(460)][t(250)]())}close(){const t=n;this.stop(),this.camera[t(515)]()}start(){const t=n;this[t(437)]=null,this.lastCommand=L[t(589)],this[t(567)][t(226)]()?(this[t(638)][t(443)]=!0,this[t(460)][t(443)]()):(this[t(463)](),this[t(638)][t(508)]=!0),this.clear(),this[t(427)]=(new Date).getTime()}stop(){const t=n;this[t(638)][t(443)]=!1,this[t(638)][t(508)]=!1,this[t(460)][t(612)](),this[t(471)]()}testSource(t,s){const i=n;S[i(329)](t)[i(659)](t=>{let e=S[i(621)](t);this.analizer.testDetect(e,s)})}clear(){const t=n;this[t(179)]=[],this[t(203)]=null,this[t(445)]=null,this[t(442)]=null,this[t(427)]=0}[n(588)](t){const s=n;this.lastDetected=[],this.lastScanned=null,this[s(500)][s(355)]([]),this[s(515)](),typeof this[s(260)][s(588)]==s(213)&&this.options[s(588)](t)}[n(352)](t){const s=n;this[s(179)]=t,this[s(442)]=(new Date)[s(647)](),"function"==typeof this[s(260)][s(352)]&&this[s(260)][s(352)](t)}onDetected(t){const s=n;this[s(203)]=t,this.lastScannedTime=(new Date).getTime(),m[s(654)]()[s(276)](s(399),t),typeof this[s(260)][s(300)]===s(213)&&this[s(260)].onDetected(this[s(203)])}[n(381)](t){const s=n;this[s(600)]=t,this[s(638)][s(443)]&&typeof this[s(260)][s(381)]===s(213)&&this.options[s(381)](t)}onCommandResult(){}[n(484)](t){const s=n;switch(t){case R[s(518)]:m[s(654)]().log(s(451))}}onFrameUpdated(){const t=n;if(this[t(638)][t(443)]){let s=this[t(203)]&&this[t(203)].card?[this[t(203)][t(379)]]:[];if(0===s[t(534)]&&null!=this[t(179)]&&this[t(179)][t(534)]>0){s=this[t(179)];let i="";this[t(600)]===L.ID_BACK&&this.lastDetected[0][t(283)]===t(206)?(i=t(412),this[t(500)][t(355)](s,"orange",i)):this[t(600)]===L[t(377)]&&(this[t(179)][0][t(283)]===t(256)||this[t(179)][0][t(283)]===t(628))&&(i=t(412),this.visual.drawCard(s,"orange",i))}else{let i=this[t(207)](this[t(445)]);null!=i&&i<2e3&&this[t(500)][t(355)](s)}this[t(460)].getStep()===M[t(294)]&&this[t(500)][t(450)](this[t(460)].options.cardMinSize),(new Date)[t(647)]()-this.sessionTimeCount>this[t(260)][t(393)]?this[t(588)]({status:!1,msg:t(489)}):this[t(460)].observe()}}onCameraLoaded(t,s){const i=n;this.cc[i(209)](s)}[n(452)](){const t=n;this[t(638)][t(508)]&&(this[t(638)][t(508)]=!1,this[t(443)]())}[n(459)](){}[n(207)](t){return null==t?null:(new Date).getTime()-t}}n(348),n(225);const H=class{constructor(t={}){const s=n;this[s(260)]={url:null,headers:null,debug:!1},this.options=o(this[s(260)],t),this.data=new r(t[s(641)]||null,this.options),new m({debug:this[s(260)][s(556)]})}[n(433)](t,s){return new O(t,s)}[n(430)](t,s){const i=n;let e=o({url:this[i(260)][i(641)],headers:this[i(260)].headers},s);return new j(t,e)}[n(552)](t,s){}[n(415)](t,s){const i=n;this[i(560)][i(464)](t,t=>{typeof s===i(213)&&s(t)})}[n(568)](){return l[n(568)]()}}}},s={};function i(e){if(s[e])return s[e].exports;var h=s[e]={exports:{}};return t[e](h,h.exports,i),h.exports}return i.d=((t,s)=>{for(var e in s)i.o(s,e)&&!i.o(t,e)&&Object.defineProperty(t,e,{enumerable:!0,get:s[e]})}),i.o=((t,s)=>Object.prototype.hasOwnProperty.call(t,s)),i(614)})().default});

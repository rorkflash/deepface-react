!function(t,s){"object"==typeof exports&&"object"==typeof module?module.exports=s():"function"==typeof define&&define.amd?define([],s):"object"==typeof exports?exports.DCFaceID=s():t.DCFaceID=s()}(this,function(){return(()=>{"use strict";var t={614:(t,s,i)=>{i.d(s,{default:()=>j});const e=["noface","onFrameUpdated","toVerify","onmessage","push","actualCanvas","video","src","rgba(","132rOGSJG","camera","parse","callback","undefined","getTracks","landmark","options","streams","testDetect","textAlign","look right","start","useServerSide","visual","getImageData","data","actionWaitBeforeCheck","status","fit2Size","kind","height","srcObject","filter","addActionTime","card/detect","innerHtml","analyzeAfterOpen","actionWaitTime","none","match","drawArea","rect","drawCard","getTime","outofbounds","NONE","snapshot","checkURI","debug","face laplacian","getCurrentStep","enumerateDevices","getLaplacianVariance","setOptions","request","path","slice","globalAlpha","detectTime","797595lXiHAE","curScan","REJECT","scan","webWorker","PASS_FRONT","orange","look forward","detectedFaceCountDownBeforeStart","toFixed","devicePixelRatio","sessionTimeCount","absolute","recognizeGlobal","look left","current","getVideoTracks","recognize","serverSide","paused","application/json","image/png","onStart","manycards","quadraticCurveTo","drawImage","reject","Success:","finishWaitTime","df-container","startSession","server","commands","loaded","forEach","scanned","beginPath","manyFace","step","width","right","toOriginalSize","tid","ctx","POST","nocard","1GWgRvj","FINISH","appendChild","sourceDim","getTimeDiff","log","delay","1612931TtshPa","ellipse","getLastDetected","style","loading","image/jpeg","success","canvasToImageData","videoWidth","delete","fillText","lineWidth","Worker","center","maskSize","globalCompositeOperation","onStepChanged","textContent","214LNSvYX","defineCurrentAction","some","callCommandChange","state","mediaDevices","rgb(66,109,139)","chrome","shuffle","defineContainer","font","isPlaying","backgroundColor","getInstance","ID_BACK","commandText","onStop","auto","resHeight","setText","getFace","bottom","callCommandResult","fillStyle","offsetHeight","includes","lastResult","mirrored","getContext","onScanLoaded","defineStream","GET","detectTimer","onLoaded","parseObject","face","LEFT","getCoordX","onWorkerMessage","reset","actionText","detect","1219970WtDvgW","scan-worker","hasCommand","1451337OHkhtf","cardImage","analizer","area","down","xor","stream","stringify","notify","onCameraStart","isRearCameraUsed","pass_front","close","strokeStyle","callError","hide","stop","RIGHT","onScanResult","drawMask","Error loading ","passport","callDetectedEvent","anonymous","pitch","facingMode","devices","lastDetectedTime","append","left","classList","canvas2grayscale","normalizing","callCardDetectedEvent","actionArea","box","onDetect","pass_full","onCameraStop","name","mrz","sizeKoef","video-layer","errorTime","clear","defineProcess","finishTime","blankCanvas","setAttribute","2etPjrM","single","restore","cutLastSlash","card/ready","onCommand","inputSize","onFinished","index","faceWebWorker","moveTo","isSafari","currentCommand","detector result","onCameraLoaded","fillOnMobile","getSize","outOfBounds","currentActionList","isOffscreenCanvasSupport","toosmall","snapshotlist","toDataURL","areaColor","checkScanResult","srcDim","canvasToBase64","scans","PASSPORT","net","isMobile","apply","results","display","showArea","getLandmark","getBox","getCard","getPassTime","clearSnapshots","data processing, please wait...","environment","chooselist","getStep","count","currentAction","imageToCanvas","dim","crossOrigin","timeID","position","end","20px Arial","showDetectors","indexOf","SCANNING","dom","serverDelay","lowlight","id_back","catch","autoplay","blinking","originalSize","mrzOptions","Initializing","canvas2IMG","onload","checkPosAndActions","innerHTML","getPose","showProcessing","Valid","collect","keys","Received:","act2Command","SUCCESS","drawStreamToCanvas","docFace","clearRect","854571zDQruu","lineTo","currentPosition","webgl","headers","lastScannedTime","onMRZDetected","worker","muted","onFaceDetected","Your browser doesn't support web workers.","14px Arial","init","actions","initContainer","verify","6744mTLHzf","DOWN","getImageFromURL","cropCanvas","createDeepStory","scanner","open","createElement","max","observe","scale","div","startTime","faceDetected","detectionLocked","lastScanned","resizeCanvas","remove","command","error","ID_FRONT","observers","blur","roll","draw mask layer","__canvas","checkCurrentCommandAction","isErrorExist","result","detector","cutEdge","loadedTID","#FFFFFF","top","setCommand","function","play","image","applyConstraints","getTinyFace","initWorker","id_front","currentStepActive","6780CvIiRO","list","scanning","isAllScanned","sessionTime","mrzcheck","card","source-over","defineCommands","setFace","raf","opacity","finished","js/deeptinyfaceworker.min.js","putImageData","isReady","Please follow the commands","tID","valid","assign","videoHeight","onpause","type","getArea","onError","onInit","rear camera used","random","save","getUserMedia","/verify","onCommandResult","load","lastDetected","onStartDownCount","closePath","croppedSize","substr","getCoordY","web camera exception!","ACTIONS","showTextArea","onStreamLoaded","bind","js/deepfaceworker.js","DIV","loadCard","setDim","pass_main","add","black","Card model loaded","text","userAgent","msg","score","onCardDetected","arc","session timeout","host","scanWebWorker","round","getSettings","drawFaces","faceMask","onFaceResult","white","headpos","Error:","floor","green","atan2","interval","fixedTime","streamSize","then","finish","commander","noFace","yaw","cropAndResizeCanvas","docType","defineScanFace","INIT","analyser","onStep","worker_path","url","getCoord","maskInited","highlight","next","lock","show","calculate","postMessage","setup","onloadeddata","1hARGSz","pos","callStepChange","fillRect","unlock","forward","action","errorWaitTime","fireCommand","curFrame","onDetected","processing","lastCommand","tagName","landMarks","look up","onTinyFaceResult","stroke","30px","getImageB64","FORWARD","changeStep","time","Type","cardMinSize","onerror","face_worker_path","drawPath","startingWaitTime","0.5","videoSize","number","videoinput","scanLoaded","bbox","__canvas_original","tinyFaceDetected","areaOpacity","START","length","canvas","class","errors","block","CANVAS","gray","json","defineScanType","imageDataToCanvas","dpr","draw","fill"],h=W;!function(t,s){const i=W;for(;;)try{if(889815===parseInt(i(474))*-parseInt(i(907))+-parseInt(i(742))*parseInt(i(631))+parseInt(i(533))*parseInt(i(692))+parseInt(i(858))+-parseInt(i(795))+parseInt(i(788))*parseInt(i(855))+parseInt(i(813))*parseInt(i(490)))break;t.push(t.shift())}catch(s){t.push(t.shift())}}(e);const n=(t,s)=>{const i=W;for(let e of Object[i(981)](s))s[e]instanceof Object&&Object[i(552)](s[e],n(t[e]||{},s[e]));return Object[i(552)](t||{},s),t};class o{static[h(910)](t){const s=h;return"/"===t[s(570)](t.length-1)?t[s(739)](0,-1):t}}class a{constructor(t="",s={}){const i=h;this[i(620)]=t,this.options={headers:{}},this.options=n(this[i(699)],s)}[h(685)](t,s){const i=h;if(null!=t&&null!=t[i(495)]&&null==t.face){let e={docType:t.scanner[i(614)]||null,scans:[],tid:t[i(495)][i(550)]};for(let s in t[i(495)][i(934)])e[i(934)][i(687)]({docFace:t.scanner[i(934)][s].docFace||null,image:t[i(495)][i(934)][s][i(527)]});let h=n({"Content-Type":i(762)},this[i(699)][i(478)]||{});fetch(o[i(910)](this[i(620)])+i(563),{method:i(786),headers:h,body:JSON[i(865)](e)})[i(608)](t=>t[i(677)]()).then(t=>{const e=i;if(typeof s===e(525)){let i={success:t[e(801)],data:t[e(708)]||null,msg:t[e(587)]||null};s(i)}})[i(967)](t=>{const e=i;console.error("Error:",t),typeof s===e(525)&&s({success:!1,error:t})})}}}class r{constructor(t){this.canvas=t}[h(980)](){}showCollection(){}[h(886)](){}[h(737)](){}}class c{static isMobile(){const t=h;return[/Android/i,/webOS/i,/iPhone/i,/iPad/i,/iPod/i,/BlackBerry/i,/Windows Phone/i][t(815)](s=>{const i=t;return navigator[i(586)][i(722)](s)})}static isWebGLExist(){const t=h;try{document[t(497)](t(671))[t(841)](t(477))}catch(t){return!1}return!0}static[h(926)](){return"function"==typeof OffscreenCanvas}static[h(918)](){const t=h;let s=navigator[t(586)].toLowerCase();return-1!==s[t(961)]("safari")&&-1===s[t(961)](t(820))}}let l=null;class d{constructor(t={}){const s=h;if(l)return l;l=this,this.options={debug:!1},this[s(736)](t)}static[h(826)](t=null){if(l)return null!=t&&l[h(736)](t),l;l=new d(t||{})}[h(736)](t={}){const s=h;this[s(699)]=n(this[s(699)],t)}[h(793)](){const t=h;this[t(699)][t(731)]&&console[t(793)][t(938)](null,arguments)}}const u=d;const m=class{constructor(t,s={}){const i=h;this[i(963)]=null,this[i(671)]=null,this[i(515)]=null,this.__canvas_original=null,this[i(689)]=null,this[i(864)]=null,this.visual=null,this.raf=null,this[i(607)]={width:0,height:0},this[i(791)]={k:1,dx:0,dy:0,dw:0,dh:0},this.snapshotlist=[],this[i(884)]=[],this.frontCamera=!0,this.dpr=1,this[i(699)]={src:null,sourceType:null,width:640,height:480,resWidth:1280,resHeight:720,fill:!1,fillOnMobile:!0,cutEdge:!1,onLoaded:null,onError:null,onStop:null,onStart:null,onFrameUpdated:null},this[i(699)]=n(this.options,s),this[i(822)](t),this[i(629)]()}[h(822)](t){const s=h;if(this[s(680)]=window[s(752)]||1,"string"==typeof t){let i=document.getElementById(t);i&&i[s(644)]&&(i[s(644)]===s(578)?(this[s(963)]=i,this[s(963)][s(976)]="",this[s(671)]=document.createElement(s(675)),this[s(671)][s(781)]=this.options[s(781)],this[s(671)].height=this[s(699)].height,this.dom[s(790)](this.canvas)):i[s(644)]===s(675)&&(this[s(671)]=i,this[s(963)]=document[s(497)]("DIV"),this[s(671)].parentElement.insertBefore(this[s(963)],this[s(671)]),this.dom[s(790)](this.canvas)),this[s(963)]&&(this.dom[s(888)][s(582)](s(771)),this.dom[s(798)][s(781)]=this[s(699)][s(781)]+"px",this[s(963)][s(798)].height=this[s(699)][s(713)]+"px")),this.canvas&&(this.canvas[s(888)].add(s(900)),this.canvas[s(798)][s(825)]=s(676))}this[s(515)]=document.createElement(s(675)),this[s(515)].width=this.options.width,this[s(515)].height=this[s(699)][s(713)],this[s(666)]=document[s(497)](s(675)),this[s(666)].width=this.options[s(781)],this.__canvas_original[s(713)]=this.options[s(713)]}setup(){const t=h;this[t(706)]=new r(this[t(671)])}[h(704)](){const t=h;(null==this[t(689)]||!this[t(824)]())&&this[t(843)]()}[h(874)](){const t=h;this[t(864)]&&this.stream[t(697)]().length>0&&(this[t(864)][t(697)]()[0].stop(),this[t(864)]=null)}[h(843)](){const t=h;c[t(937)]()&&!0===this[t(699)][t(922)]&&(this.options[t(682)]=!0),null==this.options[t(690)]?null==this.stream?navigator[t(818)]&&navigator.mediaDevices[t(562)]&&(null===this[t(689)]&&(this.video=document[t(497)](t(689)),this[t(689)][t(906)](t(968),""),this[t(689)][t(906)](t(482),""),this[t(689)][t(906)]("playsinline",""),this[t(689)].style[t(781)]="30px",this[t(689)].style[t(713)]=t(649),this[t(689)][t(798)][t(957)]=t(754),this[t(963)][t(790)](this.video),this[t(689)][t(798)][t(544)]=t(660)),this.raf=null,navigator[t(818)][t(734)]()[t(608)](s=>{const i=t;u[i(826)]()[i(793)]("media devices",s),this[i(884)]=s}),navigator[t(818)][t(562)]({audio:!1,video:{facingMode:t(948),width:{ideal:this[t(699)].resWidth},height:{ideal:this[t(699)][t(831)]}}}).then(i=>{const e=t;this.stream=i,this[e(689)][e(714)]=i,i.getVideoTracks()[0][e(528)]({focusMode:e(830),focusDistance:.33}),this[e(868)]()&&(u.getInstance()[e(793)](e(559)),this.frontCamera=!1),s(),this[e(689)].play()})[t(967)](s=>{const i=t;u[i(826)]().log(i(572),s),this[i(557)](s)})):this[t(689)][t(526)]():(this[t(689)][t(690)]=this[t(699)][t(690)],this[t(689)][t(526)]());let s=()=>{const s=t;this[s(689)][s(630)]=(()=>{this[s(575)]()}),this.video.onplaying=(()=>{const t=s;this.__canvas[t(781)]=this[t(689)][t(803)],this[t(515)][t(713)]=this.video.videoHeight,this.__canvas_original[t(781)]=this[t(689)][t(803)],this.__canvas_original[t(713)]=this.video[t(553)];let i=this[t(689)][t(803)],e=this[t(689)][t(553)],h=1;this.sourceDim.dw=this.canvas[t(781)],this[t(791)].dh=this.canvas[t(713)],this[t(699)].fill?this[t(671)][t(713)]/e<this.canvas.width/i?(h=this[t(671)][t(781)]/i,this[t(791)].dh=Math[t(594)](h*e),this[t(791)].dy=0,this[t(699)][t(520)]&&(this[t(666)][t(713)]=this[t(671)].height/h,this[t(515)][t(713)]=this[t(671)][t(713)]/h)):(h=this[t(671)][t(713)]/e,this.sourceDim.dw=Math.round(h*i),this[t(791)].dx=0,this.options.cutEdge&&(this.__canvas_original[t(781)]=this[t(671)][t(781)]/h,this[t(515)][t(781)]=this[t(671)][t(781)]/h)):this[t(671)].height/e<this.canvas[t(781)]/i?(h=this.canvas[t(713)]/e,this.sourceDim.dw=Math[t(594)](h*i),this.sourceDim.dx=(this.canvas.width-this[t(791)].dw)/2):(h=this.canvas[t(781)]/i,this[t(791)].dh=Math.round(h*e),this.sourceDim.dy=(this[t(671)][t(713)]-this[t(791)].dh)/2),this[t(791)].k=h,null!=this[t(543)]&&cancelAnimationFrame(this[t(543)]),this[t(543)]=requestAnimationFrame(this[t(471)].bind(this)),this[t(607)]={width:this[t(689)][t(803)],height:this[t(689)][t(553)]},this.onStart()}),this[s(689)][s(554)]=(()=>{const t=s;cancelAnimationFrame(this[t(543)]),this[t(829)]()})}}async drawStreamToCanvas(){const t=h;let s=this.frontCamera?-1:1,i=this[t(791)],e=this[t(689)][t(803)],n=this.video[t(553)],o=this[t(666)].getContext("2d");o[t(561)](),o[t(500)](1,1),this[t(699)].fill&&this[t(699)][t(520)]?o[t(767)](this[t(689)],(this[t(666)][t(781)]-e)/2,(this.__canvas_original.height-n)/2,e,n):o[t(767)](this[t(689)],0,0,this[t(666)][t(781)],this.__canvas_original[t(713)]),o[t(909)]();let a=this[t(515)][t(841)]("2d");a.save(),a[t(500)](s,1),this[t(699)][t(682)]&&this[t(699)].cutEdge?a.drawImage(this[t(689)],s*(this[t(515)].width-e)/2+(-1===s?s*e:0),(this[t(515)][t(713)]-n)/2,e,n):a[t(767)](this.video,-1===s?s*e:0,0,this.__canvas.width,this[t(515)].height),a.restore();let r=this[t(671)][t(841)]("2d"),c=(this[t(671)][t(781)]-this.sourceDim.dw)/2,l=(this[t(671)][t(713)]-this.sourceDim.dh)/2;r[t(473)](0,0,this[t(671)][t(781)],this[t(671)][t(713)]),r.save(),r[t(500)](1*s,1),r.drawImage(this[t(689)],s*c+(-1===s?s*i.dw:0),l,i.dw,i.dh),r.restore(),null!=this[t(864)]&&(this[t(684)](),this[t(543)]=requestAnimationFrame(this[t(471)].bind(this)))}[h(868)](){const t=h;let s=[];for(let i in this[t(884)])this.devices[i][t(712)]===t(663)&&s[t(687)](this[t(884)][i]);let i=this[t(864)]&&this.stream[t(758)]()[0][t(595)]()[t(883)]||null;return u[t(826)]()[t(793)](t(884),this[t(884)]),u[t(826)]().log(t(883),i),"environment"===i}[h(824)](){const t=h;return this[t(864)]&&this[t(689)]&&!this[t(689)][t(761)]}getImageData(){const t=h;return this[t(515)][t(841)]("2d").getImageData(0,0,this[t(515)].width,this[t(515)][t(713)])}[h(650)](){const t=h;return this[t(515)][t(929)]()}getSnapshots(){return this.snapshotlist}[h(729)](){this[h(928)].push(this.getImageB64())}[h(946)](){this[h(928)]=[]}[h(557)](t){const s=h;typeof this[s(699)][s(557)]===s(525)&&this[s(699)][s(557)](t)}onStreamLoaded(){const t=h;typeof this[t(699)][t(846)]===t(525)&&this[t(699)][t(846)](this.video,this[t(791)])}onStop(){const t=h;typeof this.options[t(829)]===t(525)&&this[t(699)][t(829)]()}onStart(){const t=h;typeof this.options[t(764)]===t(525)&&this[t(699)][t(764)]()}[h(684)](){const t=h;typeof this[t(699)][t(684)]===t(525)&&this[t(699)][t(684)]()}};class p{constructor(t={k:1,dx:0,dy:0,dw:0,dh:0}){this[h(954)]=t}setDim(t){this.dim=t}[h(621)](t,s){const i=h;return{x:t*this[i(954)].k+this[i(954)].dx,y:s*this.dim.k+this[i(954)].dy}}getCoordX(t){const s=h;return t*this[s(954)].k+this[s(954)].dx}[h(571)](t){return t*this[h(954)].k+this.dim.dy}[h(923)](t){return t*this[h(954)].k}toRealCoordX(t){const s=h;return t/this[s(954)].k-this[s(954)].dx}toRealCoordY(t){const s=h;return t/this[s(954)].k-this[s(954)].dy}}class f{constructor(t,s={width:0,height:0},i={width:0,height:0}){const e=h;this.dom=t,this[e(671)]=null,this.ctx=null,this[e(828)]=null,this[e(853)]=null,this[e(661)]=s,this[e(809)]=i,this[e(622)]=!1,this[e(899)]={h:.4,v:.6},(0===this[e(809)][e(781)]||0===this.maskSize[e(713)])&&(this[e(809)]={width:this.videoSize[e(781)]*this[e(899)].h,height:this.videoSize[e(781)]*this[e(899)].v}),this[e(629)]()}setup(){const t=h;null!=this[t(963)]&&(this.canvas=document[t(497)]("CANVAS"),this[t(671)].id="maskLayer",this[t(671)].width=this[t(661)][t(781)],this[t(671)][t(713)]=this[t(661)][t(713)],this[t(963)].appendChild(this[t(671)]),this[t(785)]=this.canvas[t(841)]("2d"))}createTextArea(){const t=h;if(this.commandText)this[t(828)][t(798)][t(940)]=t(674);else{this[t(828)]=document[t(497)](t(501)),this[t(828)].id="commandArea";let s=document[t(497)]("P");s[t(812)]="",this[t(828)][t(790)](s),this[t(963)][t(790)](this[t(828)]);let i=((this[t(671)][t(713)]-this[t(809)][t(713)])/2-this.commandText[t(837)])/2;this.commandText[t(798)][t(523)]=i+"px"}if(this[t(853)])this.actionText[t(798)].display="block";else{this.actionText=document[t(497)](t(501)),this[t(853)].id=t(892);let s=document[t(497)]("P");s[t(812)]="",this[t(853)].appendChild(s),this[t(963)].appendChild(this[t(853)]);let i=((this[t(671)].height-this[t(809)][t(713)])/2-this.commandText[t(837)])/2;this[t(853)][t(798)][t(834)]=i+"px"}}showTextArea(){const t=h;this[t(828)]&&(this[t(828)][t(798)][t(940)]=""),this.actionText&&(this[t(853)][t(798)][t(940)]="")}hideTextArea(){const t=h;this[t(828)]&&(this[t(828)][t(798)][t(940)]=t(721)),this[t(853)]&&(this[t(853)][t(798)].display=t(721))}[h(832)](t){const s=h;this[s(853)]&&(this[s(853)][s(718)]=t)}[h(524)](t){const s=h;this[s(828)]&&(this[s(828)].innerHtml=t)}getArea(){const t=h;return{x:this[t(671)].width/2-this[t(809)].width/2-20,y:this[t(671)][t(713)]/2-this[t(809)][t(781)]/2-20,width:this[t(809)][t(781)],height:this[t(809)].height}}draw(){const t=h;if(!this.maskInited){console.log(t(514)),this.ctx[t(561)](),this[t(785)][t(778)](),this[t(785)][t(796)](this.canvas[t(781)]/2,this[t(671)][t(713)]/2,this[t(809)][t(781)]/2,this.maskSize[t(713)]/2,Math.PI,0,2*Math.PI),this.ctx[t(836)]=t(819),this[t(785)][t(682)](),this[t(785)][t(810)]=t(863),this.ctx.beginPath(),this[t(785)][t(724)](0,0,this[t(671)].width,this[t(671)][t(713)]),this[t(785)][t(836)]="rgba(0, 0, 0, 1)",this[t(785)][t(568)](),this.ctx.fill(),this[t(785)][t(740)]=.5;let s=this[t(671)][t(929)]();this[t(785)][t(810)]=t(540);let i=new Image;i[t(974)]=(()=>{const s=t;this[s(785)].clearRect(0,0,this[s(671)][s(781)],this.canvas[s(713)]),this[s(785)][s(767)](i,0,0)}),i[t(690)]=s,this[t(622)]=!0,this.createTextArea()}}[h(626)](){const t=h;this.maskInited?(this[t(574)](),this[t(671)].style[t(940)]=t(674)):(this[t(681)](),this[t(671)].style[t(940)]=t(674))}[h(873)](){const t=h;this.hideTextArea(),this[t(671)].style[t(940)]=t(721)}[h(804)](){const t=h;this[t(785)][t(473)](0,0,this.canvas.width,this[t(671)][t(713)]),this.ctx[t(909)]()}}class g{constructor(t,s={}){const i=h;this[i(671)]=t,this.options={srcDim:{k:1,dx:0,dy:0,dw:0,dh:0}},this.options=n(this.options,s),this.cc=new p(this[i(699)].srcDim)}[h(658)](t,s,i){const e=h,n=new Path2D;n[e(917)](s[0][0],s[0][1]);for(let t=1;t<s[e(670)];t++){const i=s[t];n.lineTo(i[0],i[1])}i&&n[e(568)](),t.stroke(n)}[h(596)](t){const s=h;this[s(699)][s(932)].k;let i=null,e=this[s(671)][s(841)]("2d");e[s(561)]();for(let h=0;h<t[s(670)];h++){i=t[h].landMarks;for(let t=0;t<i.length;t++){const h=i[t][0],n=i[t][1];e[s(778)](),e[s(590)](this.cc[s(850)](h),this.cc[s(571)](n),1,0,2*Math.PI),e[s(682)](),e[s(568)]()}}e[s(909)]()}}class w{constructor(t){const s=h;this[s(897)]=t,this[s(511)]={}}on(t,s){const i=h;void 0===this[i(511)][t]&&(this.observers[t]=[]),typeof s==i(525)&&this[i(511)][t][i(687)](s)}remove(t,s){const i=h;for(const t in this[i(511)])this[i(511)][t]=this[i(511)][t][i(715)](t=>t!==s)}notify(t,s){const i=h;this[i(511)][t]&&this[i(511)][t][i(776)](t=>{typeof t==i(525)&&t(s)})}notifyAll(t){const s=h;this[s(511)][s(776)](i=>{const e=s;i[e(776)](s=>{typeof s==e(525)&&s(t)})})}}const y=new class{constructor(){this[h(700)]={}}[h(496)](t){const s=h;return!this[s(700)][t]&&(this.streams[t]=new w(t)),this[s(700)][t]}};class S{constructor(){}static[h(493)](t,s,i,e,n){const o=h;let a=document.createElement(o(675));return a[o(781)]=e,a[o(713)]=n,a[o(841)]("2d")[o(767)](t,s,i,e,n,0,0,e,n),a}static[h(506)](t,s={w:null,h:null}){const i=h;let e=document[i(497)](i(675));return null==s.w&&null==s.h?(e.width=t[i(781)],e[i(713)]=t[i(713)]):null==s.w?(e[i(713)]=s.h,e[i(781)]=s.h/t[i(713)]*t[i(781)]):null==s.h?(e[i(781)]=s.w,e[i(713)]=s.w/t.width*t[i(713)]):(e[i(781)]=s.w,e[i(713)]=s.h),e[i(841)]("2d")[i(767)](t,0,0,e[i(781)],e[i(713)]),e}static[h(613)](t,s,i,e,n,o,a){const r=h;let c=document.createElement(r(675));return c[r(781)]=o,c.height=a,c[r(841)]("2d")[r(767)](t,s,i,e,n,0,0,o,a),c}static[h(679)](t){const s=h;let i=document[s(497)]("CANVAS");return i.width=t.width,i[s(713)]=t.height,i[s(841)]("2d").putImageData(t,0,0),i}static[h(953)](t){const s=h;let i=document[s(497)](s(675));return i[s(781)]=t[s(781)],i[s(713)]=t[s(713)],i[s(841)]("2d")[s(767)](t,0,0),i}static[h(802)](t){const s=h;return t.getContext("2d")[s(707)](0,0,t[s(781)],t.height)}static canvasToBase64(t,s=h(763),i=.92){return t[h(929)](s,i)}static[h(973)](t,s=h(763),i=.92){return new Promise(function(e,h){const n=W;let o=new Image;o[n(906)](n(955),"anonymous"),o[n(974)]=(()=>{e(o)}),o[n(656)]=(t=>{h(n(878)+t)}),o[n(690)]=S.canvasToBase64(t,s,i)})}static[h(889)](t){const s=h;let i=t[s(841)]("2d")[s(707)](0,0,t[s(781)],t.height),e=i.data;for(let i=t[s(781)]*t[s(713)]*4-1;i>0;i-=4){let t=.3*e[i-3]+.59*e[i-2]+.11*e[i-1];e[i-3]=t,e[i-2]=t,e[i-1]=t}let n=document[s(497)](s(675));return n[s(841)]("2d")[s(547)](i,0,0),n}static[h(905)](t,s,i=h(583)){const e=h;let n=document[e(497)](e(675));n.width=t,n[e(713)]=s;let o=n.getContext("2d");return o[e(836)]=i,o[e(634)](0,0,t,s),n}static getLaplacianVariance(t,s=30){const i=h;let e=t[i(841)]("2d").getImageData(0,0,t.width,t[i(713)]).data,n=[[0,1,0],[1,-4,1],[0,1,0]],o=4*t.width,a=0,r=Math[i(602)](1.5),c=0,l=0;for(let h=1;h<t[i(713)]-1;h++)for(let t=4;t<o-4;t+=4){c=0;for(let s=0;s<3;s++)for(let i=0;i<3;i++){c+=(.3*e[a=o*(h+s-r)+t+4*(i-r)]+.59*e[a+1]+.11*e[a+2])*n[s][i]}c>s&&(l+=1)}return l}static[h(492)](t){return new Promise(function(s,i){const e=W;let h=new Image;h[e(906)](e(955),e(881)),h.onload=(()=>{s(h)}),h[e(656)]=(()=>{i(e(878)+t)}),h[e(690)]=t})}}class C{constructor(t={}){const s=h;this.worker=null,this.stream=null,this[s(699)]={path:null},this[s(699)]=n(this.options,t),this.setup()}[h(629)](){const t=h;this[t(864)]=y[t(496)](t(481)),this[t(864)].on(t(833),this.getFace[t(576)](this)),this[t(864)].on(t(529),this[t(529)][t(576)](this)),this[t(864)].on("loadCard",this.loadCard[t(576)](this)),this[t(864)].on(t(944),this[t(944)][t(576)](this)),window[t(807)]&&null!=this[t(699)][t(738)]?(this[t(481)]=new Worker(this[t(699)][t(738)]),this.worker.onmessage=this.onWorkerMessage[t(576)](this)):console[t(793)](t(484))}[h(833)](t){const s=h;let i=null;if(t instanceof HTMLCanvasElement){i=t[s(841)]("2d")[s(707)](0,0,t[s(781)],t.height)}else if(t instanceof HTMLImageElement){let e=document[s(497)](s(671)),h=e.getContext("2d");e.width=t[s(781)],e[s(713)]=t.height,h[s(767)](t,0,0),i=h.getImageData(0,0,t.width,t[s(713)])}this[s(481)][s(628)]({type:s(848),action:s(833),data:i})}[h(529)](t){const s=h;let i=null;if(t instanceof HTMLCanvasElement){i=t[s(841)]("2d")[s(707)](0,0,t[s(781)],t[s(713)])}else if(t instanceof HTMLImageElement){let e=document[s(497)](s(671)),h=e[s(841)]("2d");e[s(781)]=t.width,e[s(713)]=t[s(713)],h[s(767)](t,0,0),i=h[s(707)](0,0,t[s(781)],t[s(713)])}this[s(481)].postMessage({type:s(848),action:s(529),data:i})}[h(944)](t){const s=h;let i=null;t instanceof HTMLCanvasElement?i=S.canvasToImageData(t):t instanceof HTMLImageElement&&(i=S[s(953)](t)),this.worker.postMessage({type:s(745),action:s(944),data:i})}loadCard(){const t=h;this[t(481)][t(628)]({type:t(745),action:t(579)})}[h(851)](t){const s=h;let i=t[s(708)][s(555)],e=t[s(708)][s(637)],n=t.data[s(708)];switch(i){case s(848):e===s(503)?this[s(864)][s(866)](s(598),n):e===s(667)&&this[s(864)][s(866)](s(647),n);break;case"scan":this[s(864)][s(866)](s(876),n);break;case"scanLoaded":this[s(864)].notify(s(842),n)}}}const v=class{constructor(){const t=h;this.net=null,this[t(893)]={x:0,y:0,width:0,height:0},this.landmark=[],this[t(848)]=null,this.yaw=0,this.pitch=0,this[t(513)]=0}[h(542)](t){const s=h;this[s(848)]=t,this[s(893)]={x:t.x,y:t.y,height:t.height,width:t.width},this[s(698)]=t[s(645)],this[s(627)]()}[h(902)](){const t=h;this[t(936)]=null,this.box={x:0,y:0,width:0,height:0},this[t(698)]=[],this.face=null,this.yaw=0,this[t(882)]=0,this[t(513)]=0}[h(627)](){const t=h;let s=this[t(848)].landMarks[234],i=this[t(848)].landMarks[454],e=this[t(848)][t(645)][10],n=this[t(848)][t(645)][152];this.yaw=180*Math[t(604)](i[2]-s[2],i[0]-s[0])/Math.PI,this[t(882)]=180*Math[t(604)](n[0]-e[0],n[2]-e[2])/Math.PI,this[t(513)]=180*Math[t(604)](i[1]-s[1],i[0]-s[0])/Math.PI}[h(977)](){}getBox(){return this[h(893)]}[h(942)](){return this[h(698)]}},D={FORWARD:h(636),LEFT:"left",RIGHT:h(782),UP:"up",DOWN:h(862),SMILE:"smile",BLINKING:h(969),NONE:h(721)};class T{constructor(){const t=h;this.commands=[],this[t(951)]=2,this[t(949)]=[D[t(849)],D[t(875)],D.UP,D[t(491)],D.SMILE],this[t(915)]=0}[h(821)](){const t=h;this[t(902)]();for(let s=0;s<this.count;s++)this[t(774)][t(687)]({name:D[t(651)]});return this[t(774)]}[h(624)](){const t=h;return this[t(915)]<this[t(774)][t(670)]-1?(this.index++,this.commands[this[t(915)]]):null}[h(757)](){const t=h;return this.commands[this[t(915)]]}hasCommand(){const t=h;return this[t(915)]<this[t(774)][t(670)]-1}[h(902)](){const t=h;this.index=0,this[t(774)]=[]}}h(683),h(965),h(623),h(727);const b={NONE:"none",UP:"up",DOWN:h(862),FORWARD:h(636),LEFT:h(887),RIGHT:h(782)},x={NONE:"none",INIT:h(486),START:h(704),ACTIONS:h(487),FINISH:h(609)},I={SUCCESS:h(801),NONE:"none",REJECT:h(768)};class k{constructor(t,s={}){const i=h;this.canvas=t,this.options={video:null,area:{x:0,y:0,width:0,height:0},detectTime:100,startingWaitTime:2e3,onFaceDetected:null,onError:null,onFinished:null,onCommand:null,onCommandResult:null,onStep:null,onStartDownCount:null},this[i(699)]=n(this.options,s),this[i(845)]=null,this[i(673)]={lowLight:!1,highLight:!1,noFace:!1,manyFace:!1,outOfBounds:!1},this[i(476)]=b[i(728)],this[i(864)]=null,this.headpos=new v,this[i(610)]=new T,this.lock=!1,this[i(566)]=[],this[i(780)]=x.NONE,this.detectedFaceCountDownBeforeStart=3,this.fixedTime=0,this.errorTime=0,this.errorWaitTime=2e3,this[i(720)]=6e3,this[i(709)]=1e3,this.finishWaitTime=2e3,this[i(532)]=!1,this[i(784)]=null,this[i(939)]=[],this[i(919)]=D[i(728)],this[i(952)]=b[i(728)],this[i(925)]=[],this.cc=null,this.initWorker()}[h(530)](){const t=h;this[t(864)]=y.open(t(481)),this[t(864)].on("onFaceResult",s=>{const i=t;null!=this[i(845)]&&(this[i(483)](s),this.lock=!1)})}[h(704)](){const t=h;this[t(625)]=!1,this[t(566)]=[],this.currentStepActive=!1,this[t(780)]=x[t(616)],this[t(939)]=[],this[t(750)]=3,this[t(784)]=(new Date)[t(726)](),this.defineCommands(),this.callStepChange(this[t(780)]),clearTimeout(this[t(845)]),this[t(845)]=setTimeout(this[t(499)].bind(this),this.options[t(741)])}[h(874)](){const t=h;this[t(784)]=null,clearTimeout(this[t(845)]),this.detectTimer=null,this[t(625)]=!1,this[t(902)]()}[h(902)](){const t=h;this[t(566)]=[],this[t(780)]=x[t(728)],this[t(750)]=3,this.currentAction=b[t(728)],this[t(925)]=[],this[t(532)]=!1}[h(541)](){const t=h;let s=this.commander[t(821)]();for(let i in s)this[t(939)][t(687)]({pos:b.NONE,image:null,command:D.NONE,status:!1});u.getInstance().log("defineCommands",s)}[h(499)](){const t=h;!this.lock&&(this[t(864)][t(866)](t(833),this[t(671)]),this.lock=!0),this.detectTimer=setTimeout(this[t(499)][t(576)](this),this[t(699)][t(741)])}[h(483)](t){const s=h;if(this[s(673)].noFace=!1,this.errors[s(779)]=!1,this[s(476)]=b[s(728)],t[s(670)]>1)this[s(673)][s(779)]=!0;else if(0===t[s(670)])return this[s(673)][s(611)]=!0,"function"==typeof this[s(699)].onFaceDetected&&this[s(699)][s(483)]([]),void(this[s(625)]=!1);this[s(566)]=t,typeof this[s(699)][s(483)]===s(525)&&this[s(699)][s(483)](t),this.detectedFaceCountDownBeforeStart>0?(this[s(750)]--,this[s(606)]=(new Date)[s(726)](),this[s(901)]=(new Date)[s(726)]()):(this[s(600)][s(542)](t[0]),this.defineCurrentAction(),this.checkCurrentCommandAction()),this[s(625)]=!1}finish(t,s){const i=h;if(null==this[i(784)])return!1;let e={tid:this[i(784)],status:s,results:this[i(939)],image:null};for(let t in this[i(939)])if(this[i(939)][t][i(508)]===D.FORWARD&&!0===this[i(939)][t].status){e[t][i(527)]=this.results[t][i(527)];break}typeof this[i(699)][i(914)]===i(525)&&this.options[i(914)](e),this[i(874)]()}[h(814)](){const t=h;let s=this.headpos[t(943)](),i={x:this.cc[t(850)](s.x),y:this.cc.getCoordY(s.y),width:this.cc[t(923)](s[t(781)]),height:this.cc[t(923)](s[t(713)])},e=.3*this.options[t(861)][t(781)],n=.3*this[t(699)][t(861)].height,o=i.x+i[t(781)],a=i.y+i.height;if(!(i.x>this.options.area.x-e&&i.y>this[t(699)].area.y-n&&o<this[t(699)][t(861)].x+this[t(699)][t(861)].width+e&&a<this[t(699)][t(861)].y+this[t(699)][t(861)][t(713)]+n))return this.errors[t(924)]=!0,!1;this[t(673)][t(924)]=!1,this[t(600)][t(513)]<12&&this[t(600)][t(513)]>-12&&this[t(600)][t(882)]<=-20&&this.headpos.pitch>=-130&&this[t(600)][t(612)]>=-10&&this[t(600)][t(612)]<=10&&(this[t(952)]=b.FORWARD),this[t(600)][t(513)]<12&&this[t(600)][t(513)]>-12&&this[t(600)][t(612)]<-10&&(this[t(952)]=b.LEFT),this[t(600)].roll<12&&this.headpos.roll>-12&&this[t(600)][t(612)]>10&&(this.currentAction=b.RIGHT),this.headpos.roll<12&&this[t(600)][t(513)]>-12&&this.headpos[t(882)]<-130&&(this[t(952)]=b.UP),this[t(600)][t(513)]<12&&this.headpos[t(513)]>-12&&this[t(600)][t(882)]>-20&&(this[t(952)]=b[t(491)])}[h(516)](){const t=h;let s=this[t(517)](),i=this[t(792)](this[t(606)]);if(s?(this[t(476)]=b.NONE,this[t(872)](this.errors)):this[t(901)]=(new Date)[t(726)](),this[t(780)]===x[t(616)]&&(this[t(532)]=!1,this[t(780)]=x[t(669)],this[t(633)](this.step)),this[t(780)]===x[t(669)]){let s=Math[t(594)]((this.options[t(659)]-i)/1e3);s>0?"function"==typeof this[t(699)][t(567)]&&this.options[t(567)](s):(this[t(780)]=x[t(573)],this[t(532)]=!1,this.fixedTime=(new Date)[t(726)](),this[t(537)]=(new Date)[t(726)](),this[t(633)](this[t(780)]))}if(this[t(780)]===x[t(573)]&&(!1===s||0===this[t(638)])){let s=this[t(610)][t(915)],e=this[t(610)][t(757)]();this[t(919)]!==e[t(897)]&&(this.currentCommand=e[t(897)],this[t(925)]=[],this[t(816)](e[t(897)])),i>0&&this[t(925)][t(687)]({pos:this.currentAction,posPitch:this[t(600)][t(882)],posYaw:this[t(600)][t(612)],time:(new Date).getTime(),valid:!0,command:e});let h=this.actionWaitTime+this[t(709)]-i,n=i>this.actionWaitBeforeCheck?this[t(975)](e[t(897)],this[t(952)]):I[t(728)];if(h>0&&n===I[t(728)]);else if(i>this[t(709)]){let i=S.cropCanvas(this[t(671)],this[t(600)][t(893)].x,this[t(600)][t(893)].y,this[t(600)].box[t(781)],this[t(600)][t(893)][t(713)]);n===I[t(984)]?this[t(939)][s]={pos:this[t(952)],command:e,status:!0,image:i}:this[t(939)][s]={pos:this.currentAction,command:e,status:!1,image:i},this[t(835)](this[t(939)][s]),this.commander[t(857)]()?this[t(610)].next():(this[t(780)]=x[t(789)],this.headpos[t(902)](),this[t(633)](this[t(780)])),this.fixedTime=(new Date)[t(726)]()}}if(this[t(780)]===x[t(789)]){this[t(770)]-i>0||(this[t(780)]=x[t(789)],this[t(606)]=(new Date).getTime(),this[t(609)](!0,!0))}}[h(975)](t,s){const i=h;let e={},n=D[i(728)],o=D[i(728)],a={};for(let t in this[i(925)]){let s=this.currentActionList[t];null!=s&&s[i(551)]&&(null!=s[i(632)]&&(n=this[i(983)](s[i(632)])),null==e[n]&&(e[n]={list:[],max:0}),e[n]=this[i(716)](e[n],s,o!==n),a[n]=(a[n]||0)+1,o=n)}let r=a[i(670)];if(t===D[i(849)]||t===D.UP||t===D[i(875)]||t===D[i(491)]){if(r>3)return I[i(744)];if(null!=e[t]&&e[t][i(498)]>1e3)return I.SUCCESS}if(t===D[i(651)]){if(r>=3)return I[i(744)];if(null!=e[t]&&e[t].max>1e3)return I.SUCCESS}return I[i(728)]}callStepChange(t){const s=h;typeof this.options[s(618)]===s(525)&&this[s(699)][s(618)](t)}[h(872)](t){const s=h;typeof this[s(699)][s(557)]===s(525)&&this[s(699)][s(557)](t)}[h(816)](t){const s=h;typeof this[s(699)].onCommand===s(525)&&this[s(699)][s(912)](t)}[h(835)](t){const s=h;typeof this[s(699)][s(564)]===s(525)&&this.options[s(564)](t)}[h(797)](){return this[h(566)]}isErrorExist(){const t=h;for(const s in this[t(673)])if(!0===this[t(673)][s])return!0;return!1}[h(792)](t){const s=h;return(new Date)[s(726)]()-t}[h(983)](t){const s=h;switch(t){case b.LEFT:return D[s(849)];case b.UP:return D.UP;case b[s(875)]:return D.RIGHT;case b[s(491)]:return D[s(491)];case b.FORWARD:return D[s(651)];default:return D.NONE}}addActionTime(t,s,i){const e=h;let n=t,o=0;return n[e(534)].length>0&&null!=n[e(534)][o].start&&i?(o=n[e(534)][e(670)]-1,null!=s.time&&(n[e(534)][o][e(958)]=s[e(653)],n[e(534)][o][e(605)]=s[e(653)]-n[e(534)][o][e(704)],n.max=(n[e(534)][o][e(605)]||0)>n[e(498)]?n[e(534)][o][e(605)]||0:n[e(498)])):n[e(534)][e(687)]({start:s.time,end:null,interval:null}),n}}class F{constructor(t,s={}){const i=h;this[i(963)]=null,this.canvas=null,this[i(693)]=null,this[i(817)]={start:!1,detectInit:!1,analyzeAfterOpen:!1},this[i(699)]={src:null,sourceType:null,width:640,height:480,liveness:!0,onFrameCaptured:null,detectTime:100,onFinished:null,worker_path:i(577)},this[i(699)]=n(this.options,s),this.initContainer(t),this[i(629)]()}initContainer(t){const s=h;this[s(693)]=new m(t,{src:this[s(699)][s(690)],width:this[s(699)][s(781)],height:this.options.height,onFrameUpdated:this[s(684)][s(576)](this),onLoaded:this[s(921)][s(576)](this),onStart:this[s(867)][s(576)](this),onStop:this[s(896)][s(576)](this)}),this[s(963)]=this[s(693)].dom,this[s(671)]=this[s(693)][s(671)]}[h(629)](){const t=h;this.cc=new p(this[t(693)][t(791)]),this.faceMask=new f(this[t(963)],{width:this[t(699)][t(781)],height:this[t(699)][t(713)]}),this[t(706)]=new g(this[t(671)]),this[t(746)]=new C({path:this[t(699)][t(619)]}),this[t(617)]=new k(this.camera[t(515)],{area:this[t(597)][t(556)](),detectTime:this[t(699)][t(741)],onFaceDetected:this[t(483)][t(576)](this),onError:this[t(557)].bind(this),onFinished:this[t(914)].bind(this),onCommand:this.onCommand[t(576)](this),onCommandResult:this[t(564)][t(576)](this),onStep:this[t(618)][t(576)](this),onStartDownCount:this[t(567)][t(576)](this)}),this[t(617)].cc=this.cc}open(){const t=h;!this.camera.isPlaying()&&(this[t(693)][t(704)](),this.faceMask[t(626)]())}[h(870)](){const t=h;this[t(874)](),this[t(693)][t(874)](),this[t(597)][t(873)]()}start(){const t=h;this.camera[t(824)]()?(this[t(817)][t(704)]=!0,this[t(617)][t(704)]()):(this[t(496)](),this[t(817)][t(719)]=!0)}[h(874)](){const t=h;this.state.start=!1,this[t(617)][t(874)](),this[t(817)][t(719)]=!1}onFinished(t,s){const i=h;u[i(826)]()[i(793)](i(545)),this.faceMask[i(524)]("Finished"),"function"==typeof this[i(699)][i(914)]&&this[i(699)].onFinished(t,s)}[h(483)](t){}onCommand(t){const s=h;u[s(826)]()[s(793)]("onCommand",t);let i="";switch(t){case D[s(651)]:i=s(749);break;case D[s(849)]:i=s(756);break;case D.RIGHT:i=s(703);break;case D.UP:i=s(646);break;case D.DOWN:i="look down";break;default:i=""}this.faceMask[s(524)](i)}onCommandResult(){}[h(618)](t){const s=h;u[s(826)]()[s(793)](s(811),t);let i="";switch(t){case x[s(616)]:i=s(972);break;case x[s(669)]:i="Starting";break;case x[s(573)]:i=s(549);break;case x[s(789)]:i="Computing for finishing";break;default:i=""}this[s(597)][s(524)](i)}[h(567)](t){const s=h;u[s(826)]()[s(793)]("onStartDownCount",t)}[h(557)](t){const s=h;u[s(826)]()[s(793)](s(557),t)}[h(684)](){const t=h;let s=this[t(617)][t(797)]();this.visual.drawFaces(s)}[h(921)](t,s){const i=h;this.cc.setDim(s),this[i(706)].cc[i(580)](s),this[i(617)].options[i(689)]=t}[h(867)](){const t=h;this[t(817)][t(719)]&&(this[t(817)][t(719)]=!1,this[t(704)]())}[h(896)](){}[h(978)](t){const s=h;this[s(963)]&&(this.dom[s(888)][s(507)]("loading"),this.dom[s(888)].remove("blur"),t&&(this.dom[s(888)][s(582)](s(799)),this[s(963)][s(888)][s(582)](s(512))))}}class O{constructor(t={}){const s=h;this[s(699)]={host:null,headers:null,serverSide:null,modelUrl:null,mirrored:!0,single:!0},this[s(695)]=null,this[s(775)]=!1,this.loadedTID=null,this[s(699)]=n(this.options,t),this.originalSize={width:0,height:0},this.croppedSize={x:0,y:0,width:0,height:0},this.inputSize={width:300,height:300},this[s(699)].serverSide||this[s(530)]()}[h(903)](){const t=h;this.options[t(760)]=c[t(937)]()||c.isSafari()}[h(530)](){const t=h;this[t(864)]=y[t(496)](t(856)),this[t(864)].on("onScanResult",s=>{const i=t;if(typeof this[i(695)]===i(525)){let t=this.normalizing(s,!0);this[i(695)](t)}}),this.stream.on(t(842),s=>{const i=t;u[i(826)]()[i(793)](i(584)),this.loaded=s})}[h(565)](){const t=h;if(this[t(699)].serverSide){let s=(null!=this[t(699)][t(592)]?o[t(910)](this[t(699)][t(592)]):"")+"/"+t(911),i=n({"Content-Type":t(762)},this[t(699)][t(478)]||{});fetch(s,{method:t(844),headers:i}).then(s=>s[t(677)]())[t(608)](s=>{const i=t;this[i(775)]=s[i(801)],u[i(826)]()[i(793)]("Success:",s)})[t(967)](s=>{const i=t;this.loaded=!1,u.getInstance()[i(793)](i(601),s)})}else this[t(864)][t(866)]("loadCard")}[h(772)](t=null){const s=h;let i=(null!=this[s(699)][s(592)]?o[s(910)](this[s(699)][s(592)]):"")+"/"+s(704),e=n({"Content-Type":"application/json"},this[s(699)][s(478)]||{});fetch(i,{method:s(844),headers:e}).then(t=>t[s(677)]())[s(608)](i=>{const e=s;this[e(521)]=i.tid||null,u[e(826)]()[e(793)](e(769),i),typeof t===e(525)&&t(this.loaded,this[e(521)])}).catch(t=>{const i=s;this[i(521)]=null,u[i(826)]().log("Error:",t)})}[h(854)](t,s,i){const e=h;if(this.options[e(760)]){let h=S[e(933)](t,e(800),.95),a=new FormData;a[e(886)](e(527),h),a[e(886)](e(555),"0"),a[e(886)]("tid",s);let r=(null!=this[e(699)][e(592)]?o[e(910)](this[e(699)][e(592)]):"")+"/"+e(717),c=n({},this.options.headers||{});fetch(r,{method:e(786),body:a,headers:c})[e(608)](function(t){const s=e;if(t.ok)return t[s(677)]();console.error(s(601),t),typeof i===s(525)&&i(null)})[e(608)](t=>{const s=e;u[s(826)]()[s(793)](s(982),t);let h=[];if(!0===t.success&&void 0!==t.data&&(h=t[s(708)]),h.length,typeof i===s(525)){let t=this[s(890)](h);i(t)}})[e(967)](t=>{const s=e;console[s(509)]("Error:",t),typeof i===s(525)&&i(null)})}else{this.callback=i;let s=this[e(711)](t);this[e(864)][e(866)](e(944),s)}}[h(548)](){return this[h(775)]}[h(711)](t){const s=h;let i={x:0,y:0,w:t[s(781)],h:t[s(713)]};return t.width>t[s(713)]?(i.w=t[s(713)],i.x=(t.width-i.w)/2):(i.h=t[s(781)],i.y=(t[s(713)]-i.h)/2),this[s(970)]={x:t[s(781)],y:t.height},this[s(569)]=i,S[s(613)](t,i.x,i.y,i.w,i.h,this[s(913)][s(781)],this[s(913)][s(713)])}[h(783)](t,s){const i=h;let e=1;switch(s){case"x":return t*(e=this.croppedSize.w/this.inputSize[i(781)])+this[i(569)].x;case"y":return t*(e=this[i(569)].h/this[i(913)][i(713)])+this.croppedSize.y;case i(781):return t*(e=this.croppedSize.w/this[i(913)].width);case i(713):return t*(e=this.croppedSize.h/this.inputSize[i(713)])}}[h(890)](t,s=!1){const i=h;let e=[],n=null,o=!1;for(let h in t){n=t[h],s&&(n[i(665)][0]=this[i(783)](n[i(665)][0],"x"),n[i(665)][1]=this.toOriginalSize(n[i(665)][1],"y"),n.bbox[2]=this[i(783)](n[i(665)][2],i(781)),n[i(665)][3]=this.toOriginalSize(n[i(665)][3],i(713))),o=!1;for(let t in e)if(e[t][i(672)]===n[i(672)]){let s=e[t],h=n,a=0,r=0;h[i(665)][0]>s.bbox[0]&&h[i(665)][0]<s[i(665)][0]+s[i(665)][2]?r=(a=s[i(665)][0]+s.bbox[2]-h[i(665)][0])/h[i(665)][2]:s.bbox[0]>h[i(665)][0]&&s[i(665)][0]<h.bbox[0]+h.bbox[2]&&(r=(a=h[i(665)][0]+h.bbox[2]-s[i(665)][0])/s[i(665)][2]);let c=0,l=0;h[i(665)][1]>s.bbox[1]&&h[i(665)][1]<s[i(665)][1]+s[i(665)][3]?(c=s[i(665)][1]+s.bbox[3]-h[i(665)][1],l=a/h[i(665)][3]):s[i(665)][1]>h[i(665)][1]&&s[i(665)][1]<h[i(665)][1]+h[i(665)][3]&&(c=h[i(665)][1]+h[i(665)][3]-s.bbox[1],l=a/s[i(665)][3]),r>.6&&l>.6&&(o=!0,h[i(588)]>s.score&&(e[t]=n))}!o&&e.push(t[h])}if(this.options[i(908)]&&e.length>0){let t=0,s=0;for(let h in e)e[h].score>t&&(t=e[h][i(588)],s=h);return[e[s]]}return e}[h(852)](){this.loadedTID=null}}class A{constructor(t={}){const s=h;this[s(699)]={server:!0,url:null,host:null,checkURI:null},this[s(699)]=n(this[s(699)],t),null==this.options[s(730)]&&(this[s(699)][s(730)]=s(538)),this.loaded=!1,this.setup()}setup(){const t=h;this[t(699)][t(773)]}[h(565)](){const t=h;this[t(699)][t(773)]&&(this[t(775)]=!0)}recognize(t,s,i){const e=h;this[e(699)][e(773)]&&this[e(755)](t,s,i)}[h(755)](t,s,i){const e=h;let n=S.canvasToBase64(t,e(800),.9),a=new FormData;a[e(886)](e(527),n),a.append(e(784),s);let r=null!=this[e(699)][e(592)]?o[e(910)](this.options[e(592)]):"",c=null!=this.options[e(620)]?this.options[e(620)]:r+"/"+this[e(699)][e(730)];fetch(c,{method:"POST",body:a})[e(608)](t=>t[e(677)]()).then(t=>{const s=e;u[s(826)]()[s(793)](s(982),t);let h=A[s(847)](t[s(708)]);!1===t[s(801)]&&(h.type=null),typeof i===s(525)&&i(h)}).catch(t=>{const s=e;console[s(509)](s(601),t),"function"==typeof i&&i(null)})}recognizeLocal(t,s){}[h(694)](t){const s=h;let i={type:null,text:t,object:null};if(i[s(951)]>75){const e=t.substring(0,3);e[s(838)]("I<")||e[s(838)]("1<")?i[s(555)]="I":(e.includes("P<")||e[s(838)]("PC"))&&(i[s(555)]="P")}return i}static parseObject(t){const s=h;let i={type:null,text:t.Lines.join(""),object:t};if(i[s(585)][s(670)]>75){const e=t[s(654)];e.includes("I<")||e[s(838)]("1<")?i.type="I":(e[s(838)]("P<")||e.includes("PC"))&&(i.type="P")}return i}}const R={NO_CARD:h(787),MANY_CARDS:h(765),LOW_LIGHT:"lowlight",HIGH_LIGHT:"highlight",TOO_SMALL:h(927)},E={NONE:"none",ID:"id",PASSPORT:h(879)},M={NONE:h(721),ID_FRONT:"id_front",ID_BACK:h(966),PASS_FRONT:h(869)},N={NONE:h(721),SHOW:"show",ID_BACK:h(966),FINISH:h(609)},_={NONE:"none",SCANNING:h(535),FINISH:h(609)};class z{constructor(t,s={}){const i=h;this[i(671)]=t,this[i(699)]={host:null,headers:null,mrzOptions:null,detector:null,video:null,area:{x:0,y:0,width:0,height:0},detectTime:100,useServerSide:null,onCardDetected:null,onFaceDetected:null,onMRZDetected:null,onDetected:null,onError:null,onFinished:null,onCommand:null,onCommandResult:null,onStepChanged:null,mirrored:!0,delay:500,serverDelay:500,cardMinSize:{width:70,height:55}},this[i(699)]=n(this.options,s),this[i(864)]=null,this[i(504)]=!1,this[i(956)]=null,this[i(780)]=_[i(728)],this[i(743)]=null,this[i(777)]={},this.result={},this[i(640)]=null,this[i(688)]=null,this[i(859)]=null,this[i(502)]=null,this[i(904)]=null,this[i(794)]=this[i(699)][i(794)],this.tID=null,this[i(699)][i(705)]&&(this[i(794)]=this[i(699)][i(964)]),this[i(519)]=new O({mirrored:this[i(699)].mirrored,single:!0,serverSide:this[i(699)].useServerSide,host:this[i(699)][i(592)],headers:this.options[i(478)]}),this[i(898)]=new A({host:this.options.host,url:this.options[i(971)]&&this.options.mrzOptions[i(620)]||null}),this.cc=null,this[i(852)](),!this[i(699)][i(705)]&&this[i(530)]()}[h(486)](){const t=h;this[t(519)][t(565)](),this[t(898)][t(565)](),null!=this.stream&&S.getImageFromURL("/img/face.jpg").then(s=>{const i=t;this[i(864)][i(866)]("getTinyFace",s)})}[h(530)](){const t=h;this[t(864)]=y[t(496)](t(481)),this[t(864)].on("onTinyFaceResult",s=>{const i=t;u[i(826)]().log(i(598),s),this.step===_[i(962)]&&null!=this.curScan&&this.onFaceDetected(s)})}[h(701)](t,s){const i=h;this[i(519)][i(548)]()&&this[i(519)].detect(t,t=>{typeof s===i(525)&&s(t)})}observe(){const t=h;if(this[t(519)][t(548)]()&&null!=this[t(550)]){{let s=(new Date)[t(726)]();if(this[t(780)]===_[t(728)]&&s-this[t(502)]>1e3)this[t(780)]=_[t(962)],this[t(639)](N.SHOW);else{if(this[t(780)]===_[t(728)])return;if(this[t(780)]===N.FINISH)return void(null!=this[t(904)]&&s-this[t(904)]>2e3&&(this[t(609)](),this.finishTime=null))}}!this[t(504)]&&(this[t(743)]=null,this[t(777)]={card:!1,face:!1,mrz:!1},this[t(504)]=!0,this[t(688)]=this.canvas,this[t(640)]=S[t(802)](this[t(688)]),this.detector[t(854)](this[t(688)],this.tID,s=>{this[t(589)](s)}))}}[h(589)](t){const s=h;let i=null!=t&&t[s(670)]>0?t[0]:null,e=null;this[s(777)].card=!0;let n=null!=i&&this.checkSize(i[s(665)]);if(null!=i&&!n&&this[s(872)](R.TOO_SMALL),null!=i&&!0===n){u[s(826)]().log(s(920),t);let h={docType:this[s(678)](i[s(672)]),docFace:this[s(615)](i[s(672)]),card:i,face:null,mrz:null,image:null};this.curScan=h;let n=S.imageDataToCanvas(this.curFrame);if(e=S[s(493)](n,i[s(665)][0],i.bbox[1],i[s(665)][2],i[s(665)][3]),h[s(527)]=e.toDataURL(s(800),.9),this[s(859)]=e,0!==this[s(518)][s(934)][s(670)]||h[s(472)]!==M[s(510)]&&h[s(472)]!==M.PASS_FRONT)if(this[s(518)][s(934)][s(670)]>0&&this[s(518)][s(614)]===E.ID&&h.docFace===M[s(827)]){let t=.6*e[s(713)],h=S[s(493)](e,0,t,e.width,e[s(713)]-t);if(void 0===i[s(898)]||null==i[s(898)]){S[s(735)](h,10)>10?this[s(898)].recognize(h,this[s(550)],t=>{this.onMRZDetected(t)}):this.unlock(this[s(794)])}else this.onMRZDetected(i.mrz);this.scanned[s(848)]=!0}else this.unlock(this.delay);else if(void 0===i[s(848)]||null==i.face?this[s(864)][s(866)](s(529),e):this[s(483)]([i[s(848)]]),h.docFace===M.PASS_FRONT){let t=.7*e[s(713)],h=S[s(493)](e,0,t,e[s(781)],e.height-t);if(void 0===i.mrz||null==i[s(898)]){S[s(735)](h)>5?this[s(898)][s(759)](h,this.tID,t=>{this.onMRZDetected(t)}):this.unlock(this[s(794)])}else this[s(480)](i.mrz)}else this.scanned[s(898)]=!0;this.callCardDetectedEvent(t),this.checkScanResult()}else this[s(891)]([]),this[s(880)]([]),this[s(635)](this.delay)}checkSize(t){const s=h;let i=this.actualCanvas.width,e=this[s(688)][s(713)],n=this[s(699)][s(655)];return null!=t&&t[s(670)]>=4&&(t[2]/i*100>n[s(781)]||t[3]/e*100>n[s(713)])}[h(483)](t){const s=h;if(u.getInstance()[s(793)](s(483),t),this[s(777)][s(848)]=!0,null!=this.curScan){if(this[s(743)][s(848)]=null,t[s(670)]>0){let i=S[s(493)](this[s(859)],t[0].x,t[0].y,t[0][s(781)],t[0].height),e=S[s(735)](i,10);u[s(826)]().log(s(732),e),e>10&&(this.curScan[s(848)]=t)}typeof this[s(699)][s(483)]===s(525)&&this.options[s(483)](t),this[s(931)]()}}[h(480)](t){const s=h;u[s(826)]().log(s(480),t),this[s(777)].mrz=!0,null!=this[s(743)]&&(null!=t&&null!=t.object&&!0===t.object[s(979)]?this.curScan[s(898)]=t:null!=t&&!0===t[s(979)]?this[s(743)][s(898)]=A[s(847)](t):this[s(743)][s(898)]=null,typeof this.options[s(480)]===s(525)&&this[s(699)].onMRZDetected(t),this[s(931)]())}[h(931)](){const t=h;if(!this[t(536)]())return;let s=this[t(743)],i=!1;0!==this.result[t(934)][t(670)]||s.docFace!==M.ID_FRONT&&s[t(472)]!==M[t(747)]?1===this[t(518)][t(934)][t(670)]&&this[t(518)].docType===E.ID&&s[t(472)]===M[t(827)]&&null!=s.card&&null!=s[t(898)]&&null!=s.mrz[t(555)]&&(this[t(518)][t(934)].push(s),this.result.status=!0,this[t(880)](this[t(743)]),this[t(652)](_[t(789)]),this.finishTime=(new Date)[t(726)](),i=!0):s[t(472)]===M[t(510)]?null!=s[t(539)]&&null!=s.face&&1===s.face.length&&(this.result.scans[t(687)](s),this[t(518)].docType=E.ID,this.result.status=!1,this[t(880)](this.curScan),this[t(639)](N[t(827)]),i=!0,this[t(635)](this[t(794)])):null!=s[t(539)]&&null!=s.face&&null!=s[t(898)]&&null!=s[t(898)][t(555)]&&(this[t(518)][t(934)][t(687)](s),this[t(518)][t(614)]=E[t(935)],this.result[t(710)]=!0,this[t(880)](this[t(743)]),this[t(652)](_[t(789)]),this[t(904)]=(new Date)[t(726)](),i=!0),!i&&this[t(777)][t(539)]&&this[t(777)].face&&this.scanned[t(898)]&&this[t(635)](this.delay)}[h(536)](){const t=h;for(let s in this[t(777)])if(!0!==this[t(777)][s])return!1;return!0}[h(652)](t){const s=h;this.step!==t&&(this[s(780)]=t,"function"==typeof this[s(699)][s(811)]&&this[s(699)].onStepChanged(t))}[h(891)](t){const s=h;null!==t&&typeof this[s(699)].onCardDetected===s(525)&&this[s(699)][s(589)](t)}[h(880)](t){const s=h;typeof this.options.onDetected===s(525)&&this[s(699)][s(641)](t)}[h(872)](t){const s=h;typeof this[s(699)][s(557)]===s(525)&&this.options[s(557)](t)}[h(733)](){return this[h(780)]}[h(635)](t=null){const s=h;t=null==t?this[s(794)]:t,clearTimeout(this[s(956)]),this[s(956)]=setTimeout(()=>{this[s(504)]=!1},t)}[h(852)](){const t=h;this[t(780)]=N.NONE,this[t(518)]={status:!1,docType:E[t(728)],scans:[],tID:null},this.curScan=null,this[t(777)]={},this[t(504)]=!1,this[t(859)]=null,this[t(550)]=null,this[t(519)][t(852)]()}[h(704)](){const t=h;this[t(780)]=_.NONE,this[t(639)](N[t(728)]),this[t(502)]=(new Date)[t(726)](),this[t(519)][t(699)][t(760)]?this.detector[t(772)]((s,i)=>{const e=t;this.tID=i,this.result[e(550)]=this[e(550)]}):(this[t(550)]=String(this[t(502)]+Math[t(594)](1e5*Math[t(560)]())),this[t(518)][t(550)]=this[t(550)])}[h(609)](){const t=h;this[t(639)](N[t(789)]),typeof this[t(699)][t(914)]===t(525)&&this.options[t(914)](this.result)}[h(639)](t){const s=h;"function"==typeof this.options[s(912)]&&this[s(699)][s(912)](t)}[h(678)](t){const s=h;switch(t){case s(531):case"id_back":return E.ID;case s(581):case s(895):return E[s(935)];default:return E[s(728)]}}[h(615)](t){const s=h;switch(t){case s(531):return M[s(510)];case s(966):return M[s(827)];case s(581):case s(895):return M[s(747)];default:return M[s(728)]}}getStep(){return this[h(780)]}}class P{constructor(t,s={}){const i=h;this[i(671)]=t,this.options={srcDim:{k:1,dx:0,dy:0,dw:0,dh:0},mirrored:!0,areaColor:i(522),areaOpacity:.5,showArea:!0,showDetectors:!0},this.options=n(this[i(699)],s),this.cc=new p(this.options[i(932)])}[h(658)](t,s,i){}[h(877)](){}[h(723)](t){const s=h;if(!this[s(699)][s(941)])return;let i=t.width+20,e=t.height+20,n=(this.canvas.width-i*this.canvas[s(781)]/100)/2,o=(this[s(671)][s(713)]-e*this[s(671)].height/100)/2,a=this[s(671)].getContext("2d");a[s(561)](),a.beginPath(),a[s(806)]=3;let r=parseInt(this[s(699)][s(930)][s(570)](1,2),16),c=parseInt(this[s(699)][s(930)][s(570)](3,2),16),l=parseInt(this[s(699)][s(930)][s(570)](5,2),16);a[s(871)]=s(691)+r+", "+c+", "+l+", "+this[s(699)][s(668)]+")",a[s(724)](n,o,this[s(671)].width-2*n,this[s(671)].height-2*o),a[s(648)](),a[s(568)](),a.restore()}[h(725)](t,s=h(603),i=""){const e=h;if(!this[e(699)].showDetectors)return;let n=this[e(671)][e(841)]("2d"),o=null,a=null,r=null;for(let h in t)r=t[h],o=this[e(699)][e(840)]?this[e(671)][e(781)]-this.cc[e(850)](r.bbox[0])-this.cc[e(923)](r.bbox[2]):this.cc[e(850)](r.bbox[0]),a=this.cc[e(571)](r.bbox[1]),n[e(778)](),n.lineWidth="2",n[e(871)]=s,n.rect(o,a,this.cc.getSize(r[e(665)][2]),this.cc[e(923)](r[e(665)][3])),n[e(648)](),n[e(806)]="0",n[e(836)]=s,n[e(634)](o-1,a-20,150,20),n[e(823)]=e(485),n[e(836)]=e(599),n[e(702)]=e(887),n[e(805)](r[e(672)]+" "+Number(r.score)[e(751)](2),o+5,a-5),n.stroke(),n[e(823)]=e(959),n[e(836)]=s,n[e(702)]=e(808),n.fillText(i,o+this.cc[e(923)](r[e(665)][2])/2,a+this.cc[e(923)](r[e(665)][3])/2),n[e(568)]();n[e(909)]()}}class L{constructor(t={}){const s=h;this[s(481)]=null,this.stream=null,this[s(699)]={path:null},this[s(699)]=n(this[s(699)],t),this[s(629)]()}[h(629)](){const t=h;this.stream=y[t(496)](t(856)),this[t(864)].on(t(579),this[t(579)][t(576)](this)),this.stream.on(t(944),this[t(944)][t(576)](this)),window.Worker&&null!=this[t(699)][t(738)]?(this[t(481)]=new Worker(this.options[t(738)]),this[t(481)][t(686)]=this.onWorkerMessage.bind(this)):u[t(826)]().log(t(484))}[h(944)](t){const s=h;let i=null;t instanceof HTMLCanvasElement?i=S[s(802)](t):t instanceof HTMLImageElement&&(i=S[s(953)](t)),this[s(481)][s(628)]({type:s(745),action:s(944),data:i})}[h(579)](){const t=h;this[t(481)][t(628)]({type:t(745),action:"loadCard"})}[h(851)](t){const s=h;let i=t.data.type,e=(t.data[s(637)],t[s(708)][s(708)]);switch(i){case s(745):this[s(864)][s(866)](s(876),e);break;case s(664):this[s(864)][s(866)](s(842),e)}}}function W(t,s){return e[t-=471]}class H{constructor(t,s={}){const i=h;this[i(963)]=null,this.canvas=null,this[i(693)]=null,this.state={start:!1,detectInit:!1,analyzeAfterOpen:!1},this[i(481)]=null,this[i(699)]={url:null,headers:null,src:null,sourceType:null,width:1920,height:1080,onInit:null,onFrameCaptured:null,onCardDetected:null,onDetected:null,onCommand:null,sessionTime:6e4,detectTime:100,onFinished:null,mirrored:!0,scan_worker_path:"js/deepscanworker.min.js",face_worker_path:i(546),testURL:null,mrzOptions:null,useServerSide:null,serverRequestDelay:500,detector:{},camera:{fillOnMobile:!0,fill:!0,cutEdge:!0},visual:{areaColor:i(522),showArea:!0,showDetectors:!0},text:{processing:i(947)}},this[i(860)]=null,this[i(706)]=null,this[i(916)]=null,this[i(593)]=null,this.lastDetected=null,this.lastDetectedTime=null,this[i(505)]=null,this.lastScannedTime=null,this.lastCommand=N[i(728)],this.lastResult=null,this[i(753)]=0,this[i(699)]=n(this[i(699)],s),(null==this[i(699)][i(705)]&&c[i(937)]()||c.isSafari())&&(this[i(699)][i(705)]=!0),this.initContainer(t),this.setup()}[h(488)](t){const s=h;this[s(693)]=new m(t,{src:this.options.src,width:this.options[s(781)],height:this[s(699)][s(713)],fill:this.options[s(693)].fill,fillOnMobile:this[s(699)].camera[s(922)],cutEdge:this[s(699)].camera[s(520)],onFrameUpdated:this[s(684)].bind(this),onLoaded:this[s(921)].bind(this),onStart:this[s(867)][s(576)](this),onStop:this[s(896)].bind(this)}),this.dom=this[s(693)].dom,this[s(671)]=this.camera[s(671)]}[h(629)](){const t=h;if(this.cc=new p(this[t(693)][t(791)]),this.visual=new P(this[t(671)],{srcDim:this[t(693)][t(791)],mirrored:this.options[t(840)],areaColor:this[t(699)][t(706)][t(930)],showArea:this[t(699)][t(706)][t(941)],showDetectors:this[t(699)][t(706)][t(960)]}),this[t(860)]=new z(this[t(693)][t(666)],{host:this[t(699)][t(620)],headers:this.options[t(478)],mrzOptions:this[t(699)][t(971)],detector:this[t(699)][t(519)],useServerSide:this[t(699)][t(705)],onCommand:this[t(912)][t(576)](this),onCardDetected:this[t(589)][t(576)](this),onDetected:this.onDetected.bind(this),onFinished:this[t(914)].bind(this),onError:this[t(557)][t(576)](this),mirrored:this[t(699)][t(840)],serverDelay:this.options.serverRequestDelay}),!this[t(699)].useServerSide){let s="?rand="+(new Date)[t(726)]();this[t(916)]=new C({path:this[t(699)][t(657)]+s}),this[t(593)]=new L({path:this[t(699)].scan_worker_path+s})}this.analizer.cc=this.cc,typeof this[t(699)].onInit==t(525)&&this[t(699)][t(558)]()}open(){const t=h;!this.camera[t(824)]()&&(this.camera[t(704)](),this[t(860)][t(486)]())}[h(870)](){this.stop(),this.camera.stop()}[h(704)](){const t=h;this[t(839)]=null,this[t(643)]=N[t(728)],this[t(693)].isPlaying()?(this.state[t(704)]=!0,this[t(860)][t(704)]()):(this[t(496)](),this[t(817)][t(719)]=!0),this[t(902)](),this[t(753)]=(new Date)[t(726)]()}[h(874)](){const t=h;this.state[t(704)]=!1,this[t(817)][t(719)]=!1,this.analizer[t(852)](),this.clear()}testSource(t,s){const i=h;S[i(492)](t)[i(608)](t=>{const e=i;let h=S[e(953)](t);this[e(860)][e(701)](h,s)})}[h(902)](){const t=h;this[t(566)]=[],this[t(505)]=null,this[t(479)]=null,this[t(885)]=null,this[t(753)]=0}[h(914)](t){const s=h;this[s(566)]=[],this[s(505)]=null,this.visual[s(725)]([]),this[s(874)](),"function"==typeof this[s(699)][s(914)]&&this[s(699)][s(914)](t)}onCardDetected(t){const s=h;this[s(566)]=t,this[s(885)]=(new Date)[s(726)](),"function"==typeof this[s(699)][s(589)]&&this[s(699)][s(589)](t)}[h(641)](t){const s=h;this.lastScanned=t,this.lastScannedTime=(new Date)[s(726)](),u.getInstance()[s(793)](s(894),t),typeof this[s(699)][s(641)]===s(525)&&this.options[s(641)](this[s(505)])}[h(912)](t){const s=h;this[s(643)]=t,this[s(817)][s(704)]&&"function"==typeof this[s(699)].onCommand&&this[s(699)].onCommand(t)}[h(564)](){}[h(557)](t){const s=h;switch(t){case R.TOO_SMALL:u.getInstance()[s(793)]("Card is too small")}}[h(684)](){const t=h;if(this[t(817)][t(704)]){let s=this[t(505)]&&this[t(505)][t(539)]?[this[t(505)][t(539)]]:[];if(0===s[t(670)]&&null!=this[t(566)]&&this.lastDetected[t(670)]>0){s=this[t(566)];let i="";this.lastCommand===N[t(827)]&&"id_back"===this.lastDetected[0][t(672)]?(i=this[t(699)][t(585)][t(642)],this[t(706)][t(725)](s,"orange",i)):this.lastCommand===N.SHOW&&("pass_main"===this[t(566)][0].class||this[t(566)][0][t(672)]===t(895))&&(i=this[t(699)][t(585)][t(642)],this.visual[t(725)](s,t(748),i))}else{let i=this.getPassTime(this[t(479)]);null!=i&&i<2e3&&this[t(706)].drawCard(s)}this.analizer[t(950)]()===_[t(962)]&&this.visual.drawArea(this[t(860)][t(699)][t(655)]),(new Date)[t(726)]()-this[t(753)]>this[t(699)].sessionTime?this[t(914)]({status:!1,msg:t(591)}):this[t(860)][t(499)]()}}[h(921)](t,s){const i=h;this.cc[i(580)](s)}[h(867)](){const t=h;this[t(817)][t(719)]&&(this[t(817)][t(719)]=!1,this[t(704)]())}[h(896)](){}[h(945)](t){const s=h;return null==t?null:(new Date)[s(726)]()-t}}h(848);const j=class{constructor(t={}){const s=h;this[s(699)]={url:null,headers:null,debug:!1},this[s(699)]=n(this.options,t),this[s(708)]=new a(t.url||null,this[s(699)]),new u({debug:this[s(699)].debug})}createDeepFace(t,s){return new F(t,s)}createDeepScan(t,s){const i=h;let e=n({url:this.options[i(620)],headers:this.options.headers},s);return new H(t,e)}[h(494)](t,s){}[h(489)](t,s){const i=h;this[i(708)][i(685)](t,t=>{typeof s===i(525)&&s(t)})}[h(937)](){return c.isMobile()}}}},s={};function i(e){if(s[e])return s[e].exports;var h=s[e]={exports:{}};return t[e](h,h.exports,i),h.exports}return i.d=((t,s)=>{for(var e in s)i.o(s,e)&&!i.o(t,e)&&Object.defineProperty(t,e,{enumerable:!0,get:s[e]})}),i.o=((t,s)=>Object.prototype.hasOwnProperty.call(t,s)),i(614)})().default});

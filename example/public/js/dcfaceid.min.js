!function(t,s){"object"==typeof exports&&"object"==typeof module?module.exports=s():"function"==typeof define&&define.amd?define([],s):"object"==typeof exports?exports.DCFaceID=s():t.DCFaceID=s()}(this,function(){return(()=>{"use strict";var t={614:(t,s,i)=>{i.d(s,{default:()=>j});const e=["toRealCoordX","callDetectedEvent","ID_BACK","fillOnMobile","pass_front","clearSnapshots","Error:","getTime","defineCurrentAction","fit2Size","yaw","startSession","json","isWebGLExist","srcDim","dim","block","toLowerCase","SHOW","FORWARD","area","scale","collect","cropAndResizeCanvas","nocard","then","getUserMedia","manyFace","isOffscreenCanvasSupport","data","videoinput","append","srcObject","id_front","result","bottom","bind","draw mask layer","forEach","serverDelay","currentStepActive","raf","rear camera used","errors","streamSize","tagName","onTinyFaceResult","pitch","isRearCameraUsed","onFaceResult","strokeStyle","setText","sizeKoef","rect","facingMode","unlock","some","atan2","loadedTID","time","type","Your browser doesn't support web workers.","globalAlpha","__canvas","load","detectionLocked","pass_main","observe","class","web camera exception!","highlight","callStepChange","commandText","play","areaColor","push","setDim","url","save","hide","serverSide","onScanResult","results","START","drawMask","center","mediaDevices","cropCanvas","step","currentAction","notify","RIGHT","postMessage","arc","isSafari","initWorker","createElement","callCommandChange","white","ctx","passport","landMarks","substr","getImageData","Starting","getSize","paused","orange","error","/verify","delay","serverRequestDelay","userAgent","frontCamera","onStartDownCount","scan_worker_path","closePath","checkScanResult","actions","forward","24SEeXbA","lowlight","scan","drawCard","init","errorWaitTime","visual","net","classList","onDetected","30px","webgl","TOO_SMALL","Worker","applyConstraints","none","resWidth","actionWaitBeforeCheck","getLastDetected","opacity","fillText","Error loading ","look forward","success","other","lastDetected","detect","finishWaitTime","absolute","Card model loaded","innerHTML","landmark","showTextArea","join","PASS_FRONT","getImageB64","ellipse","autoplay","lastDetectedTime","getPose","currentPosition","cutLastSlash","parseObject","reset","isMobile","faceMask","defineContainer","drawImage","Computing for finishing","hideTextArea","startTime","environment","function","scanner","analizer","callback","remove","PASSPORT","add","DOWN","status","scanLoaded","errorTime","left","look left","worker","drawFaces","round","callError","getPassTime","restore","session timeout","GET","changeStep","Success:","putImageData","areaOpacity","getCoordY","getElementById","enumerateDevices","host","reject","face_worker_path","toDataURL","getContext","pass_full","current","df-container","noFace","?rand=","stroke","Please follow the commands","actualCanvas","data processing, please wait...","getCoordX","options","dom","close","offsetHeight","display","blur","lastScanned","inputSize","lineWidth","__canvas_original","getTinyFace","setCommand","headpos","getTracks","textContent","open","includes","slice","path","rgb(66,109,139)","showTitle","SUCCESS","getLandmark","mrzcheck","stop","imageToCanvas","finish","getCard","scan-worker","docType","loading","onCommandResult","onInit","1afnswy","scanWebWorker","blinking","js/deepfaceworker.js","recognize","actionWaitTime","scans","shuffle","lastScannedTime","interval","auto","onFaceDetected","tid","assign","onCameraStop","mrz","onCommand","box","Card is too small","beginPath","onload","859991fwosPZ","verify","getLaplacianVariance","onStep","smile","14px Arial","face","2344708IpqRfR","height","checkURI","INIT","docFace","drawPath","getImageFromURL","getFace","curFrame","DIV","headers","POST","devices","drawArea","length","chooselist","defineScanFace","0.5","callCommandResult","defineScanType","debug","faceWebWorker","canvasToImageData","textAlign","sessionTimeCount","list","useServerSide","match","onError","onScanLoaded","fillStyle","maskSize","NONE","media devices","showDetectors","Initializing","object","faceDetected","defineCommands","server","sessionTime","clear","onStepChanged","toOriginalSize","safari","timeID","loadCard","checkSize","fireCommand","camera","lock","detectTime","video","defineStream","loaded","ID_FRONT","image/jpeg","pos","lastResult","look right","ACTIONS","toVerify","videoWidth","canvas2IMG","initContainer","application/json","defineProcess","onStop","finishTime","isErrorExist","toRealCoordY","596629cdkuKn","msg","getStep","20px Arial","worker_path","fixedTime","request","setAttribute","undefined","outofbounds","isReady","insertBefore","image/png","processing","cutEdge","onCameraLoaded","dpr","notifyAll","text","LEFT","calculate","getCurrentStep","checkPosAndActions","onCameraStart","4423GdDGOZ","110199pLPIQn","Valid","next","getInstance","/img/face.jpg","actionText","toosmall","maskInited","tID","getCoord","mirrored","onMRZDetected","appendChild","globalCompositeOperation","onloadeddata","getSettings","clearRect","setFace","commands","valid","fill","observers","onLoaded","analyzeAfterOpen","id_back","getVideoTracks","REJECT","image","createDeepStory","onFrameUpdated","streams","source-over","testSource","showArea","score","detector","crossOrigin","single","Type","getArea","toFixed","gray","green","scanned","onFinished","25729zrzjjE","tinyFaceDetected","drawStreamToCanvas","manycards","anonymous","look down","SCANNING","currentActionList","croppedSize","show","analyser","testDetect","resizeCanvas","commandArea","checkCurrentCommandAction","recognizeGlobal","bbox","isPlaying","showCollection","backgroundColor","act2Command","videoHeight","onerror","right","#FFFFFF","playsinline","position","count","lastCommand","state","lineTo","normalizing","addActionTime","snapshotlist","quadraticCurveTo","FINISH","blankCanvas","mrzOptions","onStreamLoaded","style","detectTimer","stream","indexOf","125RLmVvs","436153WjoWfC","end","createTextArea","string","detectedFaceCountDownBeforeStart","canvasToBase64","roll","noface","cardImage","video-layer","canvas2grayscale","substring","onStart","CANVAS","name","action","webWorker","setup","cardMinSize","setOptions","originalSize","log","Finished","onCardDetected","down","div","card","onWorkerMessage","start","isAllScanned","max","canvas","videoSize","catch","rgba(","Received:","sourceDim","moveTo","outOfBounds","width","commander","getTimeDiff","src","draw","curScan","callCardDetectedEvent","index","imageDataToCanvas","maskLayer"],h=p;!function(t,s){const i=p;for(;;)try{if(626755===-parseInt(i(612))-parseInt(i(498))+-parseInt(i(909))*-parseInt(i(523))+-parseInt(i(781))*-parseInt(i(568))+parseInt(i(611))*-parseInt(i(522))-parseInt(i(930))+parseInt(i(937)))break;t.push(t.shift())}catch(s){t.push(t.shift())}}(e);const n=(t,s)=>{const i=p;for(let e of Object.keys(s))s[e]instanceof Object&&Object[i(922)](s[e],n(t[e]||{},s[e]));return Object[i(922)](t||{},s),t};class o{static[h(822)](t){const s=h;return"/"===t[s(763)](t.length-1)?t[s(893)](0,-1):t}}class a{constructor(t="",s={}){const i=h;this[i(738)]=t,this[i(876)]={headers:{}},this[i(876)]=n(this.options,s)}[h(998)](t,s){const i=h;if(null!=t&&null!=t[i(834)]&&null==t[i(936)]){let e={docType:t[i(834)][i(905)]||null,scans:[],tid:t.scanner[i(531)]};for(let s in t[i(834)][i(915)])e[i(915)][i(736)]({docFace:t[i(834)][i(915)][s][i(941)]||null,image:t[i(834)][i(915)][s][i(550)]});let h=n({"Content-Type":i(492)},this.options[i(947)]||{});fetch(o[i(822)](this[i(738)])+i(770),{method:i(948),headers:h,body:JSON.stringify(e)})[i(686)](t=>t[i(673)]())[i(686)](t=>{const e=i;if(typeof s===e(833)){let i={success:t.success,data:t[e(690)]||null,msg:t[e(499)]||null};s(i)}})[i(645)](t=>{const e=i;console[e(769)](e(667),t),"function"==typeof s&&s({success:!1,error:t})})}}}class r{constructor(t){this[h(643)]=t}[h(683)](){}[h(586)](){}[h(692)](){}[h(504)](){}}class c{static[h(825)](){const t=h;return[/Android/i,/webOS/i,/iPhone/i,/iPad/i,/iPod/i,/BlackBerry/i,/Windows Phone/i][t(717)](s=>{const i=t;return navigator[i(773)][i(964)](s)})}static[h(674)](){const t=h;try{document[t(757)](t(643))[t(865)](t(792))}catch(t){return!1}return!0}static[h(689)](){return typeof OffscreenCanvas===h(833)}static isSafari(){const t=h;let s=navigator[t(773)][t(678)]();return-1!==s.indexOf(t(981))&&-1===s[t(610)]("chrome")}}let l=null;class d{constructor(t={}){const s=h;if(l)return l;l=this,this[s(876)]={debug:!1},this[s(631)](t)}static[h(526)](t=null){if(l)return null!=t&&l[h(631)](t),l;l=new d(t||{})}[h(631)](t={}){const s=h;this[s(876)]=n(this[s(876)],t)}log(){const t=h;this[t(876)][t(957)]&&console[t(633)].apply(null,arguments)}}const u=d;const m=class{constructor(t,s={}){const i=h;this[i(877)]=null,this[i(643)]=null,this[i(724)]=null,this.__canvas_original=null,this[i(989)]=null,this[i(609)]=null,this[i(787)]=null,this[i(702)]=null,this.streamSize={width:0,height:0},this[i(648)]={k:1,dx:0,dy:0,dw:0,dh:0},this[i(601)]=[],this[i(949)]=[],this.frontCamera=!0,this[i(514)]=1,this[i(876)]={src:null,sourceType:null,width:640,height:480,resWidth:1280,resHeight:720,fill:!1,fillOnMobile:!0,cutEdge:!1,onLoaded:null,onError:null,onStop:null,onStart:null,onFrameUpdated:null},this[i(876)]=n(this[i(876)],s),this[i(827)](t),this[i(629)]()}[h(827)](t){const s=h;if(this[s(514)]=window.devicePixelRatio||1,typeof t==s(615)){let i=document[s(859)](t);i&&i[s(706)]&&(i[s(706)]===s(946)?(this.dom=i,this[s(877)][s(811)]="",this[s(643)]=document[s(757)]("CANVAS"),this.canvas[s(651)]=this[s(876)][s(651)],this[s(643)][s(938)]=this[s(876)][s(938)],this[s(877)][s(535)](this[s(643)])):i[s(706)]===s(625)&&(this[s(643)]=i,this[s(877)]=document[s(757)](s(946)),this.canvas.parentElement[s(509)](this[s(877)],this[s(643)]),this[s(877)][s(535)](this[s(643)])),this[s(877)]&&(this.dom[s(789)][s(839)](s(868)),this[s(877)].style[s(651)]=this[s(876)][s(651)]+"px",this.dom[s(607)][s(938)]=this[s(876)][s(938)]+"px")),this[s(643)]&&(this[s(643)].classList[s(839)](s(621)),this[s(643)][s(607)][s(587)]=s(564))}this.__canvas=document.createElement(s(625)),this[s(724)].width=this[s(876)][s(651)],this[s(724)][s(938)]=this[s(876)][s(938)],this[s(885)]=document[s(757)](s(625)),this[s(885)][s(651)]=this[s(876)][s(651)],this[s(885)][s(938)]=this[s(876)][s(938)]}[h(629)](){this.visual=new r(this.canvas)}[h(640)](){const t=h;(null==this[t(989)]||!this[t(585)]())&&this[t(990)]()}[h(900)](){const t=h;this.stream&&this[t(609)][t(889)]().length>0&&(this[t(609)][t(889)]()[0][t(900)](),this[t(609)]=null)}[h(990)](){const t=h;c[t(825)]()&&!0===this.options[t(664)]&&(this[t(876)][t(543)]=!0),null==this.options[t(654)]?null==this.stream?navigator[t(747)]&&navigator.mediaDevices[t(687)]&&(null===this[t(989)]&&(this.video=document[t(757)]("video"),this[t(989)][t(505)](t(818),""),this[t(989)].setAttribute("muted",""),this[t(989)].setAttribute(t(593),""),this[t(989)].style.width=t(791),this[t(989)][t(607)][t(938)]=t(791),this[t(989)][t(607)][t(594)]=t(809),this.dom.appendChild(this[t(989)]),this[t(989)][t(607)][t(800)]=t(954)),this.raf=null,navigator.mediaDevices[t(860)]().then(s=>{const i=t;u[i(526)]()[i(633)](i(970),s),this[i(949)]=s}),navigator.mediaDevices.getUserMedia({audio:!1,video:{facingMode:t(832),width:{ideal:this.options[t(797)]},height:{ideal:this[t(876)].resHeight}}})[t(686)](i=>{const e=t;this.stream=i,this[e(989)][e(693)]=i,i[e(548)]()[0][e(795)]({focusMode:e(919),focusDistance:.33}),this[e(709)]()&&(u[e(526)]().log(e(703)),this[e(774)]=!1),s(),this.video.play()})[t(645)](s=>{const i=t;u.getInstance()[i(633)](i(730),s),this[i(965)](s)})):this[t(989)][t(734)]():(this.video.src=this[t(876)][t(654)],this[t(989)].play());let s=()=>{const s=t;this[s(989)][s(537)]=(()=>{this[s(606)]()}),this[s(989)].onplaying=(()=>{const t=s;this[t(724)][t(651)]=this.video.videoWidth,this[t(724)][t(938)]=this[t(989)].videoHeight,this.__canvas_original[t(651)]=this[t(989)][t(489)],this[t(885)][t(938)]=this[t(989)][t(589)];let i=this.video.videoWidth,e=this.video[t(589)],h=1;this[t(648)].dw=this[t(643)][t(651)],this.sourceDim.dh=this[t(643)][t(938)],this[t(876)][t(543)]?this[t(643)].height/e<this.canvas.width/i?(h=this[t(643)][t(651)]/i,this[t(648)].dh=Math[t(848)](h*e),this.sourceDim.dy=0,this[t(876)][t(512)]&&(this[t(885)].height=this[t(643)][t(938)]/h,this[t(724)][t(938)]=this[t(643)].height/h)):(h=this[t(643)][t(938)]/e,this.sourceDim.dw=Math[t(848)](h*i),this[t(648)].dx=0,this[t(876)].cutEdge&&(this.__canvas_original[t(651)]=this[t(643)].width/h,this[t(724)][t(651)]=this[t(643)][t(651)]/h)):this[t(643)][t(938)]/e<this[t(643)][t(651)]/i?(h=this[t(643)][t(938)]/e,this.sourceDim.dw=Math.round(h*i),this[t(648)].dx=(this[t(643)][t(651)]-this[t(648)].dw)/2):(h=this[t(643)][t(651)]/i,this[t(648)].dh=Math[t(848)](h*e),this[t(648)].dy=(this[t(643)][t(938)]-this[t(648)].dh)/2),this[t(648)].k=h,null!=this[t(702)]&&cancelAnimationFrame(this[t(702)]),this.raf=requestAnimationFrame(this[t(570)][t(697)](this)),this[t(705)]={width:this[t(989)][t(489)],height:this[t(989)].videoHeight},this.onStart()}),this[s(989)].onpause=(()=>{const t=s;cancelAnimationFrame(this[t(702)]),this[t(494)]()})}}async drawStreamToCanvas(){const t=h;let s=this[t(774)]?-1:1,i=this[t(648)],e=this[t(989)].videoWidth,n=this[t(989)].videoHeight,o=this[t(885)][t(865)]("2d");o[t(739)](),o[t(682)](1,1),this[t(876)][t(543)]&&this[t(876)][t(512)]?o[t(828)](this[t(989)],(this[t(885)][t(651)]-e)/2,(this[t(885)].height-n)/2,e,n):o[t(828)](this[t(989)],0,0,this.__canvas_original[t(651)],this[t(885)][t(938)]),o[t(851)]();let a=this[t(724)].getContext("2d");a[t(739)](),a[t(682)](s,1),this[t(876)][t(543)]&&this[t(876)][t(512)]?a[t(828)](this.video,s*(this[t(724)][t(651)]-e)/2+(-1===s?s*e:0),(this.__canvas[t(938)]-n)/2,e,n):a[t(828)](this[t(989)],-1===s?s*e:0,0,this[t(724)].width,this[t(724)][t(938)]),a[t(851)]();let r=this.canvas[t(865)]("2d"),c=(this.canvas[t(651)]-this[t(648)].dw)/2,l=(this[t(643)][t(938)]-this[t(648)].dh)/2;r.clearRect(0,0,this[t(643)][t(651)],this[t(643)][t(938)]),r[t(739)](),r[t(682)](1*s,1),r.drawImage(this[t(989)],s*c+(-1===s?s*i.dw:0),l,i.dw,i.dh),r.restore(),null!=this.stream&&(this[t(552)](),this[t(702)]=requestAnimationFrame(this.drawStreamToCanvas[t(697)](this)))}[h(709)](){const t=h;let s=[];for(let i in this[t(949)])this[t(949)][i].kind===t(691)&&s[t(736)](this[t(949)][i]);let i=this[t(609)]&&this[t(609)].getVideoTracks()[0][t(538)]()[t(715)]||null;return u[t(526)]()[t(633)](t(949),this[t(949)]),u[t(526)]()[t(633)](t(715),i),i===t(832)}[h(585)](){const t=h;return this[t(609)]&&this[t(989)]&&!this[t(989)][t(767)]}[h(764)](){const t=h;return this.__canvas[t(865)]("2d").getImageData(0,0,this[t(724)].width,this[t(724)].height)}[h(816)](){return this.__canvas.toDataURL()}getSnapshots(){return this[h(601)]}snapshot(){const t=h;this.snapshotlist[t(736)](this[t(816)]())}[h(666)](){this[h(601)]=[]}[h(965)](t){const s=h;"function"==typeof this[s(876)][s(965)]&&this.options.onError(t)}[h(606)](){const t=h;typeof this[t(876)][t(545)]===t(833)&&this[t(876)][t(545)](this[t(989)],this.sourceDim)}[h(494)](){const t=h;typeof this[t(876)][t(494)]===t(833)&&this[t(876)][t(494)]()}[h(624)](){const t=h;"function"==typeof this[t(876)][t(624)]&&this[t(876)][t(624)]()}onFrameUpdated(){const t=h;typeof this[t(876)][t(552)]===t(833)&&this[t(876)].onFrameUpdated()}};function p(t,s){return e[t-=489]}class f{constructor(t={k:1,dx:0,dy:0,dw:0,dh:0}){this[h(676)]=t}[h(737)](t){this[h(676)]=t}[h(532)](t,s){const i=h;return{x:t*this[i(676)].k+this[i(676)].dx,y:s*this[i(676)].k+this[i(676)].dy}}[h(875)](t){const s=h;return t*this.dim.k+this[s(676)].dx}[h(858)](t){const s=h;return t*this[s(676)].k+this[s(676)].dy}getSize(t){return t*this[h(676)].k}[h(661)](t){const s=h;return t/this[s(676)].k-this[s(676)].dx}[h(497)](t){const s=h;return t/this.dim.k-this[s(676)].dy}}class g{constructor(t,s={width:0,height:0},i={width:0,height:0}){const e=h;this[e(877)]=t,this.canvas=null,this[e(760)]=null,this[e(733)]=null,this[e(528)]=null,this[e(644)]=s,this.maskSize=i,this.maskInited=!1,this.sizeKoef={h:.4,v:.6},(0===this[e(968)][e(651)]||0===this[e(968)][e(938)])&&(this.maskSize={width:this[e(644)].width*this[e(713)].h,height:this[e(644)].width*this.sizeKoef.v}),this[e(629)]()}setup(){const t=h;null!=this[t(877)]&&(this.canvas=document[t(757)]("CANVAS"),this[t(643)].id=t(660),this.canvas[t(651)]=this[t(644)].width,this.canvas.height=this[t(644)][t(938)],this[t(877)][t(535)](this[t(643)]),this[t(760)]=this.canvas[t(865)]("2d"))}createTextArea(){const t=h;if(this.commandText)this[t(733)].style[t(880)]=t(677);else{this.commandText=document.createElement(t(637)),this[t(733)].id=t(581);let s=document.createElement("P");s[t(890)]="",this[t(733)][t(535)](s),this[t(877)].appendChild(this[t(733)]);let i=((this[t(643)][t(938)]-this.maskSize[t(938)])/2-this[t(733)].offsetHeight)/2;this[t(733)].style.top=i+"px"}if(this[t(528)])this[t(528)][t(607)][t(880)]=t(677);else{this[t(528)]=document.createElement(t(637)),this.actionText.id="actionArea";let s=document[t(757)]("P");s[t(890)]="",this.actionText[t(535)](s),this[t(877)][t(535)](this[t(528)]);let i=((this.canvas.height-this[t(968)][t(938)])/2-this[t(733)][t(879)])/2;this[t(528)][t(607)][t(696)]=i+"px"}}showTextArea(){const t=h;this[t(733)]&&(this.commandText.style[t(880)]=""),this.actionText&&(this.actionText[t(607)][t(880)]="")}[h(830)](){const t=h;this[t(733)]&&(this.commandText[t(607)][t(880)]=t(796)),this[t(528)]&&(this[t(528)].style.display=t(796))}[h(712)](t){this.actionText&&(this.actionText.innerHtml=t)}[h(887)](t){const s=h;this[s(733)]&&(this[s(733)].innerHtml=t)}[h(562)](){const t=h;return{x:this[t(643)][t(651)]/2-this.maskSize[t(651)]/2-20,y:this[t(643)][t(938)]/2-this[t(968)].width/2-20,width:this[t(968)][t(651)],height:this[t(968)][t(938)]}}[h(655)](){const t=h;if(!this[t(530)]){console.log(t(698)),this[t(760)][t(739)](),this[t(760)][t(928)](),this[t(760)][t(817)](this.canvas.width/2,this[t(643)].height/2,this[t(968)][t(651)]/2,this.maskSize[t(938)]/2,Math.PI,0,2*Math.PI),this.ctx.fillStyle=t(895),this[t(760)].fill(),this.ctx.globalCompositeOperation="xor",this.ctx.beginPath(),this[t(760)].rect(0,0,this.canvas[t(651)],this.canvas[t(938)]),this[t(760)][t(967)]="rgba(0, 0, 0, 1)",this[t(760)].closePath(),this[t(760)][t(543)](),this[t(760)][t(723)]=.5;let s=this[t(643)][t(864)]();this.ctx[t(536)]=t(554);let i=new Image;i[t(929)]=(()=>{const s=t;this[s(760)][s(539)](0,0,this[s(643)][s(651)],this.canvas[s(938)]),this[s(760)].drawImage(i,0,0)}),i[t(654)]=s,this.maskInited=!0,this[t(614)]()}}[h(577)](){const t=h;this.maskInited?(this[t(813)](),this[t(643)][t(607)][t(880)]=t(677)):(this[t(655)](),this[t(643)][t(607)][t(880)]="block")}hide(){const t=h;this[t(830)](),this[t(643)][t(607)][t(880)]=t(796)}delete(){const t=h;this[t(760)].clearRect(0,0,this[t(643)][t(651)],this[t(643)].height),this[t(760)].restore()}}class w{constructor(t,s={}){const i=h;this.canvas=t,this[i(876)]={srcDim:{k:1,dx:0,dy:0,dw:0,dh:0}},this.options=n(this[i(876)],s),this.cc=new f(this[i(876)][i(675)])}drawPath(t,s,i){const e=h,n=new Path2D;n[e(649)](s[0][0],s[0][1]);for(let t=1;t<s.length;t++){const i=s[t];n.lineTo(i[0],i[1])}i&&n[e(777)](),t[e(871)](n)}drawFaces(t){const s=h;this[s(876)].srcDim.k;let i=null,e=this[s(643)][s(865)]("2d");e[s(739)]();for(let h=0;h<t[s(951)];h++){i=t[h][s(762)];for(let t=0;t<i[s(951)];t++){const h=i[t][0],n=i[t][1];e[s(928)](),e[s(754)](this.cc[s(875)](h),this.cc[s(858)](n),1,0,2*Math.PI),e.fill(),e.closePath()}}e[s(851)]()}}class S{constructor(t){this[h(626)]=t,this.observers={}}on(t,s){const i=h;void 0===this.observers[t]&&(this[i(544)][t]=[]),typeof s==i(833)&&this[i(544)][t][i(736)](s)}[h(837)](t,s){const i=h;for(const t in this[i(544)])this.observers[t]=this[i(544)][t].filter(t=>t!==s)}[h(751)](t,s){const i=h;this.observers[t]&&this[i(544)][t][i(699)](t=>{typeof t==i(833)&&t(s)})}[h(515)](t){const s=h;this[s(544)][s(699)](s=>{s.forEach(s=>{typeof s==p(833)&&s(t)})})}}const y=new class{constructor(){this.streams={}}[h(891)](t){const s=h;return!this.streams[t]&&(this[s(553)][t]=new S(t)),this[s(553)][t]}};class v{constructor(){}static[h(748)](t,s,i,e,n){const o=h;let a=document[o(757)](o(625));return a[o(651)]=e,a[o(938)]=n,a[o(865)]("2d").drawImage(t,s,i,e,n,0,0,e,n),a}static[h(580)](t,s={w:null,h:null}){const i=h;let e=document.createElement("CANVAS");return null==s.w&&null==s.h?(e.width=t.width,e.height=t[i(938)]):null==s.w?(e[i(938)]=s.h,e[i(651)]=s.h/t.height*t[i(651)]):null==s.h?(e.width=s.w,e[i(938)]=s.w/t.width*t[i(938)]):(e[i(651)]=s.w,e[i(938)]=s.h),e.getContext("2d").drawImage(t,0,0,e[i(651)],e[i(938)]),e}static cropAndResizeCanvas(t,s,i,e,n,o,a){const r=h;let c=document[r(757)](r(625));return c[r(651)]=o,c[r(938)]=a,c[r(865)]("2d")[r(828)](t,s,i,e,n,0,0,o,a),c}static[h(659)](t){const s=h;let i=document[s(757)](s(625));return i[s(651)]=t.width,i[s(938)]=t[s(938)],i[s(865)]("2d")[s(856)](t,0,0),i}static[h(901)](t){const s=h;let i=document[s(757)](s(625));return i[s(651)]=t.width,i[s(938)]=t[s(938)],i[s(865)]("2d").drawImage(t,0,0),i}static[h(959)](t){const s=h;return t[s(865)]("2d")[s(764)](0,0,t[s(651)],t[s(938)])}static[h(617)](t,s=h(510),i=.92){return t[h(864)](s,i)}static[h(490)](t,s=h(510),i=.92){return new Promise(function(e,h){const n=p;let o=new Image;o[n(505)](n(559),n(572)),o.onload=(()=>{e(o)}),o.onerror=(t=>{h(n(802)+t)}),o.src=v[n(617)](t,s,i)})}static[h(622)](t){const s=h;let i=t[s(865)]("2d")[s(764)](0,0,t.width,t[s(938)]),e=i.data;for(let i=t[s(651)]*t.height*4-1;i>0;i-=4){let t=.3*e[i-3]+.59*e[i-2]+.11*e[i-1];e[i-3]=t,e[i-2]=t,e[i-1]=t}let n=document[s(757)]("CANVAS");return n[s(865)]("2d")[s(856)](i,0,0),n}static[h(604)](t,s,i="black"){const e=h;let n=document[e(757)]("CANVAS");n[e(651)]=t,n[e(938)]=s;let o=n[e(865)]("2d");return o.fillStyle=i,o.fillRect(0,0,t,s),n}static[h(932)](t,s=30){const i=h;let e=t[i(865)]("2d")[i(764)](0,0,t[i(651)],t[i(938)])[i(690)],n=[[0,1,0],[1,-4,1],[0,1,0]],o=4*t[i(651)],a=0,r=Math.floor(1.5),c=0,l=0;for(let h=1;h<t[i(938)]-1;h++)for(let t=4;t<o-4;t+=4){c=0;for(let s=0;s<3;s++)for(let i=0;i<3;i++){c+=(.3*e[a=o*(h+s-r)+t+4*(i-r)]+.59*e[a+1]+.11*e[a+2])*n[s][i]}c>s&&(l+=1)}return l}static getImageFromURL(t){return new Promise(function(s,i){const e=p;let h=new Image;h[e(505)](e(559),"anonymous"),h[e(929)]=(()=>{s(h)}),h[e(590)]=(()=>{i("Error loading "+t)}),h[e(654)]=t})}}class C{constructor(t={}){const s=h;this[s(846)]=null,this[s(609)]=null,this[s(876)]={path:null},this[s(876)]=n(this[s(876)],t),this.setup()}setup(){const t=h;this[t(609)]=y[t(891)](t(846)),this[t(609)].on(t(944),this[t(944)][t(697)](this)),this[t(609)].on(t(886),this[t(886)][t(697)](this)),this[t(609)].on(t(983),this.loadCard[t(697)](this)),this.stream.on("getCard",this[t(903)][t(697)](this)),window[t(794)]&&null!=this[t(876)][t(894)]?(this[t(846)]=new Worker(this[t(876)].path),this[t(846)].onmessage=this[t(639)][t(697)](this)):console[t(633)](t(722))}[h(944)](t){const s=h;let i=null;if(t instanceof HTMLCanvasElement){i=t.getContext("2d")[s(764)](0,0,t[s(651)],t.height)}else if(t instanceof HTMLImageElement){let e=document[s(757)]("canvas"),h=e[s(865)]("2d");e[s(651)]=t.width,e[s(938)]=t[s(938)],h[s(828)](t,0,0),i=h[s(764)](0,0,t[s(651)],t.height)}this.worker[s(753)]({type:s(936),action:s(944),data:i})}[h(886)](t){const s=h;let i=null;if(t instanceof HTMLCanvasElement){i=t[s(865)]("2d")[s(764)](0,0,t[s(651)],t[s(938)])}else if(t instanceof HTMLImageElement){let e=document[s(757)]("canvas"),h=e[s(865)]("2d");e[s(651)]=t[s(651)],e[s(938)]=t[s(938)],h.drawImage(t,0,0),i=h[s(764)](0,0,t[s(651)],t[s(938)])}this[s(846)][s(753)]({type:s(936),action:s(886),data:i})}[h(903)](t){const s=h;let i=null;t instanceof HTMLCanvasElement?i=v[s(959)](t):t instanceof HTMLImageElement&&(i=v[s(901)](t)),this[s(846)][s(753)]({type:s(783),action:s(903),data:i})}[h(983)](){const t=h;this.worker[t(753)]({type:"scan",action:t(983)})}onWorkerMessage(t){const s=h;let i=t[s(690)][s(721)],e=t.data[s(627)],n=t[s(690)][s(690)];switch(i){case s(936):e===s(974)?this.stream[s(751)](s(710),n):e===s(569)&&this[s(609)][s(751)](s(707),n);break;case"scan":this[s(609)][s(751)](s(742),n);break;case s(842):this[s(609)][s(751)](s(966),n);break;case s(805):}}}const D=class{constructor(){const t=h;this[t(788)]=null,this[t(926)]={x:0,y:0,width:0,height:0},this[t(812)]=[],this[t(936)]=null,this.yaw=0,this.pitch=0,this[t(618)]=0}[h(540)](t){const s=h;this[s(936)]=t,this[s(926)]={x:t.x,y:t.y,height:t.height,width:t[s(651)]},this[s(812)]=t.landMarks,this[s(518)]()}[h(978)](){const t=h;this[t(788)]=null,this[t(926)]={x:0,y:0,width:0,height:0},this[t(812)]=[],this.face=null,this[t(671)]=0,this[t(708)]=0,this[t(618)]=0}[h(518)](){const t=h;let s=this[t(936)][t(762)][234],i=this[t(936)][t(762)][454],e=this[t(936)][t(762)][10],n=this[t(936)][t(762)][152];this[t(671)]=180*Math[t(718)](i[2]-s[2],i[0]-s[0])/Math.PI,this.pitch=180*Math[t(718)](n[0]-e[0],n[2]-e[2])/Math.PI,this[t(618)]=180*Math[t(718)](i[1]-s[1],i[0]-s[0])/Math.PI}[h(820)](){}getBox(){return this.box}[h(898)](){return this[h(812)]}},T={FORWARD:h(780),LEFT:h(844),RIGHT:h(591),UP:"up",DOWN:h(636),SMILE:h(934),BLINKING:h(911),NONE:h(796)};class b{constructor(){const t=h;this[t(541)]=[],this[t(595)]=2,this[t(952)]=[T[t(517)],T[t(752)],T.UP,T[t(840)],T.SMILE],this[t(658)]=0}shuffle(){const t=h;this[t(978)]();for(let s=0;s<this[t(595)];s++)this[t(541)][t(736)]({name:T[t(680)]});return this[t(541)]}[h(525)](){const t=h;return this.index<this[t(541)][t(951)]-1?(this[t(658)]++,this[t(541)][this[t(658)]]):null}[h(867)](){const t=h;return this[t(541)][this[t(658)]]}hasCommand(){const t=h;return this[t(658)]<this[t(541)].length-1}clear(){const t=h;this[t(658)]=0,this[t(541)]=[]}}h(619),h(782),h(731),h(507);const I={NONE:h(796),UP:"up",DOWN:h(636),FORWARD:h(780),LEFT:h(844),RIGHT:h(591)},x={NONE:h(796),INIT:"init",START:"start",ACTIONS:h(779),FINISH:h(902)},k={SUCCESS:h(804),NONE:"none",REJECT:h(862)};class F{constructor(t,s={}){const i=h;this[i(643)]=t,this[i(876)]={video:null,area:{x:0,y:0,width:0,height:0},detectTime:100,startingWaitTime:2e3,onFaceDetected:null,onError:null,onFinished:null,onCommand:null,onCommandResult:null,onStep:null,onStartDownCount:null},this[i(876)]=n(this[i(876)],s),this[i(608)]=null,this[i(704)]={lowLight:!1,highLight:!1,noFace:!1,manyFace:!1,outOfBounds:!1},this[i(821)]=I[i(969)],this[i(609)]=null,this.headpos=new D,this[i(652)]=new b,this[i(987)]=!1,this.lastDetected=[],this[i(749)]=x[i(969)],this.detectedFaceCountDownBeforeStart=3,this[i(503)]=0,this[i(843)]=0,this[i(786)]=2e3,this[i(914)]=6e3,this[i(798)]=1e3,this.finishWaitTime=2e3,this.currentStepActive=!1,this[i(921)]=null,this[i(743)]=[],this.currentCommand=T.NONE,this[i(750)]=I[i(969)],this[i(575)]=[],this.cc=null,this[i(756)]()}[h(756)](){const t=h;this[t(609)]=y[t(891)](t(846)),this[t(609)].on(t(710),s=>{const i=t;null!=this[i(608)]&&(this[i(920)](s),this[i(987)]=!1)})}[h(640)](){const t=h;this[t(987)]=!1,this[t(806)]=[],this.currentStepActive=!1,this[t(749)]=x[t(940)],this[t(743)]=[],this[t(616)]=3,this[t(921)]=(new Date)[t(668)](),this[t(975)](),this[t(732)](this[t(749)]),clearTimeout(this[t(608)]),this[t(608)]=setTimeout(this[t(728)][t(697)](this),this[t(876)].detectTime)}stop(){const t=h;this[t(921)]=null,clearTimeout(this[t(608)]),this[t(608)]=null,this.lock=!1,this[t(978)]()}[h(978)](){const t=h;this[t(806)]=[],this[t(749)]=x.NONE,this.detectedFaceCountDownBeforeStart=3,this[t(750)]=I[t(969)],this[t(575)]=[],this.currentStepActive=!1}defineCommands(){const t=h;let s=this.commander[t(916)]();for(let i in s)this.results[t(736)]({pos:I[t(969)],image:null,command:T[t(969)],status:!1});u[t(526)]().log(t(975),s)}observe(){const t=h;!this[t(987)]&&(this.stream[t(751)]("getFace",this[t(643)]),this[t(987)]=!0),this[t(608)]=setTimeout(this.observe.bind(this),this[t(876)][t(988)])}[h(920)](t){const s=h;if(this[s(704)][s(869)]=!1,this[s(704)][s(688)]=!1,this[s(821)]=I[s(969)],t.length>1)this[s(704)][s(688)]=!0;else if(0===t[s(951)])return this[s(704)][s(869)]=!0,typeof this[s(876)][s(920)]===s(833)&&this.options[s(920)]([]),void(this[s(987)]=!1);this[s(806)]=t,"function"==typeof this.options.onFaceDetected&&this[s(876)][s(920)](t),this[s(616)]>0?(this[s(616)]--,this[s(503)]=(new Date)[s(668)](),this[s(843)]=(new Date).getTime()):(this[s(888)][s(540)](t[0]),this[s(669)](),this[s(582)]()),this[s(987)]=!1}[h(902)](t,s){const i=h;if(null==this.tid)return!1;let e={tid:this[i(921)],status:s,results:this[i(743)],image:null};for(let t in this[i(743)])if(this[i(743)][t].command===T.FORWARD&&!0===this[i(743)][t][i(841)]){e[t][i(550)]=this.results[t][i(550)];break}typeof this[i(876)][i(567)]===i(833)&&this[i(876)].onFinished(e),this[i(900)]()}[h(669)](){const t=h;let s=this[t(888)].getBox(),i={x:this.cc[t(875)](s.x),y:this.cc.getCoordY(s.y),width:this.cc[t(766)](s[t(651)]),height:this.cc.getSize(s[t(938)])},e=.3*this.options[t(681)][t(651)],n=.3*this[t(876)].area[t(938)],o=i.x+i.width,a=i.y+i[t(938)];if(!(i.x>this.options.area.x-e&&i.y>this[t(876)].area.y-n&&o<this[t(876)][t(681)].x+this[t(876)][t(681)].width+e&&a<this[t(876)][t(681)].y+this[t(876)][t(681)][t(938)]+n))return this[t(704)][t(650)]=!0,!1;this[t(704)].outOfBounds=!1,this[t(888)][t(618)]<12&&this[t(888)][t(618)]>-12&&this[t(888)].pitch<=-20&&this[t(888)][t(708)]>=-130&&this[t(888)][t(671)]>=-10&&this.headpos.yaw<=10&&(this[t(750)]=I[t(680)]),this.headpos[t(618)]<12&&this[t(888)].roll>-12&&this[t(888)].yaw<-10&&(this[t(750)]=I[t(517)]),this[t(888)].roll<12&&this.headpos.roll>-12&&this[t(888)].yaw>10&&(this.currentAction=I[t(752)]),this.headpos.roll<12&&this[t(888)][t(618)]>-12&&this.headpos[t(708)]<-130&&(this[t(750)]=I.UP),this[t(888)][t(618)]<12&&this[t(888)][t(618)]>-12&&this.headpos[t(708)]>-20&&(this[t(750)]=I[t(840)])}checkCurrentCommandAction(){const t=h;let s=this.isErrorExist(),i=this.getTimeDiff(this.fixedTime);if(s?(this[t(821)]=I[t(969)],this[t(849)](this.errors)):this[t(843)]=(new Date).getTime(),this.step===x[t(940)]&&(this.currentStepActive=!1,this[t(749)]=x[t(744)],this.callStepChange(this.step)),this[t(749)]===x.START){let s=Math[t(848)]((this.options.startingWaitTime-i)/1e3);s>0?typeof this[t(876)][t(775)]===t(833)&&this[t(876)][t(775)](s):(this[t(749)]=x[t(997)],this[t(701)]=!1,this[t(503)]=(new Date)[t(668)](),this[t(977)]=(new Date)[t(668)](),this[t(732)](this[t(749)]))}if(this.step===x[t(997)]&&(!1===s||0===this[t(786)])){let s=this.commander[t(658)],e=this[t(652)][t(867)]();this.currentCommand!==e.name&&(this.currentCommand=e[t(626)],this[t(575)]=[],this[t(758)](e[t(626)])),i>0&&this.currentActionList[t(736)]({pos:this.currentAction,posPitch:this[t(888)][t(708)],posYaw:this[t(888)][t(671)],time:(new Date)[t(668)](),valid:!0,command:e});let h=this[t(914)]+this[t(798)]-i,n=i>this[t(798)]?this[t(520)](e[t(626)],this[t(750)]):k[t(969)];if(h>0&&n===k[t(969)]);else if(i>this.actionWaitBeforeCheck){let i=v[t(748)](this[t(643)],this[t(888)][t(926)].x,this[t(888)][t(926)].y,this.headpos[t(926)][t(651)],this.headpos[t(926)].height);n===k.SUCCESS?this[t(743)][s]={pos:this.currentAction,command:e,status:!0,image:i}:this[t(743)][s]={pos:this[t(750)],command:e,status:!1,image:i},this[t(955)](this.results[s]),this[t(652)].hasCommand()?this[t(652)].next():(this[t(749)]=x[t(603)],this.headpos[t(978)](),this.callStepChange(this[t(749)])),this[t(503)]=(new Date)[t(668)]()}}if(this.step===x[t(603)]){this[t(808)]-i>0||(this[t(749)]=x[t(603)],this[t(503)]=(new Date)[t(668)](),this[t(902)](!0,!0))}}[h(520)](t,s){const i=h;let e={},n=T[i(969)],o=T[i(969)],a={};for(let t in this[i(575)]){let s=this.currentActionList[t];null!=s&&s[i(542)]&&(null!=s[i(994)]&&(n=this[i(588)](s[i(994)])),null==e[n]&&(e[n]={list:[],max:0}),e[n]=this[i(600)](e[n],s,o!==n),a[n]=(a[n]||0)+1,o=n)}let r=a[i(951)];if(t===T[i(517)]||t===T.UP||t===T[i(752)]||t===T[i(840)]){if(r>3)return k[i(549)];if(null!=e[t]&&e[t].max>1e3)return k.SUCCESS}if(t===T[i(680)]){if(r>=3)return k[i(549)];if(null!=e[t]&&e[t].max>1e3)return k[i(897)]}return k[i(969)]}callStepChange(t){"function"==typeof this.options.onStep&&this.options.onStep(t)}[h(849)](t){const s=h;typeof this[s(876)].onError===s(833)&&this.options.onError(t)}[h(758)](t){const s=h;"function"==typeof this[s(876)][s(925)]&&this.options.onCommand(t)}[h(955)](t){const s=h;typeof this[s(876)][s(907)]===s(833)&&this[s(876)][s(907)](t)}[h(799)](){return this[h(806)]}[h(496)](){const t=h;for(const s in this[t(704)])if(!0===this[t(704)][s])return!0;return!1}[h(653)](t){const s=h;return(new Date)[s(668)]()-t}[h(588)](t){const s=h;switch(t){case I[s(517)]:return T[s(517)];case I.UP:return T.UP;case I.RIGHT:return T[s(752)];case I[s(840)]:return T.DOWN;case I[s(680)]:return T[s(680)];default:return T.NONE}}[h(600)](t,s,i){const e=h;let n=t,o=0;return n[e(962)][e(951)]>0&&null!=n.list[o][e(640)]&&i?(o=n[e(962)][e(951)]-1,null!=s.time&&(n[e(962)][o][e(613)]=s[e(720)],n[e(962)][o].interval=s[e(720)]-n[e(962)][o][e(640)],n[e(642)]=(n[e(962)][o].interval||0)>n.max?n[e(962)][o][e(918)]||0:n[e(642)])):n[e(962)][e(736)]({start:s[e(720)],end:null,interval:null}),n}}class A{constructor(t,s={}){const i=h;this[i(877)]=null,this[i(643)]=null,this[i(986)]=null,this[i(597)]={start:!1,detectInit:!1,analyzeAfterOpen:!1},this[i(876)]={src:null,sourceType:null,width:640,height:480,liveness:!0,onFrameCaptured:null,detectTime:100,onFinished:null,worker_path:i(912)},this[i(876)]=n(this.options,s),this[i(491)](t),this[i(629)]()}[h(491)](t){const s=h;this[s(986)]=new m(t,{src:this[s(876)][s(654)],width:this[s(876)][s(651)],height:this[s(876)][s(938)],onFrameUpdated:this[s(552)][s(697)](this),onLoaded:this[s(513)][s(697)](this),onStart:this[s(521)].bind(this),onStop:this.onCameraStop.bind(this)}),this[s(877)]=this[s(986)].dom,this.canvas=this.camera[s(643)]}[h(629)](){const t=h;this.cc=new f(this[t(986)][t(648)]),this[t(826)]=new g(this[t(877)],{width:this[t(876)].width,height:this[t(876)][t(938)]}),this.visual=new w(this.canvas),this[t(628)]=new C({path:this[t(876)][t(502)]}),this[t(578)]=new F(this[t(986)][t(724)],{area:this[t(826)][t(562)](),detectTime:this.options[t(988)],onFaceDetected:this[t(920)][t(697)](this),onError:this.onError[t(697)](this),onFinished:this.onFinished.bind(this),onCommand:this.onCommand[t(697)](this),onCommandResult:this.onCommandResult.bind(this),onStep:this[t(933)][t(697)](this),onStartDownCount:this[t(775)].bind(this)}),this[t(578)].cc=this.cc}[h(891)](){const t=h;!this[t(986)][t(585)]()&&(this[t(986)].start(),this[t(826)][t(577)]())}[h(878)](){const t=h;this[t(900)](),this.camera[t(900)](),this[t(826)][t(740)]()}[h(640)](){const t=h;this[t(986)].isPlaying()?(this[t(597)].start=!0,this[t(578)][t(640)]()):(this[t(891)](),this[t(597)][t(546)]=!0)}[h(900)](){const t=h;this[t(597)].start=!1,this[t(578)][t(900)](),this[t(597)].analyzeAfterOpen=!1}onFinished(t,s){const i=h;u.getInstance()[i(633)]("finished"),this[i(826)].setCommand(i(634)),typeof this[i(876)][i(567)]==i(833)&&this.options.onFinished(t,s)}[h(920)](t){}[h(925)](t){const s=h;u.getInstance()[s(633)](s(925),t);let i="";switch(t){case T[s(680)]:i=s(803);break;case T[s(517)]:i=s(845);break;case T[s(752)]:i=s(996);break;case T.UP:i="look up";break;case T[s(840)]:i=s(573);break;default:i=""}this[s(826)][s(887)](i)}onCommandResult(){}[h(933)](t){const s=h;u.getInstance()[s(633)](s(979),t);let i="";switch(t){case x.INIT:i=s(972);break;case x[s(744)]:i=s(765);break;case x.ACTIONS:i=s(872);break;case x[s(603)]:i=s(829);break;default:i=""}this[s(826)].setCommand(i)}[h(775)](t){const s=h;u[s(526)]().log(s(775),t)}onError(t){const s=h;u[s(526)]()[s(633)]("onError",t)}[h(552)](){const t=h;let s=this[t(578)][t(799)]();this.visual[t(847)](s)}onCameraLoaded(t,s){const i=h;this.cc[i(737)](s),this[i(787)].cc.setDim(s),this[i(578)][i(876)][i(989)]=t}[h(521)](){const t=h;this[t(597)][t(546)]&&(this[t(597)][t(546)]=!1,this[t(640)]())}[h(923)](){}showProcessing(t){const s=h;this[s(877)]&&(this[s(877)][s(789)][s(837)](s(906)),this[s(877)][s(789)][s(837)](s(881)),t&&(this[s(877)].classList[s(839)]("loading"),this[s(877)].classList[s(839)](s(881))))}}class O{constructor(t={}){const s=h;this[s(876)]={host:null,headers:null,serverSide:null,modelUrl:null,mirrored:!0,single:!0},this[s(836)]=null,this.loaded=!1,this.loadedTID=null,this[s(876)]=n(this[s(876)],t),this.originalSize={width:0,height:0},this.croppedSize={x:0,y:0,width:0,height:0},this[s(883)]={width:300,height:300},this.options.serverSide||this.initWorker()}[h(493)](){const t=h;this.options[t(741)]=c[t(825)]()||c[t(755)]()}initWorker(){const t=h;this[t(609)]=y[t(891)](t(904)),this[t(609)].on("onScanResult",s=>{const i=t;if(typeof this.callback===i(833)){let t=this[i(599)](s,!0);this[i(836)](t)}}),this[t(609)].on(t(966),s=>{const i=t;u[i(526)]()[i(633)](i(810)),this[i(991)]=s})}[h(725)](){const t=h;if(this[t(876)].serverSide){let s=(null!=this.options[t(861)]?o[t(822)](this.options[t(861)]):"")+"/card/ready",i=n({"Content-Type":"application/json"},this[t(876)][t(947)]||{});fetch(s,{method:t(853),headers:i})[t(686)](t=>t.json())[t(686)](s=>{const i=t;this.loaded=s[i(804)],u[i(526)]().log("Success:",s)}).catch(s=>{const i=t;this[i(991)]=!1,u[i(526)]().log(i(667),s)})}else this[t(609)].notify(t(983))}[h(672)](t=null){const s=h;let i=(null!=this.options[s(861)]?o[s(822)](this[s(876)][s(861)]):"")+"/"+s(640),e=n({"Content-Type":s(492)},this[s(876)][s(947)]||{});fetch(i,{method:s(853),headers:e})[s(686)](t=>t[s(673)]())[s(686)](i=>{const e=s;this[e(719)]=i[e(921)]||null,u[e(526)]()[e(633)](e(855),i),typeof t===e(833)&&t(this[e(991)],this[e(719)])})[s(645)](t=>{const i=s;this[i(719)]=null,u.getInstance()[i(633)](i(667),t)})}[h(807)](t,s,i){const e=h;if(this[e(876)][e(741)]){let h=v[e(617)](t,"image/jpeg",.95),a=new FormData;a[e(692)](e(550),h),a.append(e(721),"0"),a[e(692)](e(921),s);let r=(null!=this[e(876)][e(861)]?o.cutLastSlash(this[e(876)][e(861)]):"")+"/card/detect",c=n({},this[e(876)].headers||{});fetch(r,{method:e(948),body:a,headers:c})[e(686)](function(t){const s=e;if(t.ok)return t[s(673)]();console[s(769)]("Error:",t),"function"==typeof i&&i(null)}).then(t=>{const s=e;u[s(526)]()[s(633)](s(647),t);let h=[];if(!0===t[s(804)]&&void 0!==t[s(690)]&&(h=t[s(690)]),h[s(951)],"function"==typeof i){let t=this.normalizing(h);i(t)}})[e(645)](t=>{const s=e;console[s(769)](s(667),t),"function"==typeof i&&i(null)})}else{this[e(836)]=i;let s=this[e(670)](t);this.stream[e(751)]("getCard",s)}}isReady(){return this[h(991)]}fit2Size(t){const s=h;let i={x:0,y:0,w:t[s(651)],h:t[s(938)]};return t.width>t.height?(i.w=t[s(938)],i.x=(t[s(651)]-i.w)/2):(i.h=t[s(651)],i.y=(t.height-i.h)/2),this[s(632)]={x:t.width,y:t[s(938)]},this[s(576)]=i,v[s(684)](t,i.x,i.y,i.w,i.h,this.inputSize.width,this[s(883)][s(938)])}[h(980)](t,s){const i=h;let e=1;switch(s){case"x":return t*(e=this[i(576)].w/this[i(883)].width)+this[i(576)].x;case"y":return t*(e=this[i(576)].h/this[i(883)][i(938)])+this[i(576)].y;case i(651):return t*(e=this[i(576)].w/this.inputSize[i(651)]);case i(938):return t*(e=this[i(576)].h/this.inputSize[i(938)])}}[h(599)](t,s=!1){const i=h;let e=[],n=null,o=!1;for(let h in t){n=t[h],s&&(n.bbox[0]=this[i(980)](n[i(584)][0],"x"),n.bbox[1]=this.toOriginalSize(n[i(584)][1],"y"),n[i(584)][2]=this.toOriginalSize(n[i(584)][2],i(651)),n.bbox[3]=this[i(980)](n.bbox[3],"height")),o=!1;for(let t in e)if(e[t][i(729)]===n[i(729)]){let s=e[t],h=n,a=0,r=0;h[i(584)][0]>s[i(584)][0]&&h[i(584)][0]<s[i(584)][0]+s[i(584)][2]?r=(a=s.bbox[0]+s[i(584)][2]-h[i(584)][0])/h[i(584)][2]:s.bbox[0]>h.bbox[0]&&s[i(584)][0]<h.bbox[0]+h[i(584)][2]&&(r=(a=h.bbox[0]+h[i(584)][2]-s.bbox[0])/s[i(584)][2]);let c=0,l=0;h[i(584)][1]>s[i(584)][1]&&h[i(584)][1]<s[i(584)][1]+s[i(584)][3]?(c=s[i(584)][1]+s[i(584)][3]-h[i(584)][1],l=a/h[i(584)][3]):s[i(584)][1]>h[i(584)][1]&&s.bbox[1]<h[i(584)][1]+h.bbox[3]&&(c=h[i(584)][1]+h[i(584)][3]-s[i(584)][1],l=a/s[i(584)][3]),r>.6&&l>.6&&(o=!0,h[i(557)]>s[i(557)]&&(e[t]=n))}!o&&e.push(t[h])}if(this[i(876)][i(560)]&&e[i(951)]>0){let t=0,s=0;for(let h in e)e[h][i(557)]>t&&(t=e[h][i(557)],s=h);return[e[s]]}return e}[h(824)](){this.loadedTID=null}}class E{constructor(t={}){const s=h;this[s(876)]={server:!0,url:null,host:null,checkURI:null},this.options=n(this[s(876)],t),null==this[s(876)][s(939)]&&(this[s(876)].checkURI=s(899)),this[s(991)]=!1,this[s(629)]()}[h(629)](){const t=h;this[t(876)][t(976)]}load(){const t=h;this[t(876)][t(976)]&&(this.loaded=!0)}[h(913)](t,s,i){const e=h;this.options[e(976)]&&this[e(583)](t,s,i)}recognizeGlobal(t,s,i){const e=h;let n=v[e(617)](t,e(993),.9),a=new FormData;a[e(692)](e(550),n),a[e(692)]("tid",s);let r=null!=this[e(876)][e(861)]?o.cutLastSlash(this[e(876)][e(861)]):"",c=null!=this.options[e(738)]?this[e(876)][e(738)]:r+"/"+this[e(876)][e(939)];fetch(c,{method:"POST",body:a})[e(686)](t=>t[e(673)]())[e(686)](t=>{const s=e;u.getInstance().log(s(647),t);let h=E[s(823)](t[s(690)]);!1===t[s(804)]&&(h[s(721)]=null),typeof i===s(833)&&i(h)})[e(645)](t=>{console[e(769)]("Error:",t),"function"==typeof i&&i(null)})}recognizeLocal(t,s){}parse(t){const s=h;let i={type:null,text:t,object:null};if(i[s(595)]>75){const e=t[s(623)](0,3);e[s(892)]("I<")||e.includes("1<")?i[s(721)]="I":(e.includes("P<")||e.includes("PC"))&&(i.type="P")}return i}static[h(823)](t){const s=h;let i={type:null,text:t.Lines[s(814)](""),object:t};if(i[s(516)].length>75){const e=t[s(561)];e.includes("I<")||e.includes("1<")?i[s(721)]="I":(e[s(892)]("P<")||e.includes("PC"))&&(i[s(721)]="P")}return i}}const R={NO_CARD:h(685),MANY_CARDS:h(571),LOW_LIGHT:h(782),HIGH_LIGHT:h(731),TOO_SMALL:h(529)},z={NONE:h(796),ID:"id",PASSPORT:h(761)},N={NONE:h(796),ID_FRONT:h(694),ID_BACK:h(547),PASS_FRONT:h(665)},L={NONE:h(796),SHOW:h(577),ID_BACK:h(547),FINISH:h(902)},M={NONE:h(796),SCANNING:"scanning",FINISH:h(902)};class P{constructor(t,s={}){const i=h;this.canvas=t,this[i(876)]={host:null,headers:null,mrzOptions:null,detector:null,video:null,area:{x:0,y:0,width:0,height:0},detectTime:100,useServerSide:null,onCardDetected:null,onFaceDetected:null,onMRZDetected:null,onDetected:null,onError:null,onFinished:null,onCommand:null,onCommandResult:null,onStepChanged:null,mirrored:!0,delay:500,serverDelay:500,cardMinSize:{width:70,height:55}},this.options=n(this[i(876)],s),this.stream=null,this[i(726)]=!1,this[i(982)]=null,this[i(749)]=M[i(969)],this.curScan=null,this[i(566)]={},this[i(695)]={},this[i(945)]=null,this[i(873)]=null,this[i(620)]=null,this.startTime=null,this[i(495)]=null,this[i(771)]=this.options[i(771)],this[i(531)]=null,this[i(876)][i(963)]&&(this[i(771)]=this[i(876)][i(700)]),this[i(558)]=new O({mirrored:this[i(876)][i(533)],single:!0,serverSide:this.options[i(963)],host:this[i(876)][i(861)],headers:this[i(876)][i(947)]}),this[i(924)]=new E({host:this[i(876)].host,url:this[i(876)].mrzOptions&&this[i(876)][i(605)][i(738)]||null}),this.cc=null,this.reset(),!this.options.useServerSide&&this[i(756)]()}[h(785)](){const t=h;this.detector[t(725)](),this[t(924)].load(),null!=this.stream&&v.getImageFromURL(t(527))[t(686)](s=>{const i=t;this.stream[i(751)](i(886),s)})}[h(756)](){const t=h;this[t(609)]=y[t(891)](t(846)),this[t(609)].on(t(707),s=>{const i=t;u[i(526)]()[i(633)]("onFaceResult",s),this.step===M[i(574)]&&null!=this.curScan&&this.onFaceDetected(s)})}[h(579)](t,s){const i=h;this[i(558)].isReady()&&this[i(558)][i(807)](t,t=>{typeof s===i(833)&&s(t)})}[h(728)](){const t=h;if(this[t(558)][t(508)]()&&null!=this[t(531)]){{let s=(new Date)[t(668)]();if(this.step===M[t(969)]&&s-this[t(831)]>1e3)this.step=M[t(574)],this[t(985)](L[t(679)]);else{if(this.step===M[t(969)])return;if(this[t(749)]===L[t(603)])return void(null!=this[t(495)]&&s-this[t(495)]>2e3&&(this[t(902)](),this[t(495)]=null))}}!this[t(726)]&&(this[t(656)]=null,this.scanned={card:!1,face:!1,mrz:!1},this[t(726)]=!0,this.actualCanvas=this[t(643)],this[t(945)]=v.canvasToImageData(this[t(873)]),this[t(558)][t(807)](this[t(873)],this.tID,t=>{this.onCardDetected(t)}))}}[h(635)](t){const s=h;let i=null!=t&&t[s(951)]>0?t[0]:null,e=null;this.scanned.card=!0;let n=null!=i&&this[s(984)](i.bbox);if(null!=i&&!n&&this[s(849)](R[s(793)]),null!=i&&!0===n){u[s(526)]()[s(633)]("detector result",t);let h={docType:this[s(956)](i.class),docFace:this[s(953)](i[s(729)]),card:i,face:null,mrz:null,image:null};this[s(656)]=h;let n=v[s(659)](this.curFrame);if(e=v.cropCanvas(n,i[s(584)][0],i[s(584)][1],i[s(584)][2],i[s(584)][3]),h[s(550)]=e[s(864)](s(993),.9),this[s(620)]=e,0!==this[s(695)][s(915)][s(951)]||h[s(941)]!==N.ID_FRONT&&h.docFace!==N[s(815)])if(this[s(695)][s(915)][s(951)]>0&&this[s(695)][s(905)]===z.ID&&h[s(941)]===N.ID_BACK){let t=.6*e[s(938)],h=v[s(748)](e,0,t,e.width,e[s(938)]-t);if(void 0===i[s(924)]||null==i[s(924)]){v[s(932)](h,10)>10?this.mrz.recognize(h,this[s(531)],t=>{this.onMRZDetected(t)}):this[s(716)](this[s(771)])}else this.onMRZDetected(i[s(924)]);this[s(566)].face=!0}else this[s(716)](this[s(771)]);else if(void 0===i[s(936)]||null==i.face?this[s(609)].notify(s(886),e):this[s(920)]([i.face]),h.docFace===N.PASS_FRONT){let t=.7*e[s(938)],h=v[s(748)](e,0,t,e[s(651)],e[s(938)]-t);if(void 0===i[s(924)]||null==i[s(924)]){v[s(932)](h)>5?this.mrz[s(913)](h,this[s(531)],t=>{this[s(534)](t)}):this[s(716)](this[s(771)])}else this.onMRZDetected(i[s(924)])}else this[s(566)][s(924)]=!0;this[s(657)](t),this[s(778)]()}else this[s(657)]([]),this[s(662)]([]),this.unlock(this.delay)}checkSize(t){const s=h;let i=this[s(873)][s(651)],e=this[s(873)].height,n=this[s(876)][s(630)];return null!=t&&t[s(951)]>=4&&(t[2]/i*100>n[s(651)]||t[3]/e*100>n.height)}onFaceDetected(t){const s=h;if(u[s(526)]()[s(633)](s(920),t),this.scanned.face=!0,null!=this[s(656)]){if(this[s(656)][s(936)]=null,t[s(951)]>0){let i=v[s(748)](this[s(620)],t[0].x,t[0].y,t[0][s(651)],t[0][s(938)]),e=v[s(932)](i,10);u[s(526)]()[s(633)]("face laplacian",e),e>10&&(this[s(656)][s(936)]=t)}typeof this[s(876)][s(920)]===s(833)&&this.options[s(920)](t),this.checkScanResult()}}onMRZDetected(t){const s=h;u[s(526)]()[s(633)](s(534),t),this.scanned.mrz=!0,null!=this.curScan&&(null!=t&&null!=t.object&&!0===t[s(973)][s(524)]?this.curScan[s(924)]=t:null!=t&&!0===t.Valid?this.curScan.mrz=E.parseObject(t):this[s(656)][s(924)]=null,typeof this[s(876)][s(534)]===s(833)&&this[s(876)].onMRZDetected(t),this[s(778)]())}[h(778)](){const t=h;if(!this[t(641)]())return;let s=this[t(656)],i=!1;0!==this[t(695)][t(915)][t(951)]||s.docFace!==N[t(992)]&&s.docFace!==N[t(815)]?1===this[t(695)][t(915)][t(951)]&&this[t(695)].docType===z.ID&&s[t(941)]===N[t(663)]&&null!=s[t(638)]&&null!=s.mrz&&null!=s[t(924)][t(721)]&&(this.result[t(915)][t(736)](s),this[t(695)][t(841)]=!0,this[t(662)](this.curScan),this[t(854)](M[t(603)]),this.finishTime=(new Date)[t(668)](),i=!0):s[t(941)]===N[t(992)]?null!=s.card&&null!=s[t(936)]&&1===s.face[t(951)]&&(this[t(695)][t(915)][t(736)](s),this[t(695)][t(905)]=z.ID,this[t(695)][t(841)]=!1,this.callDetectedEvent(this[t(656)]),this[t(985)](L[t(663)]),i=!0,this[t(716)](this[t(771)])):null!=s.card&&null!=s[t(936)]&&null!=s.mrz&&null!=s[t(924)][t(721)]&&(this[t(695)][t(915)][t(736)](s),this.result[t(905)]=z[t(838)],this[t(695)][t(841)]=!0,this.callDetectedEvent(this[t(656)]),this[t(854)](M[t(603)]),this[t(495)]=(new Date)[t(668)](),i=!0),!i&&this[t(566)][t(638)]&&this.scanned[t(936)]&&this[t(566)][t(924)]&&this.unlock(this[t(771)])}[h(641)](){const t=h;for(let s in this[t(566)])if(!0!==this.scanned[s])return!1;return!0}[h(854)](t){const s=h;this[s(749)]!==t&&(this.step=t,typeof this[s(876)][s(979)]==s(833)&&this[s(876)][s(979)](t))}[h(657)](t){const s=h;null!==t&&typeof this[s(876)][s(635)]===s(833)&&this[s(876)][s(635)](t)}[h(662)](t){const s=h;typeof this[s(876)].onDetected===s(833)&&this[s(876)][s(790)](t)}[h(849)](t){const s=h;typeof this[s(876)][s(965)]===s(833)&&this.options[s(965)](t)}[h(519)](){return this[h(749)]}[h(716)](t=null){const s=h;t=null==t?this[s(771)]:t,clearTimeout(this[s(982)]),this[s(982)]=setTimeout(()=>{this[s(726)]=!1},t)}[h(824)](){const t=h;this[t(749)]=L.NONE,this.result={status:!1,docType:z[t(969)],scans:[],tID:null},this[t(656)]=null,this.scanned={},this.detectionLocked=!1,this.cardImage=null,this[t(531)]=null,this[t(558)][t(824)]()}[h(640)](){const t=h;this[t(749)]=M[t(969)],this[t(985)](L[t(969)]),this.startTime=(new Date)[t(668)](),this[t(558)][t(876)].serverSide?this[t(558)][t(672)]((s,i)=>{const e=t;this[e(531)]=i,this[e(695)][e(531)]=this[e(531)]}):(this.tID=String(this.startTime+Math[t(848)](1e5*Math.random())),this.result[t(531)]=this.tID)}[h(902)](){const t=h;this[t(985)](L.FINISH),typeof this[t(876)].onFinished===t(833)&&this.options[t(567)](this[t(695)])}[h(985)](t){const s=h;typeof this[s(876)][s(925)]===s(833)&&this.options[s(925)](t)}defineScanType(t){const s=h;switch(t){case"id_front":case s(547):return z.ID;case s(727):case"pass_full":return z[s(838)];default:return z[s(969)]}}[h(953)](t){const s=h;switch(t){case"id_front":return N[s(992)];case s(547):return N[s(663)];case"pass_main":case s(866):return N[s(815)];default:return N[s(969)]}}[h(500)](){return this[h(749)]}}class _{constructor(t,s={}){const i=h;this.canvas=t,this[i(876)]={srcDim:{k:1,dx:0,dy:0,dw:0,dh:0},mirrored:!0,areaColor:"#FFFFFF",areaOpacity:.5,showArea:!0,showDetectors:!0,showTitle:!0},this.options=n(this.options,s),this.cc=new f(this.options[i(675)])}[h(942)](t,s,i){}[h(745)](){}[h(950)](t){const s=h;if(!this[s(876)][s(556)])return;let i=t[s(651)]+20,e=t[s(938)]+20,n=(this[s(643)][s(651)]-i*this.canvas[s(651)]/100)/2,o=(this.canvas[s(938)]-e*this.canvas[s(938)]/100)/2,a=this[s(643)][s(865)]("2d");a[s(739)](),a.beginPath(),a[s(884)]=3;let r=parseInt(this[s(876)][s(735)][s(763)](1,2),16),c=parseInt(this.options.areaColor[s(763)](3,2),16),l=parseInt(this[s(876)][s(735)][s(763)](5,2),16);a[s(711)]=s(646)+r+", "+c+", "+l+", "+this[s(876)][s(857)]+")",a[s(714)](n,o,this[s(643)].width-2*n,this[s(643)][s(938)]-2*o),a[s(871)](),a.closePath(),a[s(851)]()}[h(784)](t,s=h(565),i=""){const e=h;if(!this.options[e(971)])return;let n=this[e(643)][e(865)]("2d"),o=null,a=null,r=null;for(let h in t)r=t[h],o=this[e(876)][e(533)]?this[e(643)][e(651)]-this.cc[e(875)](r.bbox[0])-this.cc[e(766)](r[e(584)][2]):this.cc.getCoordX(r[e(584)][0]),a=this.cc[e(858)](r.bbox[1]),n[e(928)](),n[e(884)]="2",n[e(711)]=s,n[e(714)](o,a,this.cc[e(766)](r[e(584)][2]),this.cc[e(766)](r[e(584)][3])),n[e(871)](),this[e(876)][e(896)]&&(n[e(884)]="0",n[e(967)]=s,n.fillRect(o-1,a-20,150,20),n.font=e(935),n[e(967)]=e(759),n[e(960)]=e(844),n.fillText(r[e(729)]+" "+Number(r[e(557)])[e(563)](2),o+5,a-5),n[e(871)]()),n.font=e(501),n[e(967)]=s,n[e(960)]=e(746),n[e(801)](i,o+this.cc[e(766)](r[e(584)][2])/2,a+this.cc[e(766)](r[e(584)][3])/2),n[e(777)]();n.restore()}}class W{constructor(t={}){const s=h;this[s(846)]=null,this[s(609)]=null,this.options={path:null},this[s(876)]=n(this.options,t),this[s(629)]()}[h(629)](){const t=h;this[t(609)]=y.open(t(904)),this.stream.on(t(983),this[t(983)][t(697)](this)),this[t(609)].on(t(903),this[t(903)][t(697)](this)),window.Worker&&null!=this[t(876)][t(894)]?(this[t(846)]=new Worker(this[t(876)][t(894)]),this.worker.onmessage=this.onWorkerMessage[t(697)](this)):u.getInstance().log(t(722))}[h(903)](t){const s=h;let i=null;t instanceof HTMLCanvasElement?i=v[s(959)](t):t instanceof HTMLImageElement&&(i=v.imageToCanvas(t)),this[s(846)].postMessage({type:"scan",action:s(903),data:i})}[h(983)](){const t=h;this[t(846)][t(753)]({type:"scan",action:t(983)})}[h(639)](t){const s=h;let i=t[s(690)].type,e=(t.data[s(627)],t.data[s(690)]);switch(i){case s(783):this.stream.notify(s(742),e);break;case s(842):this[s(609)][s(751)]("onScanLoaded",e)}}}class H{constructor(t,s={}){const i=h;this[i(877)]=null,this[i(643)]=null,this[i(986)]=null,this[i(597)]={start:!1,detectInit:!1,analyzeAfterOpen:!1},this[i(846)]=null,this[i(876)]={url:null,headers:null,src:null,sourceType:null,width:1920,height:1080,onInit:null,onFrameCaptured:null,onCardDetected:null,onDetected:null,onCommand:null,sessionTime:6e4,detectTime:100,onFinished:null,mirrored:!0,scan_worker_path:"js/deepscanworker.min.js",face_worker_path:"js/deeptinyfaceworker.min.js",testURL:null,mrzOptions:null,useServerSide:null,serverRequestDelay:500,detector:{},camera:{fillOnMobile:!0,fill:!0,cutEdge:!0},visual:{areaColor:i(592),showArea:!0,showDetectors:!0,showTitle:!0},text:{processing:i(874)}},this[i(835)]=null,this[i(787)]=null,this[i(958)]=null,this[i(910)]=null,this[i(806)]=null,this[i(819)]=null,this[i(882)]=null,this[i(917)]=null,this.lastCommand=L[i(969)],this.lastResult=null,this[i(961)]=0,this[i(876)]=n(this[i(876)],s),(null==this.options.useServerSide&&c[i(825)]()||c.isSafari())&&(this[i(876)][i(963)]=!0),this[i(491)](t),this[i(629)]()}[h(491)](t){const s=h;this[s(986)]=new m(t,{src:this.options.src,width:this[s(876)].width,height:this.options[s(938)],fill:this[s(876)][s(986)][s(543)],fillOnMobile:this.options[s(986)][s(664)],cutEdge:this[s(876)][s(986)][s(512)],onFrameUpdated:this[s(552)][s(697)](this),onLoaded:this[s(513)][s(697)](this),onStart:this[s(521)].bind(this),onStop:this[s(923)][s(697)](this)}),this[s(877)]=this[s(986)][s(877)],this.canvas=this[s(986)].canvas}[h(629)](){const t=h;if(this.cc=new f(this.camera.sourceDim),this[t(787)]=new _(this.canvas,{srcDim:this.camera[t(648)],mirrored:this.options.mirrored,areaColor:this[t(876)][t(787)][t(735)],showArea:this[t(876)][t(787)][t(556)],showDetectors:this[t(876)][t(787)].showDetectors,showTitle:this[t(876)][t(787)][t(896)]}),this[t(835)]=new P(this[t(986)][t(885)],{host:this.options[t(738)],headers:this.options[t(947)],mrzOptions:this[t(876)].mrzOptions,detector:this[t(876)][t(558)],useServerSide:this[t(876)][t(963)],onCommand:this[t(925)][t(697)](this),onCardDetected:this[t(635)][t(697)](this),onDetected:this[t(790)][t(697)](this),onFinished:this[t(567)][t(697)](this),onError:this.onError[t(697)](this),mirrored:this[t(876)][t(533)],serverDelay:this.options[t(772)]}),!this.options[t(963)]){let s=t(870)+(new Date)[t(668)]();this[t(958)]=new C({path:this.options[t(863)]+s}),this.scanWebWorker=new W({path:this.options[t(776)]+s})}this[t(835)].cc=this.cc,typeof this[t(876)][t(908)]==t(833)&&this[t(876)][t(908)]()}[h(891)](){const t=h;!this[t(986)][t(585)]()&&(this[t(986)].start(),this[t(835)][t(785)]())}[h(878)](){const t=h;this[t(900)](),this[t(986)][t(900)]()}[h(640)](){const t=h;this[t(995)]=null,this.lastCommand=L[t(969)],this[t(986)][t(585)]()?(this[t(597)][t(640)]=!0,this[t(835)].start()):(this[t(891)](),this[t(597)][t(546)]=!0),this[t(978)](),this[t(961)]=(new Date)[t(668)]()}[h(900)](){const t=h;this[t(597)][t(640)]=!1,this[t(597)].analyzeAfterOpen=!1,this[t(835)][t(824)](),this[t(978)]()}[h(555)](t,s){const i=h;v[i(943)](t)[i(686)](t=>{const e=i;let h=v.imageToCanvas(t);this[e(835)][e(579)](h,s)})}clear(){const t=h;this[t(806)]=[],this.lastScanned=null,this.lastScannedTime=null,this[t(819)]=null,this.sessionTimeCount=0}[h(567)](t){const s=h;this.lastDetected=[],this[s(882)]=null,this[s(787)].drawCard([]),this[s(900)](),"function"==typeof this[s(876)][s(567)]&&this[s(876)][s(567)](t)}[h(635)](t){const s=h;this.lastDetected=t,this.lastDetectedTime=(new Date)[s(668)](),typeof this.options[s(635)]===s(833)&&this[s(876)][s(635)](t)}onDetected(t){const s=h;this[s(882)]=t,this[s(917)]=(new Date).getTime(),u[s(526)]()[s(633)]("onDetect",t),typeof this.options.onDetected===s(833)&&this[s(876)].onDetected(this.lastScanned)}[h(925)](t){const s=h;this.lastCommand=t,this.state.start&&"function"==typeof this[s(876)][s(925)]&&this[s(876)][s(925)](t)}onCommandResult(){}onError(t){const s=h;switch(t){case R.TOO_SMALL:u[s(526)]().log(s(927))}}[h(552)](){const t=h;if(this[t(597)][t(640)]){let s=this.lastScanned&&this[t(882)][t(638)]?[this[t(882)][t(638)]]:[];if(0===s[t(951)]&&null!=this[t(806)]&&this[t(806)].length>0){s=this[t(806)];let i="";this[t(596)]===L[t(663)]&&this[t(806)][0].class===t(547)?(i=this.options[t(516)][t(511)],this.visual[t(784)](s,t(768),i)):this[t(596)]===L.SHOW&&(this.lastDetected[0][t(729)]===t(727)||this[t(806)][0][t(729)]===t(866))&&(i=this[t(876)][t(516)][t(511)],this[t(787)][t(784)](s,t(768),i))}else{let i=this[t(850)](this.lastScannedTime);null!=i&&i<2e3&&this.visual.drawCard(s)}this.analizer.getStep()===M[t(574)]&&this[t(787)].drawArea(this.analizer.options.cardMinSize),(new Date)[t(668)]()-this[t(961)]>this.options[t(977)]?this[t(567)]({status:!1,msg:t(852)}):this[t(835)][t(728)]()}}onCameraLoaded(t,s){const i=h;this.cc[i(737)](s)}[h(521)](){const t=h;this[t(597)][t(546)]&&(this[t(597)][t(546)]=!1,this[t(640)]())}[h(923)](){}[h(850)](t){const s=h;return null==t?null:(new Date)[s(668)]()-t}}h(936),h(834);const j=class{constructor(t={}){const s=h;this.options={url:null,headers:null,debug:!1},this.options=n(this[s(876)],t),this[s(690)]=new a(t[s(738)]||null,this[s(876)]),new u({debug:this[s(876)][s(957)]})}createDeepFace(t,s){return new A(t,s)}createDeepScan(t,s){const i=h;let e=n({url:this[i(876)][i(738)],headers:this[i(876)][i(947)]},s);return new H(t,e)}[h(551)](t,s){}[h(931)](t,s){const i=h;this[i(690)][i(998)](t,t=>{typeof s===i(833)&&s(t)})}[h(825)](){return c.isMobile()}}}},s={};function i(e){if(s[e])return s[e].exports;var h=s[e]={exports:{}};return t[e](h,h.exports,i),h.exports}return i.d=((t,s)=>{for(var e in s)i.o(s,e)&&!i.o(t,e)&&Object.defineProperty(t,e,{enumerable:!0,get:s[e]})}),i.o=((t,s)=>Object.prototype.hasOwnProperty.call(t,s)),i(614)})().default});
